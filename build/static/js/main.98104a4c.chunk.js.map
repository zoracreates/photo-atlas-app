{"version":3,"sources":["utils/firebase/firebaseConfig.js","components/navigation/Navbar.js","images/icons/nav-logo.png","components/forms/SearchBar.js","components/layout/TitleCardCols.js","components/cards/TtitleCard.js","utils/flickr/getFlickrPhotos.js","utils/flickr/getFlickrPlace.js","utils/getCurrentLocation.js","utils/getGeoSuggestions.js","screens/explore/Home.js","components/map/MapPopUp.js","components/map/ChangeMapView.js","components/map/Map.js","components/layout/MapWithCards.js","components/content/ResultsList.js","components/forms/CheckBox.js","components/forms/SubmitButton.js","utils/filterTags.js","components/forms/SubjectFilters.js","screens/explore/SearchResults.js","components/modals/Modal.js","components/modals/ResetPasswordModal.js","components/forms/TextInput.js","components/modals/ChangeDisplayName.js","screens/Account.js","utils/getPublicTrips.js","components/layout/OneToTwoCols.js","components/cards/TripCard.js","components/content/UnfilteredTrips.js","components/content/FilteredTrips.js","screens/trips/PublicTrips.js","components/forms/EmailInput.js","components/forms/PasswordInput.js","screens/authentication/SignIn.js","screens/authentication/SignUp.js","screens/authentication/Authenticate.js","screens/authentication/VerifyEmail.js","components/navigation/PrivateTab.js","utils/getUserTrips.js","screens/trips/MyTrips.js","utils/getUserBookmarks.js","screens/trips/BookmarkedTrips.js","screens/trips/Trips.js","components/navigation/PrivateRoute.js","components/content/Footer.js","components/slider/PhotoSlider.js","components/content/SubjectIndicators.js","utils/flickr/getFlickrPhotoInfo.js","utils/flickr/createFlickrImageUrl.js","components/buttons/DirectionsButtons.js","components/buttons/AddToTripsButtons.js","components/forms/RadioButton.js","utils/generateDateAndTime.js","utils/generateId.js","components/modals/ManageTripsModal.js","utils/getSavesCount.js","screens/location/Location.js","components/buttons/EditTripButtons.js","components/buttons/BookmarkTripButtons.js","components/modals/EditTripModal.js","utils/addToBookmarks.js","components/modals/BookmarkModal.js","utils/removeFromBookmarks.js","screens/trips/TripContent.js","App.js","index.js"],"names":["firebase","initializeApp","apiKey","process","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","Navbar","location","useLocation","pathname","tripsPath","RegExp","accountPath","tripPagePath","locationPagePath","tripsActive","test","accountActive","tripPageActive","locationPageActive","exploreActive","className","to","src","alt","SearchBar","props","name","onClick","placeholder","backSearch","id","labelText","action","method","searchSuggestions","autoComplete","handleSuggestion","rest","searchStyle","htmlFor","window","history","back","type","map","suggestion","tabIndex","data","y","x","label","TitleCardCols","children","TitleCard","thumbnail","title","locationId","woeId","titleLength","length","extraChars","slicedTitle","slice","lastSpace","lastIndexOf","createUrl","url","item","options","hasOwnProperty","a","axios","get","response","console","log","getFlickrPhotos","placeId","place","woe_name","getFlickrPlace","getCurrentLocation","handleSuccess","handleError","navigator","geolocation","getCurrentPosition","position","err","input","provider","AlgoliaProvider","search","query","results","getGeoSuggestions","Home","state","currentLocation","errorMessage","noLocations","locationResults","searchBarSuggestions","default","_isMounted","getNearbyLocations","currentLat","latitude","currentLon","longitude","existingLocations","list","then","photos","photo","forEach","url_n","woeid","tags","includes","push","placeName","setState","e","preventDefault","this","target","value","aria-live","lat","lon","defaultLocation","coords","message","setTimeout","renderDefaultLocations","renderNearby","onChange","handleInput","handleSubmit","suggestionClick","renderLocations","React","Component","MapPopup","Popup","ChangeMapView","center","zoom","useMap","setView","propTypes","PropTypes","arrayOf","number","DefaultIcon","L","icon","iconUrl","shadowUrl","iconShadow","Marker","prototype","Map","locations","MapContainer","TileLayer","attribution","destination","MapWithCards","openedMap","handleToggle","mapLoctaions","mapLat","mapLon","mapZoom","toggleBarClass","bind","ResultsList","loaded","needLocation","count","CheckBox","SubmitButton","filterTags","abandonedTags","architectureTags","astroTags","landscapeTags","sunriseTags","sunsetTags","transportTags","peopleTags","urbanTags","waterTags","natureTags","streetArtTags","SubjectFilters","open","filters","abandoned","architecture","astro","landscape","sunrise","sunset","transport","people","urban","water","nature","streetArt","formChanged","previousFilters","prevProps","resetFilters","filterString","activeFilters","filter","index","concat","prevState","checked","toggleDropdown","closeDropdown","handleChange","sendData","SearchResults","searchResults","getSearchResults","searchLat","searchLon","parseFloat","address","decodeURIComponent","searchParams","URLSearchParams","has","handleFilters","findNearby","Modal","modalId","modalTitle","modalDescription","isOpen","handleClose","modalTitleId","closeModal","role","aria-modal","aria-labelledby","ResetPasswordModal","error","successReset","auth","emailAddress","email","form","sendPasswordResetEmail","catch","resetPassword","TextInput","ChangeDisplayNameModal","newName","nameUpdated","loading","confirmReset","user","currentUser","database","userId","uid","ref","update","displayName","triggerUpdate","currentName","changeDisplayName","Account","changeName","updateUser","reseted","signOut","component","snapshot","exists","val","openDisplayNameModal","openPasswordModal","closePasswordModal","logInLocation","ChangeDisplayName","closeDisplayNameModal","getPublicTrips","callback","existingTrips","trips","tripId","locationsCount","authorId","existingTripUpdate","privacy","OneToTwoCols","TripCard","authorName","getAuthor","UnfilteredTrips","trip","FilteredTrips","PublicTrips","searching","loadingSearchResults","searchTerms","tripsList","toLowerCase","titleMatch","tagsMatch","handleSearchInput","renderPublicTrips","EmailInput","PasswordInput","checkName","changeType","SignIn","emailError","forgotPassword","hideTitle","tabContent","introtext","onSubmit","handleEmailInput","required","password","handlePassInput","passError","togglePasswordReset","SignUp","firstname","handleNameInput","nameError","lastname","handleLastnameInput","lastnameError","confirmPassword","handleConfirmPassInput","confirmPassError","Authenticate","newUser","fetchSignInMethodsForEmail","signInMethods","indexOf","EmailAuthProvider","EMAIL_PASSWORD_SIGN_IN_METHOD","signInWithEmailAndPassword","userCredential","afterSignIn","errorCode","code","testString","createUserWithEmailAndPassword","userInfo","set","afterCreateAccount","changeUserOnParent","text","handleCreateAccount","handleSignIn","renderContent","changeUserType","VerifyEmail","sendEmailVerification","PrivateTab","isAuthenticated","isVerified","componentContent","getUserTrips","tripRef","inTrip","tripData","MyTrips","getTripsList","nextProps","renderUserTrips","BookmarkedTrips","getUserBookmarks","renderUserBookmarks","Trips","tab","switchTabs","PrivateRoute","render","Footer","PhotoSlider","imageList","imagesCount","buttons","showDownloadButton","showAutoplayButton","image","author","creditUrl","href","SubjectIndicators","subjects","photoId","handleResponse","responseData","fetch","ok","Error","statusText","json","getFlickrPhotoInfo","createFlickrImageUrl","photoData","farm","server","secret","DirectionsLarge","AddToTripsLarge","added","AddToTripsSmall","RadioButton","idName","generateDate","d","Date","day","getDate","month","getMonth","year","getFullYear","generateId","prefix","sufix","result","characters","charactersLength","i","charAt","Math","floor","random","ManageTripsModal","newTripPrivacy","newTripName","newTripTags","creatingTrip","tripNameLength","tripNameError","tripTagsError","newTripCreated","needNewTrip","errorCreatingTrip","errorCreatingLocation","errorUpdatingUserTrips","errorAddingFilters","updatingTrips","newUserValue","checkExistingTrips","checkAuth","selectExistingTrip","getNewTripInfo","renderExistingTrips","switchForm","addOrRemoveFromTrip","valueLength","renderDatabaseErrors","handleTripNamelInput","handleTripTagsInput","handleNewTripPrivacy","defaultChecked","createNewTrip","locationRef","locationPhotosArray","locationName","locationCoordinates","coordinates","locationSubjectsArray","date","locationSubjects","locationPhotos","flickrId","subject","savedCount","addedDate","curated","userLastEditedDate","subjectRef","errorAddingFilter","tripPrivacy","tripName","tripFeaturedImgSrc","tripAuthor","tripTags","endsWith","time","hour","getHours","minutes","getMinutes","seconds","getSeconds","milliseconds","getMilliseconds","generateTimeNumber","generateID","featuredImg","createdOn","lastEdited","startsWith","transaction","createNewFlickrSourcedLocation","renderModalContent","getSavesCount","Location","distance","saves","firstPhoto","showTripsModal","inTrips","checkIfInTrips","locationTrips","replace","pathQuery","_content","description","owner","realname","username","urls","getLocationDetailsFromFlickr","tagsList","tag","tagsString","setSubject","tagsArray","split","newTitle","newSrc","newAlt","newAuthor","ownername","ownerId","newLocation","manageTripsModal","data-micromodal-trigger","EditTripLarge","EditTripSmall","BookmarkTripLarge","bookmarked","updating","BookmarkTripSmall","EditTripModal","errorUpdatingTrip","tagsUpdated","originalTripPrivacy","updatingTrip","tripUpdate","confirmDelete","tripDeleted","tagButtons","originalPrivacy","userTripRef","newPrivacy","originalTripName","originalTripTags","deleteBookmarks","remove","errorUpdatingTrips","userTripsUpdate","bookmarks","searchQuery","searchPrivacy","defaultPrivate","defaultPublic","defaultShareable","handleTripPrivacy","updateTrip","toggleDeleteFrom","deleteTrip","renderUpdateForm","tripUpdated","updated","deleted","addToBookmarks","bookmarkingError","BookmarkModal","verifyBookmark","bookmarkTrip","removeFromBookmarks","userBookmarksRef","TripContent","tripList","showEditModal","updatingBookmark","showBookmarkModal","getTripId","getPrivacy","getTripDetails","checkIfInBookmarks","locationData","Object","keys","inBookmarks","openEditModal","handleBookmark","closeEditModal","closeBoomarkModal","tripauthorId","App","signedIn","userVerified","onAuthStateChanged","emailVerified","exact","path","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.98104a4c.chunk.js","sourcesContent":["import firebase from 'firebase/app';\nimport \"firebase/auth\";\nimport \"firebase/database\";\n\nconst config = {\n    apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n    authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n    databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\n    projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.REACT_APP_FIREBASE_APP_ID\n};\n\nfirebase.initializeApp(config);\n\nexport default firebase;","import { Link, useLocation } from 'react-router-dom';\n\nimport logo from '../../images/icons/nav-logo.png'\n\nfunction Navbar() {\n\n    // Check Router's location to set active status\n    let location = useLocation().pathname;\n\n    let tripsPath = new RegExp('/trips/?');\n    let accountPath = new RegExp('/account/?');\n    let tripPagePath = new RegExp('/trip/?');\n    let locationPagePath = new RegExp('/location/?');\n\n    let tripsActive = tripsPath.test(location);\n    let accountActive = accountPath.test(location);\n    let tripPageActive = tripPagePath.test(location)\n    let locationPageActive = locationPagePath.test(location)\n\n    let exploreActive = (!tripsActive && !accountActive && !tripPageActive && !locationPageActive );\n    \n\n    return (\n        <header>\n            <div className={`container`}>\n                <div className={`logo`}>\n                    <Link to=\"/\">\n                        <h1>Photo Atlas</h1>\n                        <img src={logo} alt={`PhotoAtlas logo`} />\n                    </Link>\n                </div>\n                <nav>\n                    <ul>\n                        <li>\n                            <Link to=\"/\" className={`explore ${exploreActive ? 'active' : 'normal'}`}>\n                                <span>Explore</span>\n                            </Link>\n                        </li>\n\n                        <li>\n                            <Link to=\"/trips\" className={`trips ${tripsActive ? 'active' : 'normal'}`}>\n                                <span>Trips</span>\n                            </Link>\n                        </li>\n\n                        <li>\n                            <Link to=\"/account\" className={`profile ${accountActive ? 'active' : 'normal'}`}>\n                                <span>Account</span>\n                            </Link>\n                        </li>\n                    </ul>\n                </nav>\n            </div>\n        </header>\n    )\n}\n\nexport default Navbar;","export default \"data:image/png;base64,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\"","import PropTypes from 'prop-types';\n\nfunction SearchBar(props) {\n\n    let {\n        className,\n        name,\n        onClick,\n        placeholder,\n        backSearch,\n        id,\n        labelText,\n        action,\n        method,\n        searchSuggestions,\n        autoComplete,\n        handleSuggestion,\n        ...rest } = props;\n\n\n    function sendData(data) {\n        if (handleSuggestion) {\n            handleSuggestion(data)\n        } else {\n            return undefined\n        }\n    }\n\n    let searchStyle = backSearch ? 'back-search' : 'standard-search';\n\n    return (\n        <>\n            {labelText && <label className={`search-label ${searchStyle}-label`} htmlFor={id ? id : 'gsearch'}>{labelText}</label>}\n            <div className={`search-bar-container ${searchStyle} ${className ? className : ''}`}>\n                <button onClick={() => { window.history.back() }} className={`search-back-button`}>Back</button>\n\n                <form className=\"search-form\" action={action} method={method}>\n\n                    <input\n\n                        type=\"search\"\n\n                        className={`text-bar`}\n\n                        name={name ? name : 'q'}\n\n                        id={id ? id : 'gsearch'}\n\n                        placeholder={placeholder ? placeholder : 'Search Term'}\n\n                        autoComplete={autoComplete ? autoComplete : 'off'}\n\n                        {...rest}\n\n                    />\n\n\n\n                    {searchSuggestions &&\n\n                        <ul className={`search-suggestions`}>\n\n                            {searchSuggestions[0] && searchSuggestions.map((suggestion, id) => {\n                                return (\n                                    <li key={id}>\n                                        <button\n                                            tabIndex=\"0\"\n\n                                            onClick={() => sendData(\n                                                //geocoding search means x = lat and y = lon https://smeijer.github.io/leaflet-geosearch/usage\n                                                {\n                                                    'lat': suggestion.y,\n                                                    'lon': suggestion.x,\n                                                    'label': suggestion.label\n                                                }\n                                            )}>{suggestion.label}</button></li>\n                                )\n\n                            }\n\n                            )\n                            }\n\n                        </ul>\n                    }\n                    <button className={`search-button`} onClick={onClick}>Search</button>\n                </form>\n            </div>\n        </>\n    )\n}\n\nSearchBar.propTypes = {\n    className: PropTypes.string,\n    labelText: PropTypes.string,\n    backSearch: PropTypes.bool,\n    name: PropTypes.string,\n    onClick: PropTypes.func,\n    placeholder: PropTypes.string,\n    autoComplete: PropTypes.string,\n    handleSuggestion: PropTypes.func\n}\n\n\nexport default SearchBar;","function TitleCardCols(props) {\n\n    return (\n        <div className={`grid-title-card`}>\n            {props.children}\n        </div>\n    )\n\n}\n\nexport default TitleCardCols;","import PropTypes from 'prop-types';\nimport { Link } from 'react-router-dom'\n\nfunction TitleCard(props) {\n    let {\n        thumbnail,\n        title,\n        src,\n        locationId,\n        woeId } = props;\n\n    if (!title) {\n        title = \"Unamed Location\"\n    }\n\n    let titleLength = title.length;\n\n    //keep the lenght of the title at 45 characters\n    if (titleLength > 150) {\n        let extraChars = 150 - titleLength;\n        let slicedTitle = title.slice(0, extraChars);\n        let lastSpace = slicedTitle.lastIndexOf(\" \");\n        slicedTitle = slicedTitle.slice(0, lastSpace);\n        title = `${slicedTitle}...`\n    }\n\n    return (\n        <Link className={`title-card`} to={ `/location/${src}-${locationId}?woe=${woeId}`}>\n            <div className={`title-card-image`}>\n                <img src={thumbnail} alt=\"\" />\n            </div>\n\n            <p className={`title`}>{title}</p> \n        </Link>\n    )\n}\n\nTitleCard.propTypes = {\n    thumbnail: PropTypes.string,\n    title: PropTypes.string,\n    src: PropTypes.string,\n    locationId: PropTypes.string,\n    woeId: PropTypes.string\n}\n\n\nexport default TitleCard;","import axios from 'axios';\n\nfunction createUrl(options = {}) {\n    let url, item;\n    url = `https://api.flickr.com/services/rest/?api_key=${process.env.REACT_APP_FLICKR_API_KEY}&method=flickr.photos.search&format=json&nojsoncallback=true}`\n\n    for (item in options) {\n        if (options.hasOwnProperty(item)) {\n            url += \"&\" + item + \"=\" + options[item];\n        }\n    }\n\n    return url;\n}\n\nasync function getFlickrPhotos(options = {}) {\n    \n    let url = createUrl(options)\n    let response;\n\n    try {\n       response = await axios.get(url)\n       return response.data\n       \n    } catch(err) {\n        console.log(err); \n    }\n\n};\n\n\nexport default getFlickrPhotos;","import axios from 'axios';\n\nasync function getFlickrPlace(options = {}) {\n    \n    let url, response;\n\n    if (options.placeId) {\n        url = `https://api.flickr.com/services/rest/?api_key=${process.env.REACT_APP_FLICKR_API_KEY}&method=flickr.places.getInfo&format=json&nojsoncallback=1}&place_id=${options.placeId}`\n    }\n    else if (options.woeId) {\n        url = `https://api.flickr.com/services/rest/?api_key=${process.env.REACT_APP_FLICKR_API_KEY}&method=flickr.places.getInfo&format=json&nojsoncallback=1}&woe_id=${options.woeId}`\n    }\n    else {\n        return\n    }\n\n        try {\n            response = await axios.get(url)\n            if (response.data) {\n                if(response.data.place.woe_name) {\n                    return response.data.place.woe_name\n                 }\n            }\n         } catch(err) {\n             console.log(err); \n         }\n     \n};\n\nexport default getFlickrPlace;\n","function getCurrentLocation  (handleSuccess, handleError) {\n    window.navigator.geolocation.getCurrentPosition(\n        position => handleSuccess(position),\n        err => handleError(err)\n    );\n}\n\nexport default getCurrentLocation;","import { AlgoliaProvider } from 'leaflet-geosearch';\n\nasync function getGeoSuggestions(input) {\n    const provider = new AlgoliaProvider();\n\n    try {\n        const results = await provider.search({query: input});\n        if (results) {\n            return results\n        }\n        else {\n            return []\n        }\n    }\n    catch (err) {\n        console.log(err);\n    }\n}\n\nexport default getGeoSuggestions;\n\n//https://smeijer.github.io/leaflet-geosearch/providers/algolia\n//https://smeijer.github.io/leaflet-geosearch/usage","import React from 'react';\nimport SearchBar from '../../components/forms/SearchBar';\nimport TitleCardCols from '../../components/layout/TitleCardCols'\nimport TitleCard from '../../components/cards/TtitleCard'\nimport getFlickrPhotos from '../../utils/flickr/getFlickrPhotos';\nimport getFlickrPlace from '../../utils/flickr/getFlickrPlace';\nimport getCurrentLocation from '../../utils/getCurrentLocation';\nimport getGeoSuggestions from '../../utils/getGeoSuggestions'\n\nclass Home extends React.Component {\n\n    state = {\n        query: '',\n        currentLocation: null,\n        errorMessage: '',\n        noLocations: false,\n        locationResults: [],\n        searchBarSuggestions: '',\n        default: false\n    };\n\n    _isMounted = false;\n\n    handleSubmit(e) {\n        e.preventDefault();\n\n        // use the first suggestion to search\n        if (this.state.searchBarSuggestions) {\n            let suggestion = this.state.searchBarSuggestions[0]\n\n            this.setState({ query: suggestion.label })\n\n            //geocoding search means x = lat and y = lon https://smeijer.github.io/leaflet-geosearch/usage\n            let search = `address=${suggestion.label}&lat=${suggestion.y}&lon=${suggestion.x}`\n            this.props.history.push(`/explore/?q&${search}`);\n        }\n        else {\n            return undefined\n        }\n    }\n\n\n    handleInput(e) {\n        this.setState(\n\n            { query: e.target.value },\n\n            () => {\n\n                if (!this.state.query) {\n                    this.setState({ searchBarSuggestions: '' })\n                }\n                else {\n                    getGeoSuggestions(this.state.query).then(results => this.setState({ searchBarSuggestions: results }))\n                }\n\n            })\n\n    }\n\n    renderNearby(list) {\n\n        if (!this.state.errorMessage && this.state.noLocations) {\n            return <p aria-live=\"polite\">Looks like there aren't any photo spots nearby yet. Let's explore a different location</p>\n        }\n\n        if (!this.state.errorMessage && this.state.currentLocation) {\n            return (\n                <>\n                <h2 className={`h5-font`}>Explore Nearby</h2>\n                    <p aria-live=\"polite\" className=\"sr-only\">Showing nearby locations</p>\n                    <TitleCardCols>\n                        {list.map((location, id) => {\n                            const { thumbnail, title, src, locationId, woeId } = location;\n                            return (\n                                //make these into links where the search param should be the photo id\n                                <TitleCard\n                                    key={id}\n                                    thumbnail={thumbnail}\n                                    title={title}\n                                    src={src}\n                                    locationId={locationId}\n                                    woeId={woeId}\n                                />\n                            )\n\n                        })}\n                    </TitleCardCols>\n                </>\n            )\n\n        }\n\n        return <p>Getting photo spots...</p>\n    }\n\n    renderDefaultLocations(list) {\n\n        while (list.length === 0) {\n            return (\n                <>\n                    <p>Getting photo spots...</p>\n                </>\n            )\n        }\n        return (\n            <>\n                <h2 className={`h5-font`}>Explore Cabo Rojo, Puerto Rico</h2>\n                <p aria-live=\"polite\" className=\"sr-only\">Showing Cabo Rojo Puerto Rico</p>\n                <TitleCardCols>\n                    {list.map((location, id) => {\n                        const { thumbnail, title, src, locationId, woeId } = location;\n                        return (\n                            //make these into links where the search param should be the photo id\n                            <TitleCard\n                                key={id}\n                                thumbnail={thumbnail}\n                                title={title}\n                                src={src}\n                                locationId={locationId}\n                                woeId={woeId}\n                            />\n                        )\n\n                    })}\n                </TitleCardCols>\n            </>\n        )\n    }\n\n\n    getNearbyLocations = () => {\n\n\n        let location = this.state.currentLocation\n\n\n        if (location) {\n\n\n            let currentLat = location.latitude;\n\n            let currentLon = location.longitude;\n            let options = {\n                \"lat\": currentLat,\n                \"lon\": currentLon,\n                \"accuracy\": 16,\n                \"extras\": \"geo, tags, url_n\"\n            }\n\n            //create a list of locations\n            let existingLocations = [];\n\n            let list = [];\n\n            getFlickrPhotos(options).then(data => {\n\n                if (!data) {\n                    return undefined\n                }\n\n                let photos = data.photos.photo;\n\n                if (!photos[0]) {\n                    this.setState({ noLocations: true })\n                }\n\n                else {\n\n                    photos.forEach(\n\n                        photo => {\n\n                            let url = photo.url_n\n\n\n                            let title = photo.title;\n\n                            let woeId = photo.woeid;\n\n                            let locationId = photo.id;\n\n                            let tags = photo.tags;\n\n                            //prevent duplicate locations and locations with no tags\n                            if (woeId && !existingLocations.includes(woeId) && tags) {\n\n                                existingLocations.push(woeId);\n\n                                let location = {\n                                    \"src\": \"flickr\",\n                                    \"locationId\": locationId,\n                                    \"thumbnail\": url,\n                                    \"title\": title,\n                                    \"woeId\": woeId\n                                }\n\n                                let place = async (options) => {\n                                    let placeName = await getFlickrPlace(options);\n                                    return placeName\n                                }\n\n                                place({ \"woeId\": woeId }).then(placeName => {\n\n                                    if (placeName) {\n                                        location.title = placeName\n                                    }\n\n                                }).then(\n\n                                    list.push(location)\n\n                                )\n                            }\n                        }\n                    )\n\n\n\n                    this.setState({\n                        locationResults: list,\n                        noLocations: false\n                    })\n\n\n                }\n            }\n\n            )\n        }\n\n    }\n\n    suggestionClick(suggestion, e) {\n        this.setState({ query: suggestion.label })\n        let search = `address=${suggestion.label}&lat=${suggestion.lat}&lon=${suggestion.lon}`\n        this.props.history.push(`/explore/?q&${search}`);\n    }\n\n    componentDidMount() {\n\n        this._isMounted = true;\n\n        let defaultLocation = {\n            latitude: 18.087,\n            longitude: -67.1459\n        }\n\n        let setDefault = () => {\n            if (!this.state.currentLocation) {\n                this.setState(\n                    { currentLocation: defaultLocation, default: true },\n                    () => this.getNearbyLocations()\n                )\n            }\n        }\n\n        getCurrentLocation(\n            position =>  {\n                if( this._isMounted && !this.state.default) {\n                    this.setState({ currentLocation: position.coords}, () => this.getNearbyLocations())\n                }\n            },\n            err => this._isMounted && this.setState({ errorMessage: err.message })\n        )\n\n        setTimeout(function(){ setDefault() }, 3500);\n\n\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n\n    renderLocations(locationResults) {\n        if (!this.state.default) {\n            return (\n                <>\n                    {this.renderNearby(locationResults)}\n                </>\n            )\n        } else {\n            return (\n                <>\n                    {this.renderDefaultLocations(locationResults)}\n                </>\n            )\n        }\n    }\n\n\n\n    render() {\n        let { query, locationResults, searchBarSuggestions } = this.state;\n\n        return (\n            <div className={`home`}>\n                <div className={`background-image`}>\n                    <div className={`container mobile-padding`}>\n                        <p className={`home-heading`}>Photo Atlas</p>\n                        <h2 className={`h5-font`}>Find new places to capture your best work.</h2>\n                        <SearchBar\n\n                            method={`get`}\n\n                            value={query}\n\n                            onChange={(e) => { this.handleInput(e) }}\n\n                            labelText=\"Where do you want to go?\"\n\n                            placeholder=\"Search a place\"\n\n                            onClick={(e) => this.handleSubmit(e)}\n\n                            searchSuggestions={searchBarSuggestions}\n\n                            handleSuggestion={(suggestion, e) => { this.suggestionClick(suggestion) }}\n                        />\n\n\n                    </div>\n                </div>\n                <div className={`container mobile-padding`}>\n\n                    {this.renderLocations(locationResults)}\n                </div>\n\n            </div>\n        )\n\n    }\n\n}\n\nexport default Home;","import PropTypes from 'prop-types';\nimport { Popup } from 'react-leaflet';\nimport { Link } from 'react-router-dom'\n\nfunction MapPopup(props) {\n\n    let {\n        thumbnail,\n        title,\n        src,\n        locationId,\n        woeId } = props;\n\n    if (!title) {\n        title = \"Unamed Location\"\n    }\n\n    let titleLength = title.length;\n\n    //keep the lenght of the title at 45 characters\n    if (titleLength > 150) {\n        let extraChars = 150 - titleLength;\n        let slicedTitle = title.slice(0, extraChars);\n        let lastSpace = slicedTitle.lastIndexOf(\" \");\n        slicedTitle = slicedTitle.slice(0, lastSpace);\n        title = `${slicedTitle}...`\n    }\n\n    return (\n        <Popup>\n            <div className={\"map-popup\"}>\n\n                <div className={\"location-popup-image\"}>\n                    <img src={thumbnail} alt=\"\" />\n                </div>\n                <Link to={ `/location/${src}-${locationId}?woe=${woeId}`} className={`title`}>{title}</Link>\n\n            </div>\n        </Popup>\n    )\n}\n\nMapPopup.propTypes = {\n    thumbnail: PropTypes.string,\n    title: PropTypes.string,\n    src: PropTypes.string,\n    locationId: PropTypes.string,\n    woeId: PropTypes.string\n}\n\n\nexport default MapPopup;","import PropTypes from 'prop-types';\nimport { useMap } from 'react-leaflet';\nfunction ChangeMapView(props) {\n    let { center, zoom } = props;\n    const map = useMap();\n    map.setView(center, zoom);\n    return null\n}\n\nChangeMapView.propTypes = {\n    center: PropTypes.arrayOf(PropTypes.number),\n    zoom:PropTypes.number\n}\n\nexport default ChangeMapView;\n/* \nExcept for its children, MapContainer props are immutable, and changes must be passed as events in children\nhttps://react-leaflet.js.org/docs/api-map/\nhttps://stackoverflow.com/questions/64665827/react-leaflet-center-attribute-does-not-change-when-the-center-state-changes*/","import React from 'react';\nimport { MapContainer, TileLayer, Marker } from 'react-leaflet';\nimport PropTypes from 'prop-types';\nimport MapPopup from '../map/MapPopUp'\n\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\n\nimport ChangeMapView from './ChangeMapView';\n\n/* fix marker icon not rendering */\nimport icon from 'leaflet/dist/images/marker-icon.png';\nimport iconShadow from 'leaflet/dist/images/marker-shadow.png';\n\nlet DefaultIcon = L.icon({\n    iconUrl: icon,\n    shadowUrl: iconShadow\n});\n\nL.Marker.prototype.options.icon = DefaultIcon;\n\n\nfunction Map(props) {\n\n    let { locations, lat, lon, zoom } = props;\n\n    if (!locations) {\n        locations = []\n    }\n\n    if (!lat || !lon) {\n        lat = 34.36;\n        lon = -20.58;\n    }\n\n    let center = [lat, lon]\n\n    return (\n\n        <MapContainer center={center} zoom={10} >\n            <ChangeMapView center={center} zoom={zoom} />\n            <TileLayer\n                attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n            />\n\n\n            {locations.map((location, id) => {\n                const { thumbnail, title, destination, locationId, src, woeId } = location;\n\n                let lat = destination.latitude;\n                let lon = destination.longitude;\n\n                return (\n                    <Marker key={id} position={[lat, lon]}>\n                        <MapPopup \n                            thumbnail={thumbnail}\n                            title={title}\n                            locationId={locationId}\n                            src={src}\n                            woeId={woeId}\n                             />\n                    </Marker>\n                )\n            })\n\n            }\n\n        </MapContainer>\n\n    )\n}\n\nMap.propTypes ={\n    locations: PropTypes.arrayOf(PropTypes.object),\n    lat: PropTypes.number,\n    lon: PropTypes.number,\n    zoom:PropTypes.number\n}\n\nexport default Map;","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Map from '../map/Map';\n\nclass MapWithCards extends React.Component {\n\n    state = {\n        openedMap: true\n    }\n\n    handleToggle = () => {\n        this.setState({ openedMap: !this.state.openedMap });\n    }\n\n    render() {\n        let { children, mapLoctaions, mapLat, mapLon, mapZoom } = this.props;\n\n        let { openedMap } = this.state;\n\n        let handleToggle = this.handleToggle;\n\n        let toggleBarClass = openedMap ? 'open' : 'close';\n\n        return (\n            <div className={`grid-map`}>\n\n                <div className={`cards-container ${toggleBarClass}`}>\n                    {children}\n                </div>\n\n                <div className={`map-container ${toggleBarClass}`}>\n\n                    <div className={`toggle-bar`} onClick={handleToggle.bind(this)}>\n                        <p>\n                            {openedMap ? 'Hide Map' : 'Show Map'}\n                        </p>\n\n                    </div>\n\n                    <div className={'map'}>\n                        <Map locations={mapLoctaions} lat={mapLat} lon={mapLon} zoom={mapZoom}/>\n                    </div>\n                </div>\n\n            </div>\n\n        )\n\n    }\n\n}\n\n\nMapWithCards.propTypes ={\n    mapLocations: PropTypes.arrayOf(PropTypes.object),\n    mapLat: PropTypes.number,\n    mapLon: PropTypes.number,\n    mapZoom:PropTypes.number\n}\n\n\n\nexport default MapWithCards;","\nimport PropTypes from 'prop-types';\n\n\nimport TitleCard from '../cards/TtitleCard'\nimport TitleCardCols from '../../components/layout/TitleCardCols';\n\nfunction ResultsList(props) {\n\n    let { loaded, list, needLocation } = props;\n\n    let count = list.length;\n\n    if (!loaded) {\n        return <p>Getting Locations...</p>\n    }\n\n    if (loaded && count > 0) {\n        return (\n            <>\n            <div aria-live=\"polite\" className=\"sr-only\">\n                <p>Showing search results</p>\n            </div>\n            <TitleCardCols>\n            {list.map((location, id) => {\n                const { thumbnail, title, src, locationId, woeId } = location;\n\n                return (\n                    \n                    <TitleCard\n                        key={id}\n                        thumbnail={thumbnail}\n                        title={title}\n                        src={src}\n                        locationId={locationId}\n                        woeId={woeId}\n                        />\n                    \n                )\n\n            })}\n            </TitleCardCols>\n            </>\n        )\n\n    }\n\n    if (loaded && needLocation && count === 0) {\n        return (\n            <p aria-live=\"polite\">\n                Share your location to explore what's nearby.\n            </p>\n        )\n    }\n\n    if (loaded && count === 0 && !needLocation) {\n        return (\n            <p aria-live=\"polite\">\n                Sorry, no photo spots here yet.\n            </p>\n        )\n    }\n\n}\n\nResultsList.propTypes = {\n    loaded: PropTypes.bool.isRequired,\n    list: PropTypes.arrayOf(PropTypes.object).isRequired,\n    needLocation: PropTypes.bool\n}\n\nexport default ResultsList;","import PropTypes from 'prop-types';\n\nfunction CheckBox(props) {\n\n    let {\n        className,\n        id,\n        name,\n        labelText,\n        ...rest } = props;\n\n    return (\n        <>\n            <label className={`check-container ${className ? className : ''}` } htmlFor={name}>{labelText ? labelText : 'label'}\n                \n                <input\n                    \n                    type=\"checkbox\"\n\n                    className={`${className}`}\n                    \n                    id={id ? id : name}\n\n                    name={name}\n\n                    {...rest}\n\n                />\n\n                <span className={`checkmark`}></span>\n\n            </label>\n\n        </>\n    )\n}\n\nCheckBox.propTypes = {\n    className: PropTypes.string,\n    id: PropTypes.string,\n    name: PropTypes.string.isRequired,\n    labelText: PropTypes.string.isRequired,\n}\n\n\nexport default CheckBox;","import PropTypes from 'prop-types';\n\nfunction SubmitButton(props) {\n    \n    let { className, value, ...rest } = props;\n\n    return (\n        <input \n            type=\"submit\" \n\n            className={`${className ? className : 'default-button'}`} \n\n            value={value ? value : 'Submit'} \n\n            {...rest}\n\n        />\n    )\n}\n\nSubmitButton.propTypes = {\n    className: PropTypes.string,\n    value: PropTypes.string\n}\n\nexport default SubmitButton;","\n\n const filterTags = {\n    abandonedTags: 'abandoned, ruins, ghost',\n    architectureTags: 'architecture',\n    astroTags: 'astrophotography, stars, moon',\n    landscapeTags: 'landscape, mountains, outdoors',\n    sunriseTags: 'sunrise',\n    sunsetTags: 'sunset',\n    transportTags: 'transport, train, bus, boat, airplane, airport, transit',\n    peopleTags: 'people, portrait',\n    urbanTags: 'urban, cityscape, skyline, city',\n    waterTags: 'water, lake, river, ocean, waterfall, pond, reservoir, esplanade, sea',\n    natureTags: 'trees, flower, nature, foliage, leaves, grass, animals, forest, garden, park',\n    streetArtTags: 'graffiti, mural, sreet art'\n}\n\nexport default  filterTags;","import React from 'react';\nimport CheckBox from './CheckBox';\nimport SubmitButton from './SubmitButton';\nimport filterTags from '../../utils/filterTags'\n\n\nclass SubjectFilters extends React.Component {\n\n    state = {\n        open: false,\n        filters: {\n            abandoned: false,\n            architecture: false,\n            astro: false,\n            landscape: false,\n            sunrise: false,\n            sunset: false,\n            transport: false,\n            people: false,\n            urban: false,\n            water: false,\n            nature: false,\n            streetArt: false\n        },\n        formChanged: false,\n        previousFilters: []\n    }\n\n\n    componentDidUpdate(prevProps) {\n\n        if (this.props.resetFilters !== prevProps.resetFilters) {\n\n            if (this.props.resetFilters) {\n                this.setState(\n                    {\n                        filters:\n                        {\n                            abandoned: false,\n                            architecture: false,\n                            astro: false,\n                            landscape: false,\n                            sunrise: false,\n                            sunset: false,\n                            transport: false,\n                            people: false,\n                            urban: false,\n                            water: false,\n                            nature: false,\n                            streetArt: false\n                        }\n                    })\n            }\n\n        }\n\n\n    }\n\n\n    toggleDropdown() {\n        this.setState({ open: !this.state.open })\n    }\n\n    closeDropdown() {\n\n        if (this.state.formChanged && this.state.previousFilters) {\n            this.setState({ filters: this.state.previousFilters })\n        }\n        this.setState({ open: false, formChanged: false })\n\n    }\n\n    sendData(e) {\n        e.preventDefault();\n\n        let {\n            abandoned,\n            architecture,\n            astro,\n            landscape,\n            sunrise,\n            sunset,\n            transport,\n            people,\n            urban,\n            water,\n            nature,\n            streetArt\n        } = this.state.filters;\n\n\n        let abandonedTags = abandoned ? filterTags.abandonedTags : false;\n        let architectureTags = architecture ? filterTags.architectureTags : false;\n        let astroTags = astro ? filterTags.astroTags : false;\n        let landscapeTags = landscape ? filterTags.landscapeTags : false;\n        let sunriseTags = sunrise ? filterTags.sunriseTags : false;\n        let sunsetTags = sunset ? filterTags.sunsetTags : false;\n        let transportTags = transport ? filterTags.transportTags : false;\n        let peopleTags = people ? filterTags.peopleTags : false;\n        let urbanTags = urban ? filterTags.urbanTags : false;\n        let waterTags = water ? filterTags.urbanTags : false;\n        let natureTags = nature ? filterTags.natureTags : false;\n        let streetArtTags = streetArt ? filterTags.streetArtTags : false;\n\n        let filterString = '';\n        let allFilterTags = [\n            abandonedTags,\n            architectureTags,\n            astroTags,\n            landscapeTags,\n            sunriseTags,\n            sunsetTags,\n            transportTags,\n            peopleTags,\n            urbanTags,\n            waterTags,\n            natureTags,\n            streetArtTags\n        ];\n\n        let activeFilters = [];\n\n        allFilterTags.forEach(\n            filter => {\n                if (filter) {\n                    activeFilters.push(filter)\n                }\n            }\n        )\n\n\n        activeFilters.forEach(\n            (filter, index) => {\n                if (index === 0) {\n                    filterString = filterString.concat(filter)\n                } else {\n                    filterString = filterString.concat(`, ${filter}`)\n                }\n            }\n        )\n\n        this.setState({ open: !this.state.open, formChanged: false, previousFilters: this.state.filters })\n\n\n\n\n        return this.props.handleSubmit(filterString)\n    }\n\n\n    handleChange(e) {\n\n        let filter = e.target.name;\n\n        switch (filter) {\n            case 'abandoned':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        abandoned: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'architecture':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        architecture: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'astro':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        astro: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'landscape':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        landscape: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'sunrise':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        sunrise: e.target.checked      // update the value of specific key\n                    }\n                }))\n                break;\n            case 'sunset':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        sunset: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'transport':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        transport: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'people':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        people: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'urban':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        urban: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'water':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        water: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'nature':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        nature: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'street-art':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        streetArt: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            default:\n                console.log('filter does not exist')\n        }\n    }\n\n    render() {\n        let {\n            open\n        } = this.state;\n\n        let {\n            abandoned,\n            architecture,\n            astro,\n            landscape,\n            sunrise,\n            sunset,\n            transport,\n            people,\n            urban,\n            water,\n            nature,\n            streetArt\n        } = this.state.filters;\n\n        return (\n            <span className={`search-filter-container ${open ? 'open' : 'closed'}`} >\n                <button className={`search-filter`} onClick={(e) => { this.toggleDropdown() }}>\n                    Filter by Subject\n                </button>\n                <div className={`search-filter-dropdown`}>\n                    <button className={`close-button`} onClick={() => this.closeDropdown()}>Close</button>\n                    <form onChange={() => { this.setState({ formChanged: true }) }}>\n                        <CheckBox name=\"abandoned\" checked={abandoned} labelText=\"Abandoned\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"architecture\" checked={architecture} labelText=\"Architecture\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"astro\" checked={astro} labelText=\"Astrophotography\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"landscape\" checked={landscape} labelText=\"Landscape\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"nature\" checked={nature} labelText=\"Nature\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"street-art\" checked={streetArt} labelText=\"Street Art\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"sunrise\" checked={sunrise} labelText=\"Sunrise\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"sunset\" checked={sunset} labelText=\"Sunset\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"transport\" checked={transport} labelText=\"Transport\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"people\" checked={people} labelText=\"People\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"urban\" checked={urban} labelText=\"Urban\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"water\" checked={water} labelText=\"Water\" onChange={(e) => { this.handleChange(e) }} />\n                        \n                        \n\n                        <SubmitButton onClick={(e) => { this.sendData(e) }} value=\"Apply Filters\" />\n                    </form>\n                </div>\n            </span>\n        )\n    }\n}\n\nexport default SubjectFilters;","import React from 'react';\n\nimport SearchBar from '../../components/forms/SearchBar';\nimport MapWithCards from '../../components/layout/MapWithCards';\n\nimport getFlickrPhotos from '../../utils/flickr/getFlickrPhotos';\nimport getFlickrPlace from '../../utils/flickr/getFlickrPlace';\nimport getCurrentLocation from '../../utils/getCurrentLocation';\nimport ResultsList from '../../components/content/ResultsList';\nimport getGeoSuggestions from '../../utils/getGeoSuggestions'\nimport SubjectFilters from '../../components/forms/SubjectFilters';\n\nclass SearchResults extends React.Component {\n    state = {\n        query: '',\n        loaded: false,\n        searchResults: [],\n        mapLat: null,\n        mapLon: null,\n        mapZoom: 10\n    }\n\n    _isMounted = false;\n\n    getSearchResults = (lat, lon, tags) => {\n        \n\n        let searchLat = lat;\n\n        let searchLon = lon;\n\n        let options = {\n            \"lat\": searchLat,\n            \"lon\": searchLon,\n            \"extras\": \"geo, tags, url_n\",\n            \"accuracy\": 6\n        }\n\n        console.log(options)\n\n        if (tags) {\n            options.tags = tags\n        }\n\n        //create a list of locations\n        let existingLocations = [];\n\n        let list = [];\n\n\n        //get from firebase\n        //in firebase I need to store the photo.id and the photo.woeid\n\n\n        //get from Flickr\n\n        getFlickrPhotos(options).then(data => {\n\n            let photos; \n\n            if (data) {\n                photos = data.photos\n            }\n\n\n            if (!photos) {\n                return this.setState({ loaded: true })\n            }\n\n            else {\n\n                photos = photos.photo\n\n\n                photos.forEach(\n\n                    photo => {\n\n                        let url = photo.url_n\n\n                        let title = photo.title;\n\n                        let lat = photo.latitude;\n\n                        let lon = photo.longitude;\n\n                        let woeId = photo.woeid;\n\n                        let locationId = photo.id;\n\n                        let tags = photo.tags;\n\n\n                        // prevent duplicate locations, and locations with no tags\n                        if (woeId && !existingLocations.includes(woeId) && tags ) {\n\n                            \n                            //add photo locations to existing list\n                            existingLocations.push(woeId);\n\n                            let location = {\n                                \"src\": \"flickr\", //added,\n                                \"locationId\": locationId,\n                                \"woeId\" : woeId,\n                                \"thumbnail\": url,\n                                \"title\": title,\n                                \"destination\": {\n                                    \"latitude\": parseFloat(lat),\n                                    \"longitude\": parseFloat(lon)\n                                }\n                            }\n\n    \n                            let place = async (options) => {\n                                let placeName = await getFlickrPlace(options);\n                                return placeName\n                            }\n\n                            place({ \"woeId\": woeId }).then(placeName => {\n\n                                if (placeName) {\n                                    location.title = placeName\n                                }\n\n                            }).then(\n\n                                list.push(location)\n\n                            )\n                        }\n                    }\n                )\n\n                this.setState({\n                    searchResults: list,\n                    loaded: true,\n                    mapLat: parseFloat(searchLat),\n                    mapLon: parseFloat(searchLon),\n                    mapZoom: 10,\n                    resetFilters: false\n                })\n\n            }\n\n        }\n\n        )\n\n    }\n\n    handleInput(e) {\n        this.setState(\n\n            { query: e.target.value },\n\n            () => {\n\n                if (!this.state.query) {\n                    this.setState({ searchBarSuggestions: '' })\n                }\n                else {\n                    getGeoSuggestions(this.state.query).then(results => this.setState({ searchBarSuggestions: results }))\n                }\n\n            })\n\n    }\n\n    handleSubmit(e) {\n\n        e.preventDefault();\n\n        this.setState({ searchResults: [], loaded: false, needLocation: false, resetFilters: true });\n\n        if (!this.state.searchBarSuggestions && !this.state.query) {\n            this.setState({ loaded: true, mapZoom: 1.5, resetFilters: false })\n        } else {\n\n            this.setState({ resetFilters: true });\n\n            let suggestion;\n\n            if (this.state.searchBarSuggestions) {\n                suggestion = this.state.searchBarSuggestions[0];\n            } else {\n                suggestion = {\n                    \"label\": this.state.query,\n                    \"y\": this.state.mapLat,\n                    \"x\": this.state.mapLon\n                }\n            }\n\n\n            this.setState({ query: suggestion.label, searchBarSuggestions: '' });\n\n            let address = suggestion.label;\n\n            let lat = suggestion.y;\n\n            let lon = suggestion.x;\n\n            let search = `address=${address}&lat=${lat}&lon=${lon}`\n\n            this.props.history.push(`/explore/?q=&${search}`)\n            this.getSearchResults(lat, lon)\n        }\n\n\n\n    }\n\n    findNearby() {\n        this.setState({ searchResults: [], loaded: false, query: 'Current Location' });\n        this.props.history.push(`/explore/`)\n\n        getCurrentLocation(\n            (position) =>\n\n                this.setState({ currentLocation: position.coords },\n                    () => {\n                        let lat = this.state.currentLocation.latitude;\n                        let lon = this.state.currentLocation.longitude;\n\n                        this.getSearchResults(lat, lon)\n                    }),\n\n            () => this.setState({ loaded: true, needLocation: true, mapZoom: 1.5 })\n        )\n    }\n\n    suggestionClick(suggestion) {\n\n        this.setState({\n            searchResults: [],\n            loaded: false,\n            needLocation: false,\n            query: suggestion.label,\n            searchBarSuggestions: '',\n            resetFilters: true\n        });\n\n\n        let search = `address=${suggestion.label}&lat=${suggestion.lat}&lon=${suggestion.lon}`\n\n        this.props.history.push(`/explore/?q=&${search}`)\n\n        if (!suggestion.lat || !suggestion.lon) {\n            this.setState({ loaded: true, mapZoom: 1.5, resetFilters: false })\n        } else {\n            let lat = suggestion.lat;\n            let lon = suggestion.lon;\n            this.getSearchResults(lat, lon)\n        }\n\n    }\n\n    handleFilters(data) {\n\n        this.setState({ searchResults: [], loaded: false, needLocation: false });\n\n        if (!this.state.searchBarSuggestions && !this.state.query) {\n            this.setState({ loaded: true, mapZoom: 1.5 })\n        } else {\n\n            let suggestion = {\n                \"label\": this.state.query,\n                \"y\": this.state.mapLat,\n                \"x\": this.state.mapLon\n            }\n\n\n            let address = suggestion.label;\n\n            let lat = suggestion.y;\n\n            let lon = suggestion.x;\n\n            let search = `address=${address}&lat=${lat}&lon=${lon}`\n\n            this.props.history.push(`/explore/?q=&${search}`)\n            this.getSearchResults(lat, lon, data)\n        }\n    }\n\n    componentDidMount() {\n        let query = decodeURIComponent(this.props.location.search);\n\n        let searchParams = new URLSearchParams(query);\n\n        this._isMounted = true\n\n        if (!searchParams.has(\"lon\") || !searchParams.has(\"lat\")) {\n\n            this._isMounted && this.setState({ loaded: true, mapZoom: 1.5 })\n\n        } else {\n            let address = searchParams.get(\"address\");\n\n            let lat = searchParams.get(\"lat\");\n\n            let lon = searchParams.get(\"lon\");\n\n            this._isMounted && this.setState({ query: address });\n\n            this.getSearchResults(lat, lon)\n        }\n    }\n\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n\n\n    render() {\n\n        let { query, searchResults, loaded, mapLat, mapLon, mapZoom, needLocation, searchBarSuggestions } = this.state;\n\n        return (\n            <div className={`search`}>\n\n                <div className={`dark-background`}>\n                    <div className={`container mobile-padding header-container`}>\n                        <SearchBar\n                            labelText=\"Location\"\n                            backSearch\n                            placeholder=\"Search a place\"\n                            value={query}\n                            onChange={(e) => { this.handleInput(e) }}\n                            onClick={(e) => this.handleSubmit(e)}\n                            searchSuggestions={searchBarSuggestions}\n                            handleSuggestion={(suggestion) => { this.suggestionClick(suggestion) }}\n                        />\n                        <SubjectFilters handleSubmit={(data) => this.handleFilters(data)} resetFilters={this.state.resetFilters} />\n                        <button className={`search-filter`} onClick={() => { this.findNearby() }}>Spots Near Me</button>\n                    </div>\n                </div>\n\n                <div className={`container`}>\n\n                    <MapWithCards\n                        mapLoctaions={searchResults}\n                        mapLat={mapLat}\n                        mapLon={mapLon}\n                        mapZoom={mapZoom}\n\n                    >\n                        <ResultsList loaded={loaded} list={searchResults} needLocation={needLocation} />\n\n                    </MapWithCards>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default SearchResults;","import PropTypes from 'prop-types'\n\nfunction Modal({ modalId, modalTitle, modalDescription, isOpen, handleClose, children } ) {\n\n    let modalTitleId = `${modalId}-title`\n\n    function closeModal() {\n        handleClose(); //this should set props.isOpen to false on the parent\n    }\n\n    return (\n        <>\n            <div\n                className={`${isOpen ? 'open' : 'closed'} modal-overlay`}\n\n                onClick={() => closeModal()}\n\n                tabIndex=\"-1\">\n            </div>\n            <div id={modalId} className={`${isOpen ? 'open' : 'closed'} modal-wrapper ${modalId}`}>\n\n                <div className=\"modal-body\" role=\"dialog\" aria-modal=\"true\" aria-labelledby={`${modalTitleId}`}>\n\n                    <button className={`close-button`} onClick={() => closeModal()}>Close</button>\n\n                    <div aria-live=\"polite\" className=\"modal-header\">\n                        <h2 id={`${modalTitleId}`}>\n                            {modalTitle}\n                        </h2>\n                        <h3>{modalDescription}</h3>\n                    </div>\n\n                    <div className=\"modal-main\">\n                        {children}\n                    </div>\n                </div>\n\n            </div>\n        </>\n    )\n}\n\nModal.propTypes = {\n    modalId: PropTypes.string, \n    modalTitle: PropTypes.string, \n    modalDescription: PropTypes.string,\n    isOpen: PropTypes.bool,\n    handleClose: PropTypes.func.isRequired,\n    initiallyOpen: PropTypes.bool\n}\n\nexport default Modal;","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport firebase from '../../utils/firebase/firebaseConfig'\n\nimport Modal from './Modal'\n\n\nclass ResetPasswordModal extends React.Component {\n    state = {\n        error: '',\n        successReset: false\n    }\n\n    _isMounted = false;\n\n    closeModal() {\n        this.props.handleClose(this.state.successReset)\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n\n    resetPassword(e) {\n        e.preventDefault();\n        console.log('clicked')\n        let auth = firebase.auth();\n\n        let emailAddress = this.props.email;\n\n        let form = this;\n\n        form.setState({ error: '' })\n\n\n        let actionCodeSettings = { url: `https://photoatlasapp.com/` }\n\n\n        this._isMounted && auth.sendPasswordResetEmail(emailAddress, actionCodeSettings)\n            .then(() => {\n                form.setState({ successReset: true })\n\n            }\n            ).catch(function (error) {\n                form.setState({\n                    error: error.message,\n                    successReset: false\n                })\n            });\n    }\n\n    render() {\n\n        return (\n            <Modal\n                modalId='reset-password-modal'\n                modalTitle={\"Reset Password\"}\n                isOpen={this.props.isOpen}\n                handleClose={() => this.closeModal()}\n            >\n\n                <div className=\"modal-content-padding center-text\">\n\n                    {!this.state.error && !this.state.successReset &&\n                        <>\n                            <h3 className=\"h5-font\">Are you sure you want to reset your password?</h3>\n                            <ul className=\"button-group\">\n                                <li><button onClick={(e) => this.resetPassword(e)} className=\"default-button\">Reset Password</button></li>\n                                <li><button onClick={() => this.closeModal()} className=\"button-link\">Cancel</button></li>\n                            </ul>\n                        </>\n                    }\n                    {this.state.error &&\n                        <p className=\"error-font\" aria-live=\"polite\">\n                            {this.state.error}\n                        </p>\n                    }\n                    {this.state.successReset &&\n                        <div aria-live=\"polite\">\n                           <h3 className=\"h5-font\">Check your email to reset your password.</h3> \n                        </div>}\n\n                </div>\n\n            </Modal>\n        )\n    }\n}\n\nResetPasswordModal.propTypes = {\n    email: PropTypes.string,\n    handleClose: PropTypes.func.isRequired,\n    logInLocation: PropTypes.string.isRequired,\n    isOpen: PropTypes.bool.isRequired\n}\n\nexport default ResetPasswordModal;","import PropTypes from 'prop-types';\n\nfunction TextInput(props) {\n\n    let { className, ...rest } = props;\n\n    return <input type=\"text\" className={`text-bar ${className ? className : ''}`} {...rest} />\n    \n}\n\nTextInput.propTypes = {\n    className: PropTypes.string\n}\n\nexport default TextInput;","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport firebase from '../../utils/firebase/firebaseConfig'\nimport TextInput from '../forms/TextInput'\nimport Modal from './Modal'\n\n\nclass ChangeDisplayNameModal extends React.Component {\n    state = {\n        error: '',\n        newName: '',\n        nameUpdated: false,\n        loading: false\n    }\n\n    closeModal() {\n        this.setState({\n            confirmReset: false,\n            nameUpdated: false\n        }, () => this.props.handleClose());\n    }\n\n    handleInput(e) {\n        this.setState({ newName: e.target.value, nameUpdated: true })\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n\n    // updateUser() {\n    //     if (this._isMounted) {\n\n    //         let user = firebase.auth().currentUser;\n\n    //         if (user) {\n    //             this.setState({\n    //                 currentName: user.displayName\n    //             })\n    //         }\n    //     }\n    // }\n\n\n\n    changeDisplayName(e) {\n        e.preventDefault();\n        let form = this;\n\n        form.setState({ error: '', loading: true })\n\n        let user = firebase.auth().currentUser;\n\n        let newName = this.state.newName;\n\n\n        //check that name and lastname does not include special characters, except for hypens\n        let testString = /^[a-zA-Z][ a-zA-Z \\-' -]+$/;\n\n\n        if (!testString.test(newName)) {\n            form.setState({ error: \"Display can only contain letters, apostrophes, hypens and spaces.\" })\n        } else {\n                let database = firebase.database();\n\n                let userId = user.uid\n                \n\n                database.ref(`users/${userId}`).update({\n                    displayName: newName\n                }\n                   \n                ).catch((error) => {\n                    console.log(error)\n                })\n           // })\n            .then(function () {\n                // Update successful.\n                form.props.triggerUpdate();\n                form.props.handleClose()\n                form.setState({loading: false})\n            }).catch(function (error) {\n                // An error happened.\n                form.setState({error: error.message, loading: false})\n            });\n\n        }\n\n    }\n\n    render() {\n\n        return (\n            <Modal\n                modalId='reset-password-modal'\n                modalTitle={\"Change Display Name\"}\n                isOpen={this.props.isOpen}\n                handleClose={() => this.closeModal()}\n            >\n\n                <div className=\"modal-content-padding\">\n\n\n                    {this.state.error &&\n                        <p className=\"error-font\" aria-live=\"polite\">\n                            {this.state.error}\n                        </p>\n                    }\n                    <label htmlFor=\"new-name\">New Name</label>\n                    <TextInput id=\"new-name\" value={this.state.nameUpdated ? this.state.newName : this.props.currentName} onChange={(e) => this.handleInput(e)} />\n\n\n                    <div aria-live=\"polite\">\n                        <button onClick={(e) => this.changeDisplayName(e)} className=\"default-button\">\n                            {this.state.loading ? 'Changing Name' : 'Change Display Name'}\n                        </button>\n                    </div>\n                </div>\n\n            </Modal>\n        )\n    }\n}\n\nChangeDisplayNameModal.propTypes = {\n    handleClose: PropTypes.func.isRequired,\n    triggerUpdate: PropTypes.func.isRequired,\n    isOpen: PropTypes.bool.isRequired,\n    currentName: PropTypes.string\n}\n\nexport default ChangeDisplayNameModal;","\nimport React from 'react'\nimport firebase from '../utils/firebase/firebaseConfig'\nimport ResetPasswordModal from '../components/modals/ResetPasswordModal'\nimport ChangeDisplayNameModal from '../components/modals/ChangeDisplayName'\n\n\nclass Account extends React.Component {\n\n    state = {\n        displayName: '',\n        email: '',\n        successReset: false,\n        resetPassword: false,\n        changeName: false\n    }\n\n\n    _isMounted = false;\n\n\n\n    componentDidMount() {\n        this._isMounted = true;\n        this.updateUser();\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n    openPasswordModal() {\n        this.setState({ resetPassword: true })\n    }\n\n    closePasswordModal(reseted) {\n        this.setState({ resetPassword: false })\n\n        if(reseted) {\n            firebase.auth().signOut()\n        }\n    }\n\n    openDisplayNameModal() {\n        this.setState({ changeName: true })\n    }\n\n    closeDisplayNameModal() {\n        this.setState({ changeName: false })\n    }\n\n    updateUser() {\n\n        let component = this;\n\n        if (this._isMounted) {\n\n            let user = firebase.auth().currentUser;\n            let userId = user.uid;\n\n            if (userId) {\n                let database = firebase.database();\n\n\n                database.ref(`users/${userId}`).get().then(function (snapshot) {\n                    if (snapshot.exists()) {\n\n                        let displayName = snapshot.val().displayName;\n                        let email = user.email;\n\n\n\n                        component.setState({\n                            displayName: displayName,\n                            email: email\n                        })\n                    }\n                    else {\n                        console.log(\"No data available\");\n                    }\n                }).catch(function (error) {\n                    console.error(error);\n                });\n\n\n\n            }\n        }\n    }\n\n    render() {\n\n        return (\n            <>\n                <div className={`container trips mobile-padding`}>\n                    <h2>Account Settings</h2>\n                    <ul className=\"settings-list\">\n                        <li aria-live=\"polite\">\n                            Display Name: {this.state.displayName}\n                            <button onClick={() => this.openDisplayNameModal()} className=\"secondary-button\">Change Display Name</button>\n                        </li>\n                        <li>\n                            <p>Email: {this.state.email}</p>\n                        </li>\n                        <li>\n                            Password: **** <button onClick={() => this.openPasswordModal()} className=\"secondary-button\">Reset Password</button>\n                        </li>\n                    </ul>\n\n                    <button className=\"button-link\"\n                        onClick={\n                            () => {\n                                firebase.auth().signOut()\n                            }\n                        }>Sign Out</button>\n                </div>\n                <ResetPasswordModal\n                    email={this.state.email}\n                    handleClose={(reseted) => this.closePasswordModal(reseted)}\n                    logInLocation=\"account\"\n                    isOpen={this.state.resetPassword}\n                />\n\n                <ChangeDisplayNameModal\n                    handleClose={() => this.closeDisplayNameModal()}\n                    currentName={this.state.displayName}\n                    isOpen={this.state.changeName}\n                    triggerUpdate={() => this.updateUser()}\n                />\n\n            </>\n        )\n\n    }\n}\n\nexport default Account;","import firebase from './firebase/firebaseConfig'\n\nlet getPublicTrips = (callback) => {\n   \n    let database = firebase.database();\n    let existingTrips = [];\n\n    database.ref(`publicTrips`).get().then((snapshot) => { \n\n        let trips = snapshot.val();\n\n\n        for (const tripId in trips) {\n     \n                    //get title\n                    let title = trips[tripId]['tripName']\n\n                    //get locationsCount\n                    let locationsCount = trips[tripId]['locationsCount']\n\n                    //get thumnail\n                    let thumbnail = trips[tripId]['featuredImg']\n\n                    //get authorId\n                    let authorId = trips[tripId]['author']\n\n                    //get tags\n                    let tags = trips[tripId]['tags']\n\n                    let existingTripUpdate = {\n                        tripId: tripId,\n                        thumbnail: thumbnail,\n                        title: title,\n                        locationsCount: locationsCount,\n                        privacy: 'public',\n                        authorId: authorId,\n                        tags: tags ? tags : ''\n                    }\n\n                existingTrips.push(existingTripUpdate)\n        }\n\n        return existingTrips\n    }).catch(error => console.log(error)).then((existingTrips) => callback(existingTrips))\n}\n\nexport default getPublicTrips;","function OneToTwoCols(props) {\n\n    return (\n        <div className={`grid-1_2`}>\n            {props.children}\n        </div>\n    )\n\n}\n\nexport default OneToTwoCols;","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { Link } from 'react-router-dom'\nimport firebase from '../../utils/firebase/firebaseConfig'\n\n\nclass TripCard extends React.Component{\n    \n    state = {\n        authorName: ''\n    }\n    _isMounted = false;\n\n    getAuthor = (authorId) =>{\n        let database = firebase.database()\n        database.ref(`users/${authorId}/displayName`).get().catch(error=>console.log(error)).then(\n           snapshot => {\n               if(snapshot){\n                   let authorName = snapshot.val()\n                   this._isMounted && this.setState({authorName: authorName})\n               }\n           }\n        )\n    }\n\n    componentDidMount() {\n        this._isMounted = true\n        this.getAuthor(this.props.authorId)\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false\n    }\n    \n    \n    render() {\n\n        let {\n            thumbnail,\n            title,\n            tripId,\n            privacy,\n            locationsCount } = this.props;\n\n    \n        return (\n            <Link className={`trip-card`} to={ `/trip/${tripId}?privacy=${privacy}`}>\n    \n                <div className={`trip-card-image`}>\n                    <img src={thumbnail} alt=\"\" />\n                </div>\n                <div className={`trip-card-content`}>\n                    <h3 className={`title`}>{title}</h3>\n                    <p className={`meta-data`}>by {this.state.authorName}</p>\n                    <p className={`meta-data ${privacy}`}>\n                        {privacy}</p> \n                    <p className={`meta-data marker`}>\n                       {locationsCount} {(locationsCount > 1 || locationsCount < 1) ? 'Locations' : 'Location'}</p>\n                </div>\n    \n            </Link>\n        )\n    \n\n    }\n}\n\nTripCard.propTypes = {\n    thumbnail: PropTypes.string,\n    title: PropTypes.string,\n    isPublic: PropTypes.bool,\n    locationCount: PropTypes.number,\n    tripId: PropTypes.string,\n    authorId: PropTypes.string,\n    isShared: PropTypes.bool\n}\n\n\nexport default TripCard;","import OneToTwoCols from '../layout/OneToTwoCols'\nimport TripCard from '../cards/TripCard'\n\n\nfunction UnfilteredTrips({existingTrips}) {\n    return (<>\n        <div aria-live=\"polite\" className=\"sr-only\">\n            <p>Showing trips</p>\n        </div>\n        <OneToTwoCols>\n            {existingTrips.map((trip, index) => {\n                let {\n                    thumbnail,\n                    title,\n                    locationsCount,\n                    privacy,\n                    tripId,\n                    authorId } = trip;\n\n                return (\n                    <TripCard\n                        key={index}\n                        thumbnail={thumbnail}\n                        title={title}\n                        tripId={tripId}\n                        privacy={privacy}\n                        locationsCount={locationsCount}\n                        authorId={authorId}\n                    />\n                )\n            })}\n        </OneToTwoCols>\n    </>)\n}\n\nexport default UnfilteredTrips;","import OneToTwoCols from '../layout/OneToTwoCols'\nimport TripCard from '../cards/TripCard'\n\nfunction FilteredTrips({loading, searchResults}) {\n   \n    while (loading) {\n        return (\n            <div aria-live=\"polite\">\n                <p>Getting trips...</p>\n            </div>\n        )\n    }\n\n    if (searchResults.length > 0) {\n        return (\n            <>\n                <div aria-live=\"polite\" className=\"sr-only\">\n                    <p>Showing search results</p>\n                </div>\n                <OneToTwoCols>\n                    {searchResults.map((trip, index) => {\n                        let {\n                            thumbnail,\n                            title,\n                            locationsCount,\n                            privacy,\n                            tripId,\n                            authorId } = trip;\n\n                        return (\n                            <TripCard\n                                key={index}\n                                thumbnail={thumbnail}\n                                title={title}\n                                tripId={tripId}\n                                privacy={privacy}\n                                locationsCount={locationsCount}\n                                authorId={authorId}\n                            />\n                        )\n                    })}\n                </OneToTwoCols>\n            </>\n        )\n    } else {\n        return <p>Sorry, no trips match your search criteria.</p>\n    }\n}\n\nexport default FilteredTrips;","import React from 'react'\nimport getPublicTrips from '../../utils/getPublicTrips'\nimport SearchBar from '../../components/forms/SearchBar'\nimport UnfilteredTrips from '../../components/content/UnfilteredTrips'\nimport FilteredTrips from '../../components/content/FilteredTrips'\n\nclass PublicTrips extends React.Component {\n    state = {\n        existingTrips: [],\n        loading: true,\n        searching: false,\n        loadingSearchResults: false,\n        searchResults: [],\n        searchTerms: ''\n    }\n\n    _isMounted = false;\n\n    componentDidMount() {\n        this._isMounted = true;\n        getPublicTrips((tripsList) => {\n            this._isMounted && this.setState({ existingTrips: tripsList, loading: false })\n        })\n    }\n\n    handleSearchInput(e) {\n        this.setState({ searchTerms: e.target.value }, () => {\n            if (!this.state.searchTerms) {\n                this.setState({ searching: false })\n            }\n        })\n    }\n\n    getSearchResults(e) {\n        e.preventDefault();\n\n        //use search terms to create searcResults array\n        let existingTrips = this.state.existingTrips;\n        let results = []\n        let searchTerms = this.state.searchTerms.toLowerCase();\n        \n        this.setState({ searching: true, loadingSearchResults: true })\n\n        existingTrips.forEach(trip => {\n            let title = trip.title.toLowerCase()\n            let tags = trip.tags.toLowerCase()\n\n            let titleMatch = title.includes(searchTerms)\n            let tagsMatch = tags.includes(searchTerms)\n\n            if (titleMatch || tagsMatch) {\n\n                results.push(trip)\n\n            }\n        }\n\n        )\n\n        this.setState({ loadingSearchResults: false, searchResults: results })\n\n    }\n\n    tripsList(existingTrips) {\n        let {searching, loadingSearchResults, searchResults} = this.state;\n        if (!searching) {\n            return <UnfilteredTrips existingTrips={existingTrips}/>\n        } else {\n            return <FilteredTrips loading={loadingSearchResults} searchResults={searchResults}/>\n        }\n    }\n\n    renderPublicTrips() {\n        let { existingTrips, loading } = this.state;\n\n        while (loading) {\n            return (\n                <div aria-live=\"polite\">\n                    <p>Getting trips...</p>\n                </div>\n            )\n        }\n        if (existingTrips.length > 0) {\n            return (\n                <>\n                    <SearchBar\n                        className=\"border-search\"\n                        id=\"trips-search\"\n                        placeholder=\"cityscapes\"\n                        labelText=\"Search trips by tags or title\"\n                        value={this.state.searchTerms}\n                        onChange={(e) => this.handleSearchInput(e)}\n                        onClick={(e) => this.getSearchResults(e)}\n                    />\n                    {this.tripsList(existingTrips)}\n                </>\n            )\n        } else {\n            return (\n                <div aria-live=\"polite\">\n                    <p>No trips here yet.</p>\n                </div>\n            )\n        }\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n    render() {\n        return (\n            <>\n                {this.renderPublicTrips()}\n            </>\n        )\n    }\n\n}\n\n\n\nexport default PublicTrips;","import PropTypes from 'prop-types';\n\nfunction EmailInput(props) {\n\n    let { className, ...rest} = props;\n\n    return <input type=\"email\" className={`text-bar ${className ? className : ''}`} {...rest} />\n}\n\nEmailInput.propTypes = {\n    className: PropTypes.string\n}\n\nexport default EmailInput;","import PropTypes from 'prop-types';\nimport React from 'react'\nimport CheckBox from './CheckBox'\n\n\nclass PasswordInput extends React.Component {\n    state = {\n        type: \"password\"\n    }\n\n    changeType() {\n        if (this.state.type === \"password\") {\n            this.setState(\n                { type: \"text\" }\n            )\n        }\n        else {\n            this.setState(\n                { type: \"password\" }\n            )\n\n        }\n    }\n\n    render() {\n\n        let { className, checkName, ...rest } = this.props;\n\n\n        return (\n            <>\n                <input type={this.state.type} \n                    className={`text-bar ${className ? className : ''}`} \n                    {...rest} \n                  /><br/>\n                \n\n            <CheckBox className=\"show-pass\" name={checkName ?  checkName : 'show-pass'} onChange={() => { this.changeType()}} labelText=\"Show password\" />\n\n            </>\n        )\n    }\n\n}\n\nPasswordInput.propTypes = {\n    className: PropTypes.string\n}\n\n\nexport default PasswordInput;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport EmailInput from '../../components/forms/EmailInput'\nimport PasswordInput from '../../components/forms/PasswordInput'\nimport SubmitButton from '../../components/forms/SubmitButton'\nimport firebase from '../../utils/firebase/firebaseConfig'\n\n\n\nclass SignIn extends React.Component {\n\n  state = {\n    email: '',\n    emailError: '',\n    successReset: false,\n    forgotPassword: false\n  }\n\n  handleEmailInput(e) {\n    this.setState({ email: e.target.value })\n  }\n\n  togglePasswordReset(e) {\n    e.preventDefault();\n    this.setState({forgotPassword: !this.state.forgotPassword})\n  }\n\n  resetPassword(e) {\n    e.preventDefault();\n\n    let auth = firebase.auth();\n\n    let emailAddress = this.state.email;\n\n    let form = this;\n\n    form.setState({emailError:''})\n\n    let actionCodeSettings = { url: `https://photoatlasapp.com/` }\n\n\n    auth.sendPasswordResetEmail(emailAddress, actionCodeSettings).then(() => {\n        form.setState({successReset: true, forgotPassword: false, email: ''})\n    } \n    ).catch(function (error) {\n        form.setState({\n          emailError: error.message, \n          forgotPassword: true, \n          successReset: false\n        })\n    });\n  }\n\n\n  render() {\n    return (\n      <>\n        <div className={`container mobile-padding`}>\n          <div className={this.props.hideTitle ? \"hidden\" : \"visible\"}>\n            {this.props.tabContent ? <h3>Sign In</h3> : <h2>Sign In</h2>}\n\n            {this.props.tabContent ?\n              <h4 className=\"h5-font\">Sign in to {this.props.introtext}.</h4> :\n              <h3 className=\"h5-font\">Sign in to {this.props.introtext}.</h3>}\n          </div>\n\n    \n          <p className={`${this.state.successReset ? \"visible\" : \"hidden\"} success-font`} aria-live=\"polite\">Check your email to reset your password.</p> \n\n          <form className={this.state.forgotPassword? 'hidden' : 'visible'} action={\"/\"} onSubmit={(e) => this.props.handleSubmit(e)}>\n\n            <div className=\"form-component-wrapper\">\n              <label htmlFor=\"email\">Email</label>\n              <EmailInput autoComplete=\"username\"\n                id=\"email\"\n                value={this.props.email}\n                onChange={(e) => this.props.handleEmailInput(e)} required />\n              {this.props.emailError && <p className=\"error-font\" aria-live=\"polite\">{this.props.emailError}</p>}\n            </div>\n\n            <div className=\"form-component-wrapper\">\n              <label htmlFor=\"pass\">Password</label>\n              <PasswordInput autoComplete=\"current-password\"\n                id=\"pass\"\n                value={this.props.password}\n                onChange={(e) => this.props.handlePassInput(e)} required />\n              {this.props.passError && <p className=\"error-font\" aria-live=\"polite\">{this.props.passError}</p>}\n            </div>\n\n            <div className=\"form-component-wrapper\">\n              <SubmitButton value={`${this.props.loading ? 'Signing In...' : 'Sign In'}`} />\n            </div>\n\n          </form>\n\n          <div className={`${this.state.forgotPassword ? 'hidden' : 'visible'} form-component-wrapper`}>\n              <button\n                onClick={(e) => { this.togglePasswordReset(e) }}\n                className=\"secondary-button forgot-pass\">Forgot password?</button>\n            </div>\n\n          <form className={this.state.forgotPassword ? 'visible' : 'hidden'} action={\"/\"}  onSubmit={(e) => this.resetPassword(e)}>\n            <div className=\"form-component-wrapper\">\n              \n              <label htmlFor=\"password-reset-email\">Email</label>\n              \n              <EmailInput id=\"password-reset-email\"\n                value={this.state.email}\n\n                onChange={(e) => this.handleEmailInput(e)} required />\n              \n                {this.state.emailError && <p className=\"error-font\"\n                aria-live=\"polite\">\n                  {this.state.emailError}\n                  </p>}\n            </div>\n            \n            <div className=\"form-component-wrapper\">\n              <SubmitButton value=\"Reset Password\" />\n            </div>\n          </form>\n\n\n          <div className={`${this.state.forgotPassword ? 'visible' : 'hidden'} form-component-wrapper`}>\n            <button className=\"button-link\" onClick={(e) => { this.togglePasswordReset(e) }}>\n              Sign In\n              </button>\n          </div>\n\n\n        </div>\n      </>\n    )\n\n  }\n\n}\n\n\n\nSignIn.propTypes = {\n  introtext: PropTypes.string,\n  handleSubmit: PropTypes.func,\n  email: PropTypes.string,\n  handleEmailInput: PropTypes.func,\n  emailError: PropTypes.string,\n  password: PropTypes.string,\n  handlePassInput: PropTypes.func,\n  passError: PropTypes.string,\n  tabContent: PropTypes.bool,\n  hiddeTitle: PropTypes.bool,\n  logInLocation: PropTypes.string\n}\n\n\nexport default SignIn;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport EmailInput from '../../components/forms/EmailInput'\nimport TextInput from '../../components/forms/TextInput'\nimport PasswordInput from '../../components/forms/PasswordInput'\nimport SubmitButton from '../../components/forms/SubmitButton'\n\n\n\nfunction SignUp(props) {\n\n  return (\n    <>\n      <div className={`container mobile-padding`}>\n        <div className={props.hideTitle ? \"hidden\" : \"visible\"}>\n          {props.tabContent ? <h3>Sign Up</h3> : <h2>Sign Up</h2>}\n\n          {props.tabContent ?\n            <h4 className=\"h5-font\">Create an account to {props.introtext}.</h4> :\n            <h3 className=\"h5-font\">Create an account to {props.introtext}.</h3>}\n        </div>\n        <form action={\"/\"} onSubmit={(e) => props.handleSubmit(e)}>\n\n\n\n          <div className=\"form-component-wrapper\">\n            <label htmlFor=\"firstname\">Name</label>\n            <TextInput autoComplete=\"name\" id=\"firstname\" value={props.firstname} onChange={(e) => props.handleNameInput(e)} required />\n            {props.nameError && <p className=\"error-font\" aria-live=\"polite\">{props.nameError}</p>}\n          </div>\n\n          <div className=\"form-component-wrapper\">\n            <label htmlFor=\"lastname\">Last Name <span>(Optional)</span></label>\n            <TextInput autoComplete=\"lastname\" id=\"lastname\" value={props.lastname} onChange={(e) => props.handleLastnameInput(e)} />\n            {props.lastnameError && <p className=\"error-font\" aria-live=\"polite\">{props.lastnameError}</p>}\n          </div>\n\n\n          <div className=\"form-component-wrapper\">\n            <label htmlFor=\"email\">Email</label>\n            <EmailInput autoComplete=\"username\" id=\"email\" value={props.email} onChange={(e) => props.handleEmailInput(e)} required />\n            {props.emailError && <p className=\"error-font\" aria-live=\"polite\">{props.emailError}</p>}\n          </div>\n\n\n\n          <div className=\"form-component-wrapper\">\n            <label htmlFor=\"pass\">Password (6 characters minimum)</label>\n            <PasswordInput autoComplete=\"new-password\" id=\"pass\" value={props.password} onChange={(e) => props.handlePassInput(e)} required />\n            {props.passError && <p className=\"error-font\" aria-live=\"polite\">{props.passError}</p>}\n          </div>\n\n\n          <div className=\"form-component-wrapper\">\n            <label htmlFor=\"confirm-pass\">Confirm Password</label>\n            <PasswordInput  autoComplete=\"new-password\" checkName=\"show-confirm-pass\" id=\"confirm-pass\" value={props.confirmPassword} onChange={(e) => props.handleConfirmPassInput(e)} required />\n            {props.confirmPassError && <p className=\"error-font\" aria-live=\"polite\">{props.confirmPassError}</p>}\n          </div>\n\n          <div className=\"form-component-wrapper\">\n            <SubmitButton value={`${props.loading ? 'Creating Account...' : 'Create Account'}`} />\n          </div>\n\n        </form>\n      </div>\n    </>\n  )\n\n}\n\n\n\nSignUp.propTypes = {\n  introtext: PropTypes.string,\n  handleSubmit: PropTypes.func,\n  name: PropTypes.string,\n  handleNameInput: PropTypes.func,\n  nameError: PropTypes.string,\n  lastname: PropTypes.string,\n  handleLastnameInput: PropTypes.func,\n  lastnameError: PropTypes.string,\n  email: PropTypes.string,\n  handleEmailInput: PropTypes.func,\n  emailError: PropTypes.string,\n  password: PropTypes.string,\n  handlePassInput: PropTypes.func,\n  passError: PropTypes.string,\n  confirmPassword: PropTypes.string,\n  handleConfirmPassInput: PropTypes.func,\n  confirmPassError: PropTypes.string,\n  tabContent: PropTypes.bool,\n  hiddeTitle: PropTypes.bool\n}\n\n\nexport default SignUp;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport firebase from '../../utils/firebase/firebaseConfig'\n\nimport SignIn from './SignIn'\nimport SignUp from './SignUp'\n\n\n\nclass Authenticate extends React.Component {\n\n    state = {\n        newUser: false,\n        firstname: '',\n        lastname: '',\n        email: '',\n        password: '',\n        confirmPassword: '',\n        emailError: '',\n        passError: '',\n        confirmPassError: '',\n        nameError: '',\n        lastnameError: '',\n        loading: false\n    }\n\n    handleSignIn(e) {\n\n        e.preventDefault();\n        this.setState({\n            emailError: '',\n            passError: '',\n            loading: true\n        })\n\n\n        let email = this.state.email;\n        let password = this.state.password;\n        let component = this;\n\n\n        firebase.auth().fetchSignInMethodsForEmail(email).then(\n            signInMethods => {\n                if (signInMethods.indexOf(firebase.auth.EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD) !== -1) {\n\n                    firebase.auth().signInWithEmailAndPassword(email, password).then(\n                        (userCredential) => {\n                            if (this.props.afterSignIn) {\n                                let user = userCredential.user;\n                                this.props.afterSignIn(user)\n                            }\n                        }\n                    )\n                        .catch((error) => {\n                            let errorCode = error.code;\n                            let errorMessage = error.message;\n                            if (errorCode === \"auth/too-many-requests\") {\n                                component.setState({ passError: \"Too many sign in attempts, reset password or try again later.\" })\n                            }\n                            else if (errorCode === \"auth/wrong-password\") {\n                                component.setState({ passError: \"Invalid password\" })\n                            }\n                            else {\n                                component.setState({ passError: errorMessage })\n                            }\n\n                        });\n                }\n\n                else {\n                    this.setState({ emailError: \"Couldn't find an account with that email.\" })\n                }\n\n            }\n        )\n\n        this.setState({ loading: false })\n\n    }\n\n\n    handleCreateAccount(e) {\n\n        e.preventDefault();\n        this.setState({\n            confirmPassword: '',\n            emailError: '',\n            passError: '',\n            confirmPassError: '',\n            nameError: '',\n            lastnameError: '',\n            loading: true\n        })\n\n\n        let email = this.state.email;\n        let password = this.state.password;\n        let confirmPassword = this.state.confirmPassword;\n        let firstname = this.state.firstname;\n        let lastname = this.state.lastname;\n\n        let component = this;\n\n\n        firebase.auth().fetchSignInMethodsForEmail(email).then(\n            signInMethods => {\n                if (signInMethods.indexOf(firebase.auth.EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD) !== -1) {\n                    this.setState({ emailError: \"An account exist with that email.\" })\n                }\n\n                else {\n                    //check that name and lastname does not include special characters, except for hypens\n                    let testString = /^[a-zA-Z][ a-zA-Z \\-' -]+$/;\n\n\n                    if (!testString.test(firstname)) {\n                        component.setState({ nameError: \"Name can only contain letters, apostrophes, hypens and spaces.\" })\n                    }\n\n                    if (lastname) {\n                        if (!testString.test(lastname)) {\n                            component.setState({ lastnameError: \"Last name can only contain letters, apostrophes, hypens and spaces.\" })\n\n                        }\n                    }\n\n                    //check that name and lastname are longer than 1 character\n                    if (firstname.length === 1) {\n                        component.setState({ nameError: \"Name must be longer than one character.\" })\n                    }\n\n                    if (lastname.length === 1) {\n                        component.setState({ lastnameError: \"Last name, if provided, must be longer than one character.\" })\n                    }\n\n                    //check that passworrd is longer than 5 characters\n                    if (password.length < 6) {\n                        component.setState({ passError: \"Passowrd must be at least 6 characters long.\" })\n                    }\n\n                    //check that passwords match\n                    if (password !== confirmPassword) {\n                        component.setState({ confirmPassError: \"Passwords don't match\" })\n                    }\n\n                    //check that there are no errors\n                    if (!this.state.emailError && !this.state.confirmPassError && !this.state.nameError && !this.state.passError) {\n                        //create account\n                        let displayName = firstname;\n\n                        if (firstname && lastname) {\n                            displayName = `${firstname} ${lastname}`\n                        }\n                        //create credentials\n                        firebase.auth().createUserWithEmailAndPassword(email, password).then(userCredential => {\n                            let user = userCredential.user;\n                            let userId = user.uid;\n                            let email = user.email;\n                        \n\n                            //add user displayName and email to databsse\n                            let userInfo = {\n                                email: email,\n                                displayName: displayName\n                            }\n                            let database = firebase.database();\n\n                            database.ref(`users/${userId}`).set(\n                                userInfo\n                            ).catch((error) => {\n                                console.log(error)\n                            })\n\n                            if (this.props.afterCreateAccount) {\n                                let user = userCredential.user;\n                                this.props.afterCreateAccount(user)\n                            }\n\n                        }\n\n                        )\n                            .catch((error) => {\n                                var errorCode = error.code;\n                                var errorMessage = error.message;\n\n                                if (errorCode === \"auth/email-already-in-use\") {\n                                    this.setState({ emailError: \"An account exist with that email.\" })\n                                }\n\n                                if (errorCode === \"auth/invalid-email\") {\n                                    this.setState({ emailError: \"Please use a valid email address\" })\n                                }\n\n                                if (errorCode === \"auth/operation-not-allowed\") {\n                                    this.setState({ emailError: errorMessage })\n                                }\n\n                                if (errorCode === \"auth/weak-password\") {\n                                    component.setState({ passError: \"Passowrd must be at least 6 characters long.\" })\n                                }\n                            });\n                    }\n\n                }\n\n            }\n        )\n        this.setState({ loading: false })\n\n    }\n\n    handleEmailInput(e) {\n        this.setState({ email: e.target.value })\n    }\n\n    handlePassInput(e) {\n        this.setState({ password: e.target.value })\n    }\n\n    handleNameInput(e) {\n        this.setState({ firstname: e.target.value })\n    }\n\n    handleLastnameInput(e) {\n        this.setState({ lastname: e.target.value })\n    }\n\n    handleConfirmPassInput(e) {\n        this.setState({ confirmPassword: e.target.value })\n    }\n\n\n    changeUserType() {\n        this.setState({ newUser: !this.state.newUser }, () => {\n            if (this.props.changeUserOnParent) {\n                this.props.changeUserOnParent(this.state.newUser)\n            }\n        })\n    }\n\n    renderContent(newUser) {\n\n        let logInLocation = this.props.logInLocation;\n\n        let trips = 'trips'\n        let add = 'add'\n        let account = 'account'\n\n\n        let text;\n\n        switch (logInLocation) {\n            case trips:\n                text = \"view your trips\"\n                break;\n            case add:\n                text = \"add a location\"\n                break;\n            case account:\n                text = \"view your account information\"\n                break;\n            default:\n                text = \"continue your PhotoAtlas journey\"\n        }\n\n        if (newUser) {\n            return (\n                <>\n                    <SignUp\n                        hideTitle={this.props.hideTitle ? true : false}\n                        tabContent={this.props.tabContent}\n                        introtext={text}\n                        handleSubmit={(e) => this.handleCreateAccount(e)}\n                        email={this.state.email}\n                        handleEmailInput={(e) => this.handleEmailInput(e)}\n                        emailError={this.state.emailError}\n                        password={this.state.password}\n                        handlePassInput={(e) => this.handlePassInput(e)}\n                        passError={this.state.passError}\n                        loading={this.state.loading}\n\n                        firstname={this.state.firstname}\n                        nameError={this.state.nameError}\n                        handleNameInput={(e) => this.handleNameInput(e)}\n\n                        lastname={this.state.lastname}\n                        lastnameError={this.state.lastnameError}\n                        handleLastnameInput={(e) => this.handleLastnameInput(e)}\n\n                        confirmPassword={this.state.confirmPassword}\n                        confirmPassError={this.state.confirmPassError}\n                        handleConfirmPassInput={(e) => this.handleConfirmPassInput(e)}\n                    />\n                </>\n            )\n        }\n        else {\n            return (\n                <>\n                    <SignIn\n                        hideTitle={this.props.hideTitle ? true : false}\n                        tabContent={this.props.tabContent}\n                        introtext={text}\n                        handleSubmit={(e) => this.handleSignIn(e)}\n                        email={this.state.email}\n                        handleEmailInput={(e) => this.handleEmailInput(e)}\n                        emailError={this.state.emailError}\n                        password={this.state.password}\n                        handlePassInput={(e) => this.handlePassInput(e)}\n                        passError={this.state.passError}\n                        loading={this.state.loading}\n                        logInLocation={logInLocation}\n                    />\n                </>\n            )\n        }\n    }\n\n\n    render() {\n\n        let { newUser } = this.state;\n\n        return (\n            <>\n\n                {this.renderContent(newUser)}\n\n                <div className=\"container mobile-padding\">\n                    <button className=\"button-link\" onClick={() => this.changeUserType()}>\n                        {newUser ? \"Sign In\" : \"Create Account\"}\n                    </button>\n                </div>\n            </>\n\n        )\n\n    }\n\n}\n\nAuthenticate.propTypes = {\n    logInLocation: PropTypes.string,\n    tabContent: PropTypes.bool,\n    hideTitle: PropTypes.bool,\n    afterSignIn: PropTypes.func,\n    afterCreateAccount: PropTypes.func\n}\n\n\nexport default Authenticate;","import React from 'react'\nimport PropTypes from 'prop-types';\nimport firebase from '../../utils/firebase/firebaseConfig'\n\n\nclass VerifyEmail extends React.Component {\n\n    state = {\n        error: null\n    }\n\n    componentDidMount() {\n\n        let user = firebase.auth().currentUser;\n        let component = this;\n\n        let actionCodeSettings = {\n            url: `https://photoatlasapp.com/`\n        };\n\n        if (user) {\n\n            user.sendEmailVerification(actionCodeSettings)\n                .catch(function (error) {\n                    component.setState({ error: `${error}` })\n                });\n\n        }\n\n    }\n\n    renderContent() {\n        if (!this.state.error) {\n            return (\n                <>\n                    {this.props.tabContent ? \n                        <h3 className=\"h4-font\">Just one more step</h3> :\n                        <h2 className=\"h4-font\">Just one more step</h2>}\n                    <p>\n                        We've sent a verification link to your email.<br />\n                        Please check your inbox to verify your account.\n                    </p>\n\n                    <h3 className=\"h6-font\">\n                        Need a new link?\n                    </h3>\n\n                    <button className=\"button-link\">Re-Send Link</button>\n\n                </>\n\n            )\n        }\n        else {\n            return (\n                <>\n                    <h2 className=\"h4-font\">Sorry, there was a problem</h2>\n                    <p className=\"error-font\">{this.state.error}</p>\n                    <p>\n                        Please contact support at photoatlasapp@gmail.com.\n                </p>\n                </>\n            )\n        }\n    }\n\n    render() {\n        return (\n            <>\n                <div className={`container mobile-padding`}>\n                    {this.renderContent()}\n                    <button className=\"secondary-button back-button\"\n                        onClick={\n                            () => {\n                                firebase.auth().signOut()\n                            }\n                        }>\n                        Back to Sign In\n                    </button>\n                </div>\n            </>\n        )\n    }\n}\n\nVerifyEmail.propTypes = {\n    logInLocation: PropTypes.string,\n    tabContent: PropTypes.bool\n}\n\nexport default VerifyEmail;","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Authenticate from '../../screens/authentication/Authenticate'\nimport VerifyEmail from '../../screens/authentication/VerifyEmail'\n\n\n\n\nfunction PrivateTab (props) {\n        if (props.isAuthenticated) {\n            if (!props.isVerified) {\n                return <VerifyEmail logInLocation={props.logInLocation} tabContent={true}/>\n            } else {\n               return props.componentContent();\n            }\n        }\n        else {\n            return (\n                <Authenticate logInLocation={props.logInLocation} tabContent={true}/>\n            )\n        }\n}\n\nPrivateTab.propTypes = {\n    logInLocation: PropTypes.string,\n    componentContent: PropTypes.func.isRequired\n}\n\n\n\nexport default PrivateTab;","import firebase from './firebase/firebaseConfig'\n\nlet getUserTrips = (userId, callback, locationId = null) => {\n\n    let database = firebase.database();\n    let existingTrips = [];\n    if(userId) {\n        database.ref(`userTrips/${userId}`).get().then((snapshot) => {\n\n            if (snapshot.exists()) { \n                let trips = snapshot.val();\n    \n    \n                for (const tripId in trips) { \n                    let trip = trips[tripId]\n    \n                    //get privacy setting \n                    let privacy = trip['tripPrivacy']\n    \n                    let tripRef = `${privacy}Trips/${tripId}`\n    \n                    database.ref(`${tripRef}`).get().catch(error=>console.log(error)).then(\n                        (snapshot) => {\n                            if (snapshot.exists()) {\n                                let tripData = snapshot.val()\n                                //get title\n                                let title = tripData['tripName']\n    \n                                //get locationsCount\n                                let locationsCount = tripData['locationsCount']\n    \n                                //get thumnail\n                                let thumbnail = tripData['featuredImg']\n\n                                //get tags\n                                let tags = tripData['tags']\n    \n                                //see if location is in trip\n                                let inTrip;\n    \n                                if (locationId) {\n                                    let locations = tripData.locations;\n    \n    \n                                    if (locations) {\n                                        let location = locations[locationId]\n                                        if (location) {\n                                            inTrip = true\n                                        } else {\n                                            inTrip = false\n                                        }\n                                    } else {\n                                        inTrip = false\n                                    }\n                                }\n    \n                                let existingTripUpdate = {\n                                    tripId: tripId,\n                                    thumbnail: thumbnail,\n                                    title: title,\n                                    locationsCount: locationsCount,\n                                    privacy: privacy,\n                                    inTrip: inTrip,\n                                    authorId: userId,\n                                    tags: tags ? tags : ''\n                                }\n    \n                                existingTrips.push(existingTripUpdate)\n    \n                                return existingTrips\n                            } else {\n                                console.log(`issue fetching: ${tripRef}`)\n                            }\n                        }\n                    ).catch((error) => console.log(`could not fetch trips: ${error}`)).then((existingTrips) => callback(existingTrips))\n    \n                }\n    \n            } else {\n                callback(existingTrips)\n            }\n    \n        })\n\n    }\n\n}\n\nexport default getUserTrips;","import React from 'react'\nimport PropTypes from 'prop-types'\nimport PrivateTab from '../../components/navigation/PrivateTab'\nimport getUserTrips from '../../utils/getUserTrips'\nimport SearchBar from '../../components/forms/SearchBar'\nimport UnfilteredTrips from '../../components/content/UnfilteredTrips'\nimport FilteredTrips from '../../components/content/FilteredTrips'\n\nclass MyTrips extends React.Component {\n\n    state = {\n        existingTrips: [],\n        loading: true,\n        searching: false,\n        loadingSearchResults: false,\n        searchResults: [],\n        searchTerms: ''\n    }\n    _isMounted = false;\n\n    getTripsList() {\n        let userId = this.props.userId;\n        if (this.props.isAuthenticated) {\n            getUserTrips(userId, (tripsList) => {\n                if (tripsList.length > 0) {\n                    this._isMounted &&  this.setState({ existingTrips: tripsList, loading: false })\n                } else {\n                    this._isMounted && this.setState({ loading: false })\n                }\n            }\n            )\n        }\n    }\n\n    handleSearchInput(e) {\n        this.setState({ searchTerms: e.target.value }, () => {\n            if (!this.state.searchTerms) {\n                this.setState({ searching: false })\n            }\n        })\n    }\n\n    getSearchResults(e) {\n        e.preventDefault();\n\n        //use search terms to create searcResults array\n        let existingTrips = this.state.existingTrips;\n        let results = []\n        let searchTerms = this.state.searchTerms.toLowerCase();\n        \n        this.setState({ searching: true, loadingSearchResults: true })\n\n        existingTrips.forEach(trip => {\n            let title = trip.title.toLowerCase()\n            let tags = trip.tags.toLowerCase()\n\n            let titleMatch = title.includes(searchTerms)\n            let tagsMatch = tags.includes(searchTerms)\n\n            if (titleMatch || tagsMatch) {\n\n                results.push(trip)\n\n            }\n        }\n\n        )\n\n        this.setState({ loadingSearchResults: false, searchResults: results })\n\n    }\n\n    tripsList(existingTrips) {\n        let {searching, loadingSearchResults, searchResults} = this.state;\n        if (!searching) {\n            return <UnfilteredTrips existingTrips={existingTrips}/>\n        } else {\n            return <FilteredTrips loading={loadingSearchResults} searchResults={searchResults}/>\n        }\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n        this.getTripsList()\n    }\n\n    componentDidUpdate(nextProps) {\n        if(this.props.isAuthenticated !== nextProps.isAuthenticated) {\n            this.getTripsList()\n        }\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n    renderUserTrips() {\n\n        let { existingTrips, loading } = this.state;\n\n        while (loading) {\n            return (\n                <div aria-live=\"polite\">\n                    <p>Getting Trips...</p>\n                </div>\n            )\n        } \n        \n            if (existingTrips.length > 0) {\n                return (\n                    <>\n                    <SearchBar\n                        className=\"border-search\"\n                        id=\"trips-search\"\n                        placeholder=\"cityscapes\"\n                        labelText=\"Search trips by tags or title\"\n                        value={this.state.searchTerms}\n                        onChange={(e) => this.handleSearchInput(e)}\n                        onClick={(e) => this.getSearchResults(e)}\n                    />\n                    {this.tripsList(existingTrips)}\n                    </>)\n\n            } else {\n\n                return (\n                    <div aria-live=\"polite\">\n                        <p>No trips here yet.</p>\n                    </div>\n                )\n\n\n            }\n\n    }\n\n    render() {\n        return (\n            <>\n                <PrivateTab\n                    componentContent={() => this.renderUserTrips()}\n                    logInLocation={\"trips\"}\n                    isVerified={this.props.isVerified}\n                    isAuthenticated={this.props.isAuthenticated}\n                />\n            </>\n        )\n    }\n\n}\n\nMyTrips.propTypes = {\n    userId: PropTypes.string,\n    isAuthenticated: PropTypes.bool,\n    isVerified: PropTypes.bool\n}\n\n\n\nexport default MyTrips;","import firebase from './firebase/firebaseConfig'\n\nlet getUserTrips = (userId, callback) => {\n\n    let database = firebase.database();\n    let existingTrips = [];\n\n    if(userId) {\n        database.ref(`userBookmarks/${userId}`).get().then((snapshot) => {\n\n            if (snapshot.exists()) { \n                let trips = snapshot.val();\n    \n    \n                for (const tripId in trips) { \n                    let trip = trips[tripId]\n    \n                    //get privacy setting \n                    let privacy = trip['tripPrivacy']\n    \n                    let tripRef = `${privacy}Trips/${tripId}`\n    \n                    database.ref(`${tripRef}`).get().catch(error=>console.log(error)).then(\n                        (snapshot) => {\n                            if (snapshot.exists()) {\n                                let tripData = snapshot.val()\n                                //get title\n                                let title = tripData['tripName']\n    \n                                //get locationsCount\n                                let locationsCount = tripData['locationsCount']\n\n                                //get authorId\n                                let authorId = tripData['author']\n    \n                                //get thumnail\n                                let thumbnail = tripData['featuredImg']\n\n                                //get tags\n                                let tags = tripData['tags']\n    \n    \n                                let existingTripUpdate = {\n                                    tripId: tripId,\n                                    thumbnail: thumbnail,\n                                    title: title,\n                                    locationsCount: locationsCount,\n                                    privacy: privacy,\n                                    authorId: authorId,\n                                    tags: tags ? tags : ''\n                                }\n    \n                                existingTrips.push(existingTripUpdate)\n    \n                                return existingTrips\n                            } else {\n                                console.log(`issue fetching: ${tripRef}`)\n                            }\n                        }\n                    ).catch((error) => console.log(`could not fetch trips: ${error}`)).then((existingTrips) => callback(existingTrips))\n    \n                }\n    \n            } else {\n                callback(existingTrips)\n            }\n    \n        })\n\n    }\n\n}\n\nexport default getUserTrips;","import React from 'react'\nimport PropTypes from 'prop-types'\nimport PrivateTab from '../../components/navigation/PrivateTab'\nimport getUserBookmarks from '../../utils/getUserBookmarks'\nimport SearchBar from '../../components/forms/SearchBar'\nimport UnfilteredTrips from '../../components/content/UnfilteredTrips'\nimport FilteredTrips from '../../components/content/FilteredTrips'\n\n\n\nclass BookmarkedTrips extends React.Component {\n\n    state = {\n        existingTrips: [],\n        loading: true,\n        searching: false,\n        loadingSearchResults: false,\n        searchResults: [],\n        searchTerms: ''\n    }\n    _isMounted = false;\n\n    getTripsList() {\n        let userId = this.props.userId;\n        if (this.props.isAuthenticated) {\n            getUserBookmarks(userId, (tripsList) => {\n                if (tripsList.length > 0) {\n                    this._isMounted && this.setState({ existingTrips: tripsList, loading: false })\n                } else {\n                    this._isMounted && this.setState({ loading: false })\n                }\n            }\n            )\n        }\n    }\n\n    handleSearchInput(e) {\n        this.setState({ searchTerms: e.target.value }, () => {\n            if (!this.state.searchTerms) {\n                this.setState({ searching: false })\n            }\n        })\n    }\n\n    getSearchResults(e) {\n        e.preventDefault();\n\n        //use search terms to create searcResults array\n        let existingTrips = this.state.existingTrips;\n        let results = []\n        let searchTerms = this.state.searchTerms.toLowerCase();\n\n        this.setState({ searching: true, loadingSearchResults: true })\n\n        existingTrips.forEach(trip => {\n            let title = trip.title.toLowerCase()\n            let tags = trip.tags.toLowerCase()\n\n            let titleMatch = title.includes(searchTerms)\n            let tagsMatch = tags.includes(searchTerms)\n\n            if (titleMatch || tagsMatch) {\n\n                results.push(trip)\n\n            }\n        }\n\n        )\n\n        this.setState({ loadingSearchResults: false, searchResults: results })\n\n    }\n\n    tripsList(existingTrips) {\n        let { searching, loadingSearchResults, searchResults } = this.state;\n        if (!searching) {\n            return <UnfilteredTrips existingTrips={existingTrips} />\n        } else {\n            return <FilteredTrips loading={loadingSearchResults} searchResults={searchResults} />\n        }\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n        this.getTripsList()\n    }\n\n    componentDidUpdate(nextProps) {\n        if (this.props.isAuthenticated !== nextProps.isAuthenticated) {\n            this.getTripsList()\n        }\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n    renderUserBookmarks() {\n\n        let { existingTrips, loading } = this.state;\n\n        while (loading) {\n            return (\n                <div aria-live=\"polite\">\n                    <p>Getting Trips...</p>\n                </div>\n            )\n        }\n\n        if (existingTrips.length > 0) {\n            return (\n                <>\n                    <SearchBar\n                        className=\"border-search\"\n                        id=\"trips-search\"\n                        placeholder=\"cityscapes\"\n                        labelText=\"Search trips by tags or title\"\n                        value={this.state.searchTerms}\n                        onChange={(e) => this.handleSearchInput(e)}\n                        onClick={(e) => this.getSearchResults(e)}\n                    />\n                    {this.tripsList(existingTrips)}\n                </>)\n\n        } else {\n\n            return (\n                <div aria-live=\"polite\">\n                    <p>No trips here yet.</p>\n                </div>\n            )\n\n\n        }\n\n    }\n\n    render() {\n        return (\n            <>\n                <PrivateTab\n                    componentContent={() => this.renderUserBookmarks()}\n                    logInLocation={\"trips\"}\n                    isVerified={this.props.isVerified}\n                    isAuthenticated={this.props.isAuthenticated}\n                />\n            </>\n        )\n    }\n\n}\n\nBookmarkedTrips.propTypes = {\n    userId: PropTypes.string,\n    isAuthenticated: PropTypes.bool,\n    isVerified: PropTypes.bool\n}\n\n\n\nexport default BookmarkedTrips;","import React from 'react'\nimport PropTypes from 'prop-types';\nimport PublicTrips from './PublicTrips'\nimport MyTrips from './MyTrips'\nimport BookmarkedTrips from './BookmarkedTrips'\n\n\n\n\nclass Trips extends React.Component {\n\n    state = {\n        tab: 'public'\n    }\n\n    renderContent() {\n        let { tab } = this.state\n\n        // console.log(tab)\n        if (tab === 'public') {\n            return <PublicTrips />\n        }\n\n        if (tab === 'private') {\n            return (\n                <MyTrips\n                    isVerified={this.props.isVerified}\n                    isAuthenticated={this.props.isAuthenticated}\n                    userId={this.props.userId}\n                />\n            )\n        }\n\n        if (tab === 'bookmarks') {\n            return (\n                <BookmarkedTrips\n                    isVerified={this.props.isVerified}\n                    isAuthenticated={this.props.isAuthenticated}\n                    userId={this.props.userId}\n                />\n\n            )\n        }\n\n\n    }\n\n    switchTabs(value) {\n        this.setState({ tab: value })\n\n    }\n\n    render() {\n        let { tab } = this.state;\n        return (\n            <>\n                <div className={`container trips mobile-padding`}>\n                    <h2>Trips</h2>\n                    <ul className={`tabs`}>\n                        <li>\n                            <button\n                                className={tab === 'public' ? 'active' : 'inactive'}\n                                onClick={() => this.switchTabs('public')}>Public Trips\n                            </button>\n                        </li>\n                        <li>\n                            <button\n                                className={tab === 'private' ? 'active' : 'inactive'}\n                                onClick={() => this.switchTabs('private')}>\n                                My Trips\n                            </button>\n                        </li>\n\n                        <li>\n                            <button\n                                className={tab === 'bookmarks' ? 'active' : 'inactive'}\n                                onClick={() => this.switchTabs('bookmarks')}>\n                                Bookmarks\n                            </button>\n                        </li>\n\n\n                    </ul>\n                    {this.renderContent()}\n                </div>\n            </>\n        )\n    }\n\n}\n\nTrips.propTypes = {\n    userId: PropTypes.string,\n    isAuthenticated: PropTypes.bool,\n    isVerified: PropTypes.bool\n}\n\n\n\nexport default Trips;","import { Route } from \"react-router-dom\";\nimport PropTypes from 'prop-types';\nimport Authenticate from '../../screens/authentication/Authenticate'\nimport VerifyEmail from '../../screens/authentication/VerifyEmail'\n\n\nfunction PrivateRoute({ component: Component, isAuthenticated, logInLocation, isVerified, user, ...rest }) {\n    \n    return (\n        <Route\n\n            {...rest}\n\n            render={props => (\n\n                isAuthenticated ?\n\n                    (\n                        isVerified ?\n\n                            <Component {...props} />\n                            :\n                            <VerifyEmail logInLocation={logInLocation} />\n\n                    )\n\n                    :\n\n                    (<Authenticate logInLocation={logInLocation} />)\n            )} />\n\n    )\n}\n\n\nPrivateRoute.propTypes = {\n    isAuthenticated: PropTypes.bool.isRequired,\n    isVerified: PropTypes.bool.isRequired,\n    logInLocation: PropTypes.string\n}\n\nexport default PrivateRoute;","function Footer() {\n    return (\n        <footer>\n            <div className={`container`}>\n                <p>&copy; PhotoAtlas 2021</p>\n                <p className={`caption`}>\n                    All photographs and their titles/metadata on PhotoAtlas are copyrighted and owned by\n                    their respective owners (the photographers) and not by PhotoAtlas. As such Photo Atlas does\n                    not grant any licenses to any copyrights, patents or any other intellectual property rights. \n                    PhotoAtlas is not affiliated with Flickr.com, but sources its photos through the Flickr API.\n          </p>\n            </div>\n        </footer>\n    )\n}\n\nexport default Footer;","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport SimpleReactLightbox, { SRLWrapper } from \"simple-react-lightbox\";\n\n\nconst PhotoSlider = (props) => {\n  const { imageList } = props;\n  const imagesCount = imageList.length;\n\n  const lightboxOptions = {\n    buttons: {\n      showDownloadButton: false,\n      showAutoplayButton: false\n    }\n  }\n\n  return (\n    <SimpleReactLightbox>\n      <div className={`photo-slider`}>\n\n        <SRLWrapper options={lightboxOptions}>\n\n          {imageList.map((image, id) => {\n\n            const { src, alt, author, creditUrl } = image;\n\n            return (\n              <div key={id} className={`image-with-credit`}>\n                <a href={src}>\n                 <div className={`image-container`}>\n                 <img  src={src} alt={alt ? alt : ''}   />\n                 </div>\n                </a>\n                {author && <span className={`credit`}><a href={creditUrl}>{author}</a></span>}\n              </div>\n            )\n\n          })}\n\n        </SRLWrapper>\n\n      </div>\n\n      <p className={`caption`}>Total images: {imagesCount}</p>\n\n    </SimpleReactLightbox>\n\n  )\n\n}\n\nPhotoSlider.propTypes = {\n  imageList: PropTypes.arrayOf(PropTypes.object).isRequired\n}\n\n\nexport default PhotoSlider;\n","import PropTypes from 'prop-types';\n\nfunction SubjectIndicators(props) {\n\n    let { subjects } = props;\n\n    if (!subjects) {\n        subjects = [];\n    }\n\n\n    return (\n        <>\n            <h3>Photo Subjects</h3>\n            <div className={`data-container`}>\n                <ul className={`subject-indicators`}>\n\n                    {subjects.includes('abandoned') && <li className={`abandoned`}>Abandoned</li>}\n\n                    {subjects.includes('architecture') && <li className={`architecture`}>Architecture</li>}\n\n                    {subjects.includes('astro') && <li className={`astro`}>Astrophotography</li>}\n\n                    {subjects.includes('landscape') && <li className={`landscape`}>Landscape</li>}\n\n                    {subjects.includes('nature') && <li className={`nature`}>Nature</li>}\n\n                    {subjects.includes('street art') && <li className={`street-art`}>Street Art</li>}\n\n                    {subjects.includes('sunrise') && <li className={`sunrise`}>Sunrise</li>}\n\n                    {subjects.includes('sunset') && <li className={`sunset`}>Sunset</li>}\n\n                    {subjects.includes('transport') && <li className={`transport`}>Transport</li>}\n\n                    {subjects.includes('people') && <li className={`people`}>People</li>}\n\n                    {subjects.includes('urban') && <li className={`urban`}>Urban</li>}\n\n                    {subjects.includes('water') && <li className={`water`}>Water Feature</li>}\n\n                </ul>\n            </div>\n        </>\n    )\n\n}\n\nSubjectIndicators.propTypes = {\n    subjects: PropTypes.arrayOf(PropTypes.string)\n}\n\nexport default SubjectIndicators;","async function getFlickrPhotoInfo(photoId, handleResponse =\n    (responseData) => console.log(responseData)) {\n\n    let url = `https://api.flickr.com/services/rest/?api_key=${process.env.REACT_APP_FLICKR_API_KEY}&method=flickr.photos.getInfo&format=json&nojsoncallback=1}&photo_id=${photoId}`\n\n    await fetch(url)\n        .then(response => {\n            if (!response.ok) {\n                throw Error(response.statusText);\n            }\n            return response.json().then(data => {\n                handleResponse(data);\n            });\n        }).catch(error => {\n            console.log(error)\n        }\n        )\n};\n\nexport default getFlickrPhotoInfo;","\n\nfunction createFlickrImageUrl(photoData) {\n\n    let {farm,server,id,secret} = photoData;\n\n    return `https://farm${farm}.staticflickr.com/${server}/${id}_${secret}.jpg`\n}\n\n//reference https://idratherbewriting.com/learnapidoc/docapis_flickr_example.html\n\nexport default createFlickrImageUrl;","\nimport PropTypes from 'prop-types'\n\nconst DirectionsLarge = (props) => {\n    return (\n        <a href={`https://maps.google.com/?q=${props.latitude},${props.longitude}`} className={`action-button directions`}>Directions</a>\n    )\n}\n\nDirectionsLarge.propTypes = {\n    latitude: PropTypes.number,\n    longitude: PropTypes.number\n}\n\nexport {DirectionsLarge};","import PropTypes from 'prop-types'\n\nconst AddToTripsLarge = ({added, ...rest}) => {\n\n    return (\n        <button className={`action-button ${added ? 'added' : 'add'}`} {...rest}>\n            {\n                added ? 'Change Trips' : 'Add to Trip'\n            }\n        </button>\n    )\n}\n\nconst AddToTripsSmall = ({added, ...rest}) => {\n\n    return (\n        <button className={`action-button-small ${added ? 'added' : 'add'}`} {...rest}>\n            {\n                added ? 'Change Trips' : 'Add to Trip'\n            }\n        </button>\n    )\n}\n\nAddToTripsLarge.propTypes = {\n    added: PropTypes.bool\n}\n\nAddToTripsSmall.propTypes = {\n    added: PropTypes.bool\n}\n\nexport {AddToTripsLarge, AddToTripsSmall};","import PropTypes from 'prop-types';\n\nfunction RadioButton(props) {\n\n    let { \n        id,\n        value,\n        labelText,\n        className,\n        name,\n        ...rest } = props;\n \n    let idName = id ? id : value;\n\n    return (\n        \n        <>\n        \n            <label className={`check-container ${className ? className : ''}`} htmlFor={idName}>{labelText ? labelText : 'label'}\n\n                <input\n                    \n                    type=\"radio\"\n\n                    id={idName}\n\n                    name={name}\n\n                    value={value}\n\n                    {...rest}\n\n                />\n\n                <span className={`radiomark`}></span>\n\n            </label>\n    </>\n    )\n}\n\nRadioButton.propTypes = {\n    className: PropTypes.string,\n    value: PropTypes.string.isRequired,\n    labelText: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired\n}\n\n\nexport default RadioButton;","function generateDate() {\n\tlet result;\n\tlet months = [\"JAN\",\"FEB\",\"MAR\",\"APR\",\"MAY\",\"JUN\",\"JUL\",\"AUG\",\"SEP\",\"OCT\",\"NOV\",\"DEC\"]\n\tlet d = new Date();\n\tlet day = d.getDate();\n\tlet month = months[d.getMonth()];\n\tlet year = d.getFullYear();\n\n\tresult = `${day}-${month}-${year}`\n\n\treturn result;\n\n}\n\nfunction generateTimeNumber() {\n\tlet result;\n\tlet d = new Date();\n\tlet hour = d.getHours();\n\tlet minutes = d.getMinutes();\n\tlet seconds = d.getSeconds();\n\tlet milliseconds = d.getMilliseconds();\n\tresult = `${hour}-${minutes}-${seconds}-${milliseconds}`\n\treturn result;\n}\n\n\nexport {generateDate, generateTimeNumber}\n","function generateId(length, prefix, sufix) {\n    let result  = '';\n    let characters  = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    let charactersLength = characters.length;\n    for ( let i = 0; i < length; i++ ) {\n       result += characters.charAt(Math.floor(Math.random() * charactersLength));\n    }\n    if(prefix) {\n        result = `${prefix}-${result}`\n    }\n    if(sufix) {\n        result = `${result}-${sufix}`\n    }\n    \n    return result;\n }\n\n export default generateId;\n","import React from 'react'\n\nimport firebase from '../../utils/firebase/firebaseConfig'\nimport Authenticate from '../../screens/authentication/Authenticate'\nimport Modal from './Modal'\nimport TexInput from '../forms/TextInput'\nimport SubmitButton from '../forms/SubmitButton'\nimport RadioButton from '../forms/RadioButton'\nimport { generateDate, generateTimeNumber } from '../../utils/generateDateAndTime'\nimport generateID from '../../utils/generateId'\nimport getUserTrips from '../../utils/getUserTrips'\n\nclass ManageTripsModal extends React.Component {\n    state = {\n        modalTitle: 'Add or Remove from Trips',\n        modalDescription: '',\n        isAuthenticated: false,\n        userId: '',\n        existingTrips: [],\n        newTripPrivacy: 'public',\n        newTripName: '',\n        newTripTags: '',\n        newUser: false,\n        creatingTrip: false,\n        tripNameLength: 0,\n        tripNameError: '',\n        tripTagsError: '',\n        newTripCreated: false,\n        needNewTrip: false,\n        errorCreatingTrip: '',\n        errorCreatingLocation: '',\n        errorUpdatingUserTrips: '',\n        errorAddingFilters: '',\n        updatingTrips: true\n    }\n\n    _isMounted = false;\n\n    closeModal() {\n        this.setState({\n            newTripCreated: false,\n            newTripPrivacy: 'public',\n            newTripName: '',\n            newTripTags: '',\n            errorCreatingTrip: '',\n            errorCreatingLocation: '',\n            errorUpdatingUserTrips: '',\n            errorAddingFilters: '',\n            needNewTrip: false\n        }, () => this.props.handleClose());\n    }\n\n    changeUserType(newUserValue) {\n        this.setState({ newUser: newUserValue }, () => {\n\n            if (this.state.newUser) {\n                this.setState(\n                    {\n                        modalTitle: 'Sign Up',\n                        modalDescription: 'Create an account to manage your trips.'\n                    }\n                )\n            } else {\n                this.setState(\n                    {\n                        modalTitle: 'Sign In',\n                        modalDescription: 'Sign in to manage your trips.'\n                    }\n                )\n            }\n        })\n    }\n\n    checkExistingTrips(userId) {\n        \n        this.setState({ updatingTrips: true })\n\n        this._isMounted && \n        getUserTrips(userId,  (existingTrips) => this.setState({ existingTrips: existingTrips, updatingTrips: false }), this.props.locationId)\n    }\n\n\n\n    checkAuth() {\n\n        let userId = this.props.userId;\n\n        if(!userId) {\n            let user = firebase.auth().currentUser;\n            if(user) {\n                userId = user.uid;\n            } \n        }\n\n\n        if (this._isMounted) {\n\n\n            if (userId) {\n\n           \n                //get user trips\n                this._isMounted && this.checkExistingTrips(userId);\n\n                this.setState({ isAuthenticated: true, userId: userId })\n\n                if (this.state.existingTrips.length < 1) {\n                    this.setState(\n                        {\n                            modalTitle: 'Save to a New Trip',\n                            modalDescription: '',\n                            updatingTrips: false\n                        }\n                    )\n                }\n\n            } else {\n                this.setState(\n                    {\n                        modalTitle: 'Sign In',\n                        modalDescription: 'Sign in to manage your trips.'\n                    }\n                )\n            }\n        }\n\n\n\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n\n        this.checkAuth();\n        //set a listner or trips https://firebase.google.com/docs/database/web/read-and-write#web_value_events\n    }\n\n\n    componentDidUpdate(prevProps) {\n        this._isMounted = true;\n        // Typical usage (don't forget to compare props):\n        if (this.props.locationId !== prevProps.locationId) {\n            this.checkAuth();\n        }\n    }\n\n    renderModalContent() {\n        //modal will ask user to sign in or create account if user is not authenticated\n        //user will NOT be required to have a verified email when saving a location\n\n        //authenticate\n        if (!this.state.isAuthenticated) {\n            return (\n                <div className=\"modal-content-padding\">\n                    <Authenticate\n                        hideTitle\n                        changeUserOnParent={(newUserValue) => this.changeUserType(newUserValue)}\n                        afterSignIn={(user) => this.checkAuth(user)}\n                        afterCreateAccount={(user) => this.checkAuth(user)}\n\n                    />\n                </div>\n            )\n        } else {\n\n            if (this.state.updatingTrips) {\n                return (\n                    <div className=\"modal-content-padding center-text\">\n                        <p>Updating trips...</p>\n                    </div>)\n\n            } else {\n                if (this.state.existingTrips.length > 0 && !this.state.needNewTrip && !this.state.newTripCreated) {\n                    return this.selectExistingTrip();\n                }\n                else {\n                    if (!this.state.newTripCreated && !this.state.updatingTrips) {\n                        return this.getNewTripInfo();\n                    } else {\n\n                        return this.newTripCreated()\n\n\n                    }\n                }\n            }\n        }\n\n    }\n\n    selectExistingTrip() {\n        //show list of trips\n        //a button that triggets getNewTripInfo\n        return (\n            <>\n\n                {this.renderExistingTrips()}\n                <div className=\"modal-content-padding center-text\">\n                    <button onClick={() => this.switchForm()} className=\"button-link\"> + Create a New Trip</button>\n                </div>\n\n            </>\n        )\n\n    }\n\n    switchForm() {\n        this.setState({ needNewTrip: !this.state.needNewTrip })\n    }\n\n    renderExistingTrips() {\n        let { existingTrips } = this.state;\n\n\n\n        return (<ul className=\"existing-trips\">\n            {existingTrips.map((trip, index) => {\n                let {\n                    thumbnail,\n                    title,\n                    locationsCount,\n                    privacy,\n                    tripId,\n                    inTrip } = trip;\n\n                return (\n                    <li key={index} className=\"trip-card-small\">\n                        <div className={`trip-card-image`}>\n                            <img src={thumbnail} alt=\"\" />\n                        </div>\n                        <div className={`trip-card-content`}>\n                            <p className={`title`}>{title}</p>\n                            <p className={`meta-data ${privacy}`}>\n                                {privacy}</p>\n                            <p className={`meta-data marker`}>\n                                {locationsCount} {(locationsCount > 1 || locationsCount < 1) ? 'Locations' : 'Location'}</p>\n                            <button className=\"add-or-remove\" onClick={() => { this.addOrRemoveFromTrip(tripId, privacy) }}>\n                                {inTrip ? '- Remove' : '+ Add'}\n                                <span>{inTrip ? `from ${title}` : `to ${title}`}</span>\n                            </button>\n                        </div>\n                    </li>\n                )\n            })}\n        </ul>)\n\n    }\n\n    handleTripNamelInput(e) {\n        e.preventDefault();\n        let value = e.target.value;\n        let valueLength = value.length;\n\n        this.setState({\n            newTripName: e.target.value,\n            tripNameLength: valueLength,\n            tripNameError: \"\"\n        })\n        if (valueLength > 50) {\n            this.setState({\n                tripNameError: \"Your trip name is too long.\"\n            })\n        }\n    }\n\n    handleTripTagsInput(e) {\n        e.preventDefault();\n\n        this.setState({\n            newTripTags: e.target.value,\n            tripTagsError: \"\"\n        }, () => {\n            //check if tags have special characters other than comma\n            let testString = /^[a-zA-Z ,0-9]+$/;\n\n            if (this.state.newTripTags && !testString.test(this.state.newTripTags)) {\n                this.setState({\n                    tripTagsError: \"Tags may only contain letters, numbers, and commas\"\n                })\n            }\n        });\n\n\n    }\n\n    renderDatabaseErrors() {\n        if (\n            this.state.errorCreatingLocation ||\n            this.state.errorUpdatingUserTrips ||\n            this.state.errorCreatingTrip ||\n            this.state.errorAddingFilters\n        ) {\n            return (\n                <div className=\"error-font\" aria-live=\"polite\">\n                    <ul>\n                        {this.state.errorCreatingTrip && <li>{this.state.errorCreatingTrip}</li>}\n                        {this.state.errorUpdatingUserTrips && <li >{this.state.errorUpdatingUserTrips}</li>}\n                        {this.state.errorCreatingLocation && <li>{this.state.errorCreatingLocation}</li>}\n                        {this.state.errorAddingFilters && <li>{this.state.errorAddingFilters}</li>}\n                    </ul>\n                </div>\n            )\n        }\n\n\n    }\n\n    getNewTripInfo() {\n        return (\n            <>\n                <h3 className=\"h5-font center-text\">Create a New Trip</h3>\n                {this.renderDatabaseErrors()}\n\n                <form className=\"modal-content-padding\">\n                    <div className=\"form-component-wrapper\">\n                        <label htmlFor=\"trip-name\">Title (Max 50 Characters)</label>\n                        <TexInput placeholder=\"Beautiful City\" id=\"trip-name\" value={this.state.newTripName} onChange={(e) => this.handleTripNamelInput(e)} required />\n                        {this.state.tripNameLength !== 0 && <p className=\"character-count\" aria-live=\"polite\">Characters left: {50 - this.state.tripNameLength}</p>}\n                        {this.state.tripNameError && <p className=\"error-font\" aria-live=\"polite\">{this.state.tripNameError}</p>}\n                    </div>\n\n                    <div className=\"form-component-wrapper\">\n                        <label htmlFor=\"trip-tags\">Tags (Comma separated)</label>\n                        <TexInput placeholder=\"city, urban architecture\" id=\"trip-tags\" value={this.state.newTripTags} onChange={(e) => this.handleTripTagsInput(e)} />\n                        {this.state.tripTagsError && <p className=\"error-font\" aria-live=\"polite\">{this.state.tripTagsError}</p>}\n                    </div>\n\n                    <fieldset className=\"form-component-wrapper\">\n                        <legend>Visibility Settings</legend>\n                        <RadioButton onChange={(e) => this.handleNewTripPrivacy(e)} labelText=\"Public\" defaultChecked name=\"trip-privacy\" value=\"public\" />\n                        <label className=\"caption-font\" htmlFor=\"public\">Anyone can see</label>\n                        <RadioButton onChange={(e) => this.handleNewTripPrivacy(e)} labelText=\"Private\" name=\"trip-privacy\" value=\"private\" />\n                        <label className=\"caption-font\" htmlFor=\"private\">Only you can see</label>\n                        <RadioButton onChange={(e) => this.handleNewTripPrivacy(e)} labelText=\"Shareable\" name=\"trip-privacy\" value=\"shareable\" />\n                        <label className=\"caption-font\" htmlFor=\"shareable\">Anyone with a link can see</label>\n                    </fieldset>\n\n                    <div className=\"form-component-wrapper\">\n                        <SubmitButton onClick={(e) => this.createNewTrip(e)} value={`${this.state.creatingTrip ? 'Creating Trip...' : 'Create Trip'}`} />\n                    </div>\n\n\n                </form>\n\n                {this.state.existingTrips.length > 0 &&\n                    <div className=\"modal-content-padding\">\n                        <button onClick={() => this.switchForm()} className=\"secondary-button back-button\">Back to Existing Trips</button>\n                    </div>\n                }\n            </>\n        )\n\n    }\n\n    newTripCreated() {\n        return (\n            <div className=\"modal-content-padding center-text\">\n                <h3 className=\"h5-font center-text\">\n                    This location was added to your new trip.\n                </h3>\n            </div>\n        )\n\n    }\n\n    createNewFlickrSourcedLocation(locationRef) {\n        let database = firebase.database();\n        let locationId = this.props.locationId;\n        let locationPhotosArray = this.props.photos;\n        let locationName = locationPhotosArray[0].title;\n        let locationCoordinates = this.props.coordinates;\n        let locationSubjectsArray = this.props.subjects;\n        let date = generateDate();\n\n        // arrays are handled like objects on Firebase Realtime Database\n        //https://firebase.googleblog.com/2014/04/best-practices-arrays-in-firebase.html\n        //convert props arrays into objects for better database handling\n        let locationSubjects = {};\n        let locationPhotos = {};\n\n        locationPhotosArray.forEach(photo => {\n            let flickrId = photo.flickrId;\n            let photoId;\n            if (flickrId) {\n                photoId = `flickrPhoto-${flickrId}`\n            }\n\n            locationPhotos[photoId] = {\n                title: photo.title,\n                author: photo.author,\n                src: photo.src,\n                creditUrl: photo.creditUrl ? photo.creditUrl : null\n            }\n        }\n        )\n\n\n        locationSubjectsArray.forEach(subject => {\n\n            locationSubjects[subject] = true\n\n        });\n\n        database.ref(`${locationRef}`).set({\n            locationName: locationName,\n            photos: locationPhotos,\n            coordinates: locationCoordinates,\n            savedCount: 1,\n            subjects: locationSubjects,\n            addedDate: date,\n            curated: false, //indicates that app has not been curated by a PhotoAtlas user\n            userLastEditedDate: null,\n            woeId: this.props.woeId\n        }).then(() => {\n\n            // add subjects record\n            locationSubjectsArray.forEach(\n\n                subject => {\n\n                    let subjectRef = subject;\n\n                    let update = {};\n\n                    update[locationId] = true;\n\n                    database.ref(`subjects/${subjectRef}`).update(\n                        update\n                    ).catch(\n                        (error) => {\n                            this.setState({ errorAddingFilter: `Could not add all filters to database: ${error.message}` })\n                        });\n\n                })\n\n        }).catch(\n            (error) => {\n                this.setState({ errorCreatingLocation: `Could not add location to database: ${error.message}` })\n            }\n        )\n\n    }\n\n    createNewTrip(e) {\n        e.preventDefault();\n\n        this.setState(\n            {\n                errorCreatingTrip: '',\n                errorCreatingLocation: '',\n                errorUpdatingUserTrips: '',\n                errorAddingFilters: ''\n            }\n        )\n\n        if (!this.state.newTripName) {\n            this.setState({ tripNameError: 'Please name your trip.' })\n        }\n\n        if (!this.state.tripNameError && this.state.newTripName && !this.state.tripTagsError) {\n            this.setState({ creatingTrip: true })\n\n            let locationId = this.props.locationId;\n            let locationPhotosArray = this.props.photos;\n\n            let tripPrivacy = this.state.newTripPrivacy;\n            let tripName = this.state.newTripName;\n            let tripFeaturedImg = locationPhotosArray[0];\n            let tripFeaturedImgSrc = tripFeaturedImg.src;\n            let tripAuthor = this.state.userId;\n            let tripTags = this.state.newTripTags;\n            if (tripTags.endsWith(\",\") || tripTags.endsWith(\" ,\")) {\n                tripTags = tripTags.slice(0, -1)\n            }\n            let date = generateDate();\n            let time = generateTimeNumber();\n            let tripId = generateID(7, `trip-${date}`, `${time}`)\n\n            let locations = {}\n            locations[locationId] = true;\n\n            let database = firebase.database();\n\n            // create new trip\n            database.ref(`${tripPrivacy}Trips/` + tripId).set({\n                tripName: tripName,\n                featuredImg: tripFeaturedImgSrc,\n                author: tripAuthor,\n                locationsCount: 1,\n                locations: locations,\n                tags: tripTags,\n                createdOn: date,\n                lastEdited: date\n            }).catch((error) => {\n                this.setState({ errorCreatingTrip: `Could not create trip: ${error.message}` })\n            }).then(() => {\n                //add trip to user trips\n                database.ref(`userTrips/${tripAuthor}/${tripId}`).set({\n                    tripPrivacy: tripPrivacy\n                }).catch((error) => {\n                    this.setState({ errorUpdatingUserTrips: `Could to your list of trips: ${error.message}` })\n                });\n            }).then(() => {\n                if (locationId.startsWith(\"flickr-\")) { // check if primary source is from flickr or user created\n\n                    let locationRef = `appLocations/flickrSourced/${locationId}`;\n\n                    //check if location exists in lists of locations if not, then add location\n                    //use transactions to make sure that count stays accurate\n                    //https://firebase.google.com/docs/database/web/read-and-write#save_data_as_transactions\n\n                    database.ref(`${locationRef}`).get().then((snapshot) => {\n                        //if location exists\n                        if (snapshot.exists()) {\n                            //get how many people have saved it, and who has saved it\n                            let savedCount = snapshot.val().savedCount;\n\n                            //add to the saved count \n                            //and add the author\n                            if (savedCount) {\n                                database.ref(`${locationRef}`).transaction(\n                                    (location) => {\n                                        if (location) {\n                                            location.savedCount++;\n                                        }\n                                        return location;\n                                    }\n                                )\n                            }\n\n                        }\n                        else {\n                            //create the location\n                            this.createNewFlickrSourcedLocation(locationRef);\n                        }\n                    })\n                }\n\n            }).then(() => {\n\n                if (!this.state.errorCreatingTrip && !this.state.errorCreatingLocation && !this.state.errorUpdatingUserTrips && !this.state.errorAddingFilters) {\n                    this.setState({\n                        creatingTrip: false,\n                        newTripCreated: true,\n                        modalTitle: 'You have a New Trip',\n                        modalDescription: ''\n                    })\n                } else {\n                    this.setState({\n                        creatingTrip: false\n                    })\n                }\n            }).then(\n                () => this.checkExistingTrips(this.state.userId)\n            )\n\n        }\n\n    }\n\n    addOrRemoveFromTrip(tripId, privacy) {\n\n        this.setState({ updatingTrips: true })\n\n        let database = firebase.database();\n        let currentLocation = this.props.locationId;\n        let user = this.state.userId;\n        let date = generateDate();\n\n        let tripRef = `${privacy}Trips/${tripId}/`\n        //need to change\n        //last edited\n        //locationsCount\n        //locations\n\n        let locationRef = `appLocations/flickrSourced/${currentLocation}`\n        //need to change savedCount\n\n\n        database.ref(`${tripRef}/locations/${currentLocation}`).get().then(\n            snapshot => {\n\n                if (snapshot.exists()) {\n                    //remove\n\n                    database.ref(`${tripRef}`).transaction(\n                        trip => {\n                            if (trip) {\n                                //decrease locationsCount\n                                if (trip.locationsCount > 0) {\n                                    trip.locationsCount--;\n                                }\n                                //change the last edited\n                                trip.lastEdited = date;\n\n                            }\n                            return trip\n                        }).catch((error) => console.log(error)).then(() => {\n                            //remove location from trip\n                            database.ref(`${tripRef}/locations/${currentLocation}`).transaction(\n                                location => {\n                                    if (location) {\n                                        location = null\n                                    }\n                                    return location\n                                }\n                            )\n                        }).then(() => this.checkExistingTrips(user))\n\n                    database.ref(`${locationRef}`).transaction(\n                        location => {\n                            if (location) {\n                                //decrease savedCount\n\n                                location.savedCount--\n\n\n                            }\n                            return location\n                        }).catch((error) => console.log(error))\n\n\n                }\n                else {\n                    //add\n                    if (currentLocation.startsWith(\"flickr-\")) {\n                        let locationRef = `appLocations/flickrSourced/${currentLocation}`\n\n                        database.ref(`${locationRef}`).get().then(\n                            (snapshot) => {\n                                if (!snapshot.exists()) {\n                                    this.createNewFlickrSourcedLocation(locationRef)\n                                }\n                            }\n                        )\n                    }\n\n                    database.ref(`${tripRef}`).transaction(\n                        trip => {\n                            if (trip) {\n                                //increase locationsCount\n                                trip.locationsCount++;\n                                //change the last edited\n                                trip.lastEdited = date;\n                            }\n                            return trip\n                        }).catch((error) => console.log(error)).then(() => {\n                            //add location to trip\n                            //check if trip has locations\n                            database.ref(`${tripRef}/locations`).get().then((snapshot) => {\n                                if (snapshot.exists()) {\n                                    let update = {}\n                                    update[currentLocation] = true\n\n                                    database.ref(`${tripRef}/locations`).update(\n                                        update\n                                    ).catch((error) => console.log(error))\n                                } else {\n                                    let update = { locations: {} }\n                                    update.locations[currentLocation] = true\n\n                                    database.ref(`${tripRef}`).update(\n                                        update\n                                    ).catch((error) => console.log(error))\n                                }\n\n                            }).then(() => this.checkExistingTrips(user))\n\n                        })\n\n\n                    database.ref(`${locationRef}`).transaction(\n                        location => {\n                            if (location) {\n                                //increase savedCount\n                                location.savedCount++\n                            }\n                            return location\n                        }).catch((error) => console.log(error))\n\n                }\n            }).then(() => this.setState({ updatingTrips: false }))\n    }\n\n    handleNewTripPrivacy(e) {\n        this.setState({ newTripPrivacy: e.target.value })\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n    render() {\n        let {\n            modalTitle,\n            modalDescription\n        } = this.state;\n\n        return (\n            <Modal\n                modalId='manage-trips-modal'\n                modalTitle={modalTitle}\n                modalDescription={modalDescription}\n                isOpen={this.props.isOpen}\n                handleClose={() => this.closeModal()}\n            >\n                {this.renderModalContent()}\n            </Modal>\n        )\n    }\n}\n\nexport default ManageTripsModal;","import firebase from './firebase/firebaseConfig'\n\nlet getSavesCount = (locationId, callback) => {\n    let database = firebase.database();\n\n    database.ref(`appLocations/flickrSourced/${locationId}`).get().then(\n        (snapshot) => {\n            let count = 0;\n            if (snapshot.exists()) {\n                let location = snapshot.val();\n                count = location['savedCount'];\n            }\n            return count\n        }).catch((error)=> console.log(error)).then((count) => {\n            callback(count)\n        }\n        )\n\n}\n\nexport default getSavesCount;","import React from 'react'\nimport PropTypes from 'prop-types';\n\nimport PhotoSlider from '../../components/slider/PhotoSlider'\nimport SubjectIndicators from '../../components/content/SubjectIndicators'\nimport getFlickrPhotoInfo from '../../utils/flickr/getFlickrPhotoInfo'\nimport createFlickrImageUrl from '../../utils/flickr/createFlickrImageUrl'\nimport getFlickrPlace from '../../utils/flickr/getFlickrPlace'\nimport getFlickrPhotos from '../../utils/flickr/getFlickrPhotos'\nimport filterTags from '../../utils/filterTags'\nimport { DirectionsLarge } from '../../components/buttons/DirectionsButtons'\nimport { AddToTripsLarge, AddToTripsSmall } from '../../components/buttons/AddToTripsButtons'\nimport ManageTripsModal from '../../components/modals/ManageTripsModal'\nimport firebase from '../../utils/firebase/firebaseConfig'\nimport getSavesCount from '../../utils/getSavesCount'\n\nclass Location extends React.Component {\n    state = {\n        locationId: '',\n        title: \"\",\n        distance: 'loading...',\n        saves: 0,\n        destination: {\n            latitude: 0,\n            longitude: 0,\n        },\n        imageList: [],\n        subjects: [],\n        firstPhoto: {},\n        showTripsModal: false,\n        inTrips: false,\n        userId: null,\n        woeId: null\n    };\n\n    _isMounted = false;\n\n\n    manageTripsModal() {\n        this.setState({ showTripsModal: !this.state.showTripsModal })\n        let userId = this.props.userId;\n        this.checkIfInTrips(userId)\n\n        getSavesCount(\n            this.state.locationId,\n            (count) => {\n\n                this.setState({ saves: count })\n            }\n        );\n\n    }\n\n    checkIfInTrips(userId) {\n\n        if (userId && this.props.isAuthenticated) {\n            let database = firebase.database()\n\n\n            this._isMounted && database.ref(`userTrips/${userId}`).get().catch(error=> console.log(error)).then((snapshot) => {\n                let locationTrips = [];\n                if (snapshot.exists()) {\n                    let trips = snapshot.val();\n\n\n                    for (const tripId in trips) {\n\n                        let privacy = trips[tripId]['tripPrivacy']\n\n                        let location = this.state.locationId\n\n                        let locationRef = `${privacy}Trips/${tripId}/locations/${location}`\n\n                        this._isMounted && database.ref(`${locationRef}`).get().catch(error => console.log(error)).then(\n                            snapshot => {\n\n                                if (snapshot.exists()) {\n                                    locationTrips.push(tripId)\n                                }\n\n                                if (locationTrips.length > 0) {\n\n                                    this.setState({ inTrips: true })\n                                    \n                                } else {\n                                    this.setState({ inTrips: false })\n                                }\n\n                            }).catch(error => console.log(error))\n\n\n                    }\n\n                }\n                return locationTrips\n            })\n        }\n\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.userId !== this.props.userId) {\n            let userId = this.props.userId;\n\n            this.checkIfInTrips(userId)\n\n        }\n    }\n\n\n\n    componentDidMount() {\n        this._isMounted = true;\n        let userId = this.props.userId;\n        this.checkIfInTrips(userId)\n\n        //get the location id from the path\n        let path = this.props.location.pathname;\n        let locationId = path.replace(\"/location/\", \"\");\n        this.setState({ locationId: locationId });\n\n\n\n        getSavesCount(\n            locationId,\n            (count) => {\n\n                this.setState({ saves: count })\n            }\n        );\n\n\n\n        //get the woeId from the search query\n        let pathQuery = this.props.location.search;\n        let searchParams = new URLSearchParams(pathQuery);\n        let woeId = searchParams.get(\"woe\");\n        this.setState({woeId: woeId})\n\n\n        //if the path starts with flickr\n        if (locationId.startsWith(\"flickr-\")) {\n\n\n            //get the photo id\n            let photoId = locationId.replace(\"flickr-\", \"\");\n\n\n            //get the photo information\n            this._isMounted && getFlickrPhotoInfo(\n\n                photoId,\n\n                (data) => {\n\n                    let photoData = data.photo;\n                    let src, title, alt, lat, lon, author, creditUrl, tags;\n\n                    if (photoData) {\n                        src = createFlickrImageUrl(photoData);\n                        title = photoData.title._content;\n                        alt = photoData.description._content;\n                        lat = photoData.location.latitude;\n                        lon = photoData.location.longitude;\n                        author = photoData.owner.realname;\n                        if (!author) {\n                            author = photoData.owner.username\n                        }\n                        creditUrl = photoData.urls.url[0]._content;\n                        tags = photoData.tags\n                    }\n\n                    let firstPhoto = {\n                        src: src,\n                        title: title,\n                        alt: alt,\n                        lon: lon,\n                        lat: lat,\n                        author: author,\n                        creditUrl: creditUrl,\n                        tags: tags\n                    }\n\n                    this.setState({ firstPhoto: firstPhoto }, () => {\n\n                        this.getLocationDetailsFromFlickr(photoId, woeId);\n\n                    })\n                }\n            )\n\n        }\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n\n    getLocationDetailsFromFlickr(photoId, woeId) {\n\n        //get the photo data\n        let photo = this.state.firstPhoto;\n        let src = photo.src;\n        let title = photo.title;\n        let alt = photo.alt;\n        let lat = photo.lat;\n        let lon = photo.lon;\n        let author = photo.author;\n        let creditUrl = photo.creditUrl;\n\n\n\n        //get each tag\n        let tagsList = photo.tags;\n\n        if (!tagsList) {\n            tagsList = [];\n        } else {\n            tagsList = tagsList.tag\n        }\n\n        // generate a string from tags\n        let tagsString = '';\n        tagsList.forEach(\n            (tag, index) => {\n                tag = tag._content;\n                if (tag) {\n                    if (index === 0) {\n                        tagsString = tagsString.concat(tag)\n                    } else {\n                        tagsString = tagsString.concat(`, ${tag}`)\n                    }\n                }\n            }\n        )\n\n        //check if filter tags are within the tagsString, if so add subjects list\n        if (tagsString) {\n\n            let subjects = []\n\n            //make the filterTags string into an array\n            //for each item in the array check if it's in tags string\n            //once one tag is found subject\n            //use a \"for\" loop instead of \"forEach\" so that it breaks on first match\n\n            let setSubject = (tagsArray, subject) => {\n                for (let i = 0; i < tagsArray.length; i++) {\n                    let tag = tagsArray[i];\n                    if (tagsString.includes(tag)) {\n                        subjects.push(subject)\n                        break;\n                    }\n                }\n            }\n\n            //'abandoned'\n            let abandonedString = filterTags.abandonedTags;\n            let abandonedArray = abandonedString.split(', ');\n            setSubject(abandonedArray, 'abandoned');\n\n            //'architecture'\n            let architectureString = filterTags.architectureTags;\n            let architectureArray = architectureString.split(', ');\n            setSubject(architectureArray, 'architecture');\n\n            //'astro'\n            let astroString = filterTags.astroTags;\n            let astroArray = astroString.split(', ');\n            setSubject(astroArray, 'astro');\n\n            //'landscape'\n            let landscapeString = filterTags.landscapeTags;\n            let landscapeArray = landscapeString.split(', ');\n            setSubject(landscapeArray, 'landscape');\n\n            //'nature'\n            let natureString = filterTags.natureTags;\n            let natureArray = natureString.split(', ');\n            setSubject(natureArray, 'nature');\n\n            //'street art'\n            let streetArtString = filterTags.streetArtTags;\n            let streetArtArray = streetArtString.split(', ');\n            setSubject(streetArtArray, 'street art');\n\n            //'sunrise'\n            let sunriseString = filterTags.sunriseTags;\n            let sunriseArray = sunriseString.split(', ');\n            setSubject(sunriseArray, 'sunrise');\n\n            //'sunset'\n            let sunsetString = filterTags.sunsetTags;\n            let sunsetArray = sunsetString.split(', ');\n            setSubject(sunsetArray, 'sunset');\n\n            //'transport'\n            let transportString = filterTags.transportTags;\n            let transportArray = transportString.split(', ');\n            setSubject(transportArray, 'transport');\n\n            //'people'\n            let peopleString = filterTags.peopleTags;\n            let peopleArray = peopleString.split(', ');\n            setSubject(peopleArray, 'people');\n\n            //'urban'\n            let urbanString = filterTags.urbanTags;\n            let urbanArray = urbanString.split(', ');\n            setSubject(urbanArray, 'urban');\n\n            //'water'\n            let waterString = filterTags.waterTags;\n            let waterArray = waterString.split(', ');\n            setSubject(waterArray, 'water');\n\n            //if the location contains any subjects, update the state\n            if (subjects.length > 0) {\n                this.setState({ subjects: subjects })\n            }\n        }\n\n        //create a location object and add it to imageList\n\n        createFlickrImageUrl(photo)\n\n        let location = {\n            \"title\": title,\n            \"src\": src,\n            \"alt\": alt,\n            \"author\": author,\n            \"creditUrl\": creditUrl,\n            \"flickrId\": photoId\n        }\n\n        let place = async (options) => {\n            let placeName = await getFlickrPlace(options);\n            return placeName\n        }\n\n        place({ \"woeId\": woeId }).then(placeName => {\n\n            if (placeName) {\n                location.title = placeName\n            }\n\n        }).then(\n\n            this.setState(\n                {\n                    title: title,\n                    destination: {\n                        latitude: parseFloat(lat),\n                        longitude: parseFloat(lon)\n                    },\n\n                    imageList: [location] //will need to makesure this stays as first photo when others are added\n                }\n            )\n\n        ).then(\n            () => {\n\n\n                //use woeid to get other images\n                let options = {\n                    \"lat\": lat,\n                    \"lon\": lon,\n                    \"extras\": \"geo, description, owner_name, tags\",\n                    \"accuracy\": 16\n                }\n\n                getFlickrPhotos(options).then(\n                    data => {\n\n                        if (data) {\n\n                            let photos = data.photos\n\n                            if (photos) {\n                                photos = photos.photo\n                                let imageList = this.state.imageList;\n\n                                photos.forEach(\n                                    photo => {\n                                        //only select photos with the same woeid (same location)\n                                        //prevent duplicate locations and locations with no tags\n                                        if (photo.woeid === woeId && photo.id !== photoId && photo.tags) {\n\n                                            let newTitle = photo.title;\n                                            let newSrc = createFlickrImageUrl(photo);\n                                            let newAlt = photo.description._content;\n                                            let newAuthor = photo.ownername;\n                                            let ownerId = photo.owner;\n                                            let newCreditUrl = `https://www.flickr.com/photos/${ownerId}/${photo.id}`;\n                                            let newphotoId = photo.id;\n\n\n                                            let newLocation = {\n                                                \"title\": newTitle,\n                                                \"src\": newSrc,\n                                                \"alt\": newAlt,\n                                                \"author\": newAuthor,\n                                                \"creditUrl\": newCreditUrl,\n                                                \"flickrId\": newphotoId\n                                            }\n\n                                            imageList.push(newLocation);\n\n                                            this.setState({ imageList: imageList })\n\n                                        }\n\n                                    }\n                                )\n                            }\n                        }\n\n\n                    }\n                )\n            }\n\n        )\n\n    }\n\n\n    render() {\n\n        let { title,\n            saves,\n            destination,\n            imageList,\n            subjects,\n            inTrips } = this.state;\n\n        if (!title) {\n            title = \"Untitled Location\"\n        }\n\n        if (!saves) {\n            saves = 0;\n        }\n\n        return (\n            <>\n                <div className=\"location\">\n                    <div className='dark-background mobile-header'>\n                        <div className={`container mobile-padding`}>\n                            <button onClick={() => { window.history.back() }} className={`secondary-button back-button`}>Back</button>\n                            <AddToTripsSmall added={inTrips} onClick={() => { this.manageTripsModal() }} />\n                        </div>\n\n                    </div>\n                    <div className={`container mobile-padding`}>\n\n                        {imageList && <PhotoSlider imageList={imageList} />}\n\n                        <h2 className={`title`}>{title}</h2>\n                        <div className={`gird-70-30`}>\n                            <div className={`col-70`}>\n                                <p className={`meta-data saved`}>Saved in: {saves} {(saves > 1 || saves < 1) ? 'trips' : 'trip'}</p>\n                                <p className={`meta-data marker`}>Coordinates: {destination.latitude}, {destination.longitude}</p>\n                            </div>\n                            <div className={`col-30`}>\n                                <ul className=\"actions\">\n                                    <li>\n                                        <DirectionsLarge latitude={destination.latitude} longitude={destination.longitude} />\n                                    </li>\n                                    <li>\n                                        <AddToTripsLarge data-micromodal-trigger=\"modal-1\" onClick={() => { this.manageTripsModal() }} added={inTrips} />\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n\n                        {subjects.length > 0 && <SubjectIndicators subjects={subjects} />}\n\n                    </div>\n\n\n                </div>\n                <ManageTripsModal\n                    isOpen={this.state.showTripsModal}\n                    handleClose={() => this.manageTripsModal()}\n                    locationId={this.state.locationId}\n                    photos={this.state.imageList}\n                    coordinates={this.state.destination}\n                    subjects={this.state.subjects}\n                    userId={this.state.userId}\n                    woeId={this.state.woeId}\n\n                />\n            </>\n\n        )\n\n    }\n}\n\n\nLocation.propTypes = {\n    userId: PropTypes.string\n}\n\n\nexport default Location;","\nconst EditTripLarge = ({added, ...rest}) => {\n\n    return (\n        <button className={`action-button edit`} {...rest}>\n            Edit Trip\n        </button>\n    )\n}\n\nconst EditTripSmall = ({added, ...rest}) => {\n\n    return (\n        <button className={`action-button-small edit`} {...rest}>\n            Edit Trip\n        </button>\n    )\n}\n\n\nexport {EditTripLarge,  EditTripSmall};","import PropTypes from 'prop-types'\n\nconst BookmarkTripLarge = ({bookmarked, updating, ...rest}) => {\n\n    return (\n        <button className={`action-button ${bookmarked ? 'bookmarked' : 'bookmark'}`} {...rest}>\n            {\n               updating ? 'Updating'  : (bookmarked ? 'Unbookmark' : 'Bookmark')\n            }\n        </button>\n    )\n}\n\nconst BookmarkTripSmall = ({bookmarked, updating, ...rest}) => {\n\n    return (\n        <button className={`action-button-small ${bookmarked ? 'bookmarked' : 'bookmark'}`} {...rest}>\n            {\n                updating ? 'Updating'  : (bookmarked ? 'Unbookmark' : 'Bookmark')\n            }\n        </button>\n    )\n}\n\nBookmarkTripLarge.propTypes = {\n    bookmarked: PropTypes.bool\n}\n\nBookmarkTripSmall.propTypes = {\n    bookmarked: PropTypes.bool,\n    updating:  PropTypes.bool\n}\n\nexport {BookmarkTripLarge , BookmarkTripSmall};","import React from 'react'\nimport Modal from './Modal'\nimport TexInput from '../forms/TextInput'\nimport SubmitButton from '../forms/SubmitButton'\nimport RadioButton from '../forms/RadioButton'\nimport firebase from '../../utils/firebase/firebaseConfig'\nimport { generateDate } from '../../utils/generateDateAndTime'\n\nclass EditTripModal extends React.Component {\n\n    state = {\n        errorUpdatingTrip: '',\n        errorUpdatingUserTrips: '',\n        tripNameError: '',\n        tripNameLength: 0,\n        tripName: '',\n        nameUpdated: false,\n        tripTags: '',\n        tagsUpdated: false,\n        tripTagsError: '',\n        tripPrivacy: this.props.originalTripPrivacy,\n        updatingTrip: false,\n        tripUpdate: false,\n        confirmDelete: false,\n        tripDeleted: false,\n        tagButtons: ''\n    }\n\n    _isMounted = false;\n\n\n\n\n    updateTrip(e) {\n        //update userTrips\n        //update trip\n        e.preventDefault();\n\n\n        if (!this.state.errorUpdatingTrip &&\n            !this.state.errorUpdatingUserTrips &&\n            !this.state.tripNameError &&\n            !this.state.tripTagsError\n        ) {\n\n            this.setState({ updatingTrip: true })\n            let database = firebase.database()\n            let userId = this.props.userId;\n            let tripId = this.props.tripId;\n            let originalPrivacy = this.props.originalTripPrivacy;\n\n\n            let tripRef = `${originalPrivacy}Trips/${tripId}`\n            let userTripRef = `userTrips/${userId}/${tripId}`\n\n            let newPrivacy = this.state.tripPrivacy\n            let tripUpdate = {}\n\n\n            if (this.state.tripName && (this.state.tripName !== this.props.originalTripName)) {\n                tripUpdate[\"tripName\"] = this.state.tripName\n            }\n\n            //this gets buggy when I update tags plus it's not refreshing the update...\n            if (this.state.tagsUpdated && (this.state.tripTags !== this.props.originalTripTags)) {\n                tripUpdate[\"tags\"] = this.state.tripTags\n            }\n\n            //update trip name and tags\n            if (tripUpdate || newPrivacy) {\n                tripUpdate.lastEdited = generateDate()\n\n\n                //if the new privacy is private, then delete existing bookmarks\n\n                if (newPrivacy === 'private') {\n                    //get the existing bookmarks, and delete them from path\n                    this.deleteBookmarks(\n                        tripRef,\n                        tripId,\n                        () => {\n                            database.ref(`${tripRef}/bookmarks`).remove().catch(error => {\n                                this.setState({ errorUpdatingTrips: `When deleting bookmarks ${error}` })\n                            })\n                        }\n                    )\n                }\n\n\n                database.ref(`${tripRef}`).update(tripUpdate).catch(error => {\n                    this.setState({ errorUpdatingTrip: error })\n                }).then(() => {\n                    if (this.state.tripPrivacy) {\n                        let userTripsUpdate = {\n                            tripPrivacy: newPrivacy\n                        }\n                        //update userTrips\n                        database.ref(`${userTripRef}`).update(userTripsUpdate).catch(error => {\n                            this.setState({ errorUpdatingUserTrips: error })\n                        })\n\n                        //get trip from current spot and store it\n                        let tripData;\n                        database.ref(`${tripRef}`).get().then(\n                            (snapshot) => {\n                                tripData = snapshot.val()\n                            }\n                        ).catch(error => {\n                            this.setState({ errorUpdatingUserTrips: `When getting original privacy setting ${error}` })\n                        }).then(() => {\n                            //delete trip from current spot\n                            database.ref(`${tripRef}`).remove().catch(error => {\n                                this.setState({ errorUpdatingUserTrips: `When deleting original privacy setting ${error}` })\n                            })\n                        }).then(() => {\n                            //add trip under new privacy\n                            let tripRef = `${newPrivacy}Trips/${tripId}`\n                            database.ref(`${tripRef}`).set(\n                                tripData\n                            ).catch(error => {\n                                this.setState({ errorUpdatingUserTrips: `When setting new privacy setting ${error}` })\n                            })\n                        }).then(() =>\n                            //inidicate update finished\n                            this.setState({ updatingTrip: false, tripUpdate: true }))\n                    } else {\n                        //if privacy was not changed, simply indicate update done\n                        this.setState({ updatingTrip: false, tripUpdate: true })\n                    }\n                })\n\n            }\n\n        }\n\n\n    }\n\n    tripDeleted() {\n        return (\n            <div className=\"modal-content-padding center-text\">\n                <h3 className=\"h5-font center-text\">\n                    This trip has been deleted.\n                </h3>\n            </div>\n        )\n\n    }\n\n    tripUpdated() {\n        return (\n            <div className=\"modal-content-padding center-text\">\n                <h3 className=\"h5-font center-text\">\n                    Trip information updated.\n                </h3>\n            </div>\n        )\n\n    }\n\n    renderDatabaseErrors() {\n        if (\n            this.state.errorUpdatingUserTrips ||\n            this.state.errorUpdatingTrip\n        ) {\n            return (\n                <div className=\"error-font\" aria-live=\"polite\">\n                    <ul>\n                        {this.state.errorUpdatingTrip && <li>Issue updating trip: {this.state.errorUpdatingTrip}</li>}\n                        {this.state.errorUpdatingUserTrips && <li> Issue updating user trips: {this.state.errorUpdatingUserTrips}</li>}\n                    </ul>\n                </div>\n            )\n        }\n    }\n\n    deleteBookmarks(tripRef, tripId, callback) {\n        let database = firebase.database();\n\n        //first delete bookmar references, then delete the trip\n        database.ref(`${tripRef}/bookmarks`).get().catch(error => {\n            this.setState({ errorUpdatingTrips: `When deleting trip bookmarks ${error}` })\n        }).then(snapshot => {\n            if (snapshot) {\n                let bookmarks = snapshot.val()\n\n                for (const userId in bookmarks) {\n                    database.ref(`userBookmarks/${userId}/${tripId}`).remove().catch(error => {\n                        this.setState({ errorUpdatingTrips: `When deleting trip ${error}` })\n                    })\n                }\n            }\n        }).then(() => {\n            if (callback) {\n                callback()\n            }\n        })\n\n    }\n\n    deleteTrip() {\n        let database = firebase.database();\n        let userId = this.props.userId;\n        let tripId = this.props.tripId;\n        let originalPrivacy = this.props.originalTripPrivacy;\n        let tripRef = `${originalPrivacy}Trips/${tripId}`\n        let userTripRef = `userTrips/${userId}/${tripId}`\n\n        this.deleteBookmarks(\n            tripRef,\n            tripId,\n            () => {\n                database.ref(`${tripRef}`).remove().catch(error => {\n                    this.setState({ errorUpdatingTrips: `When deleting trip ${error}` })\n                }).then(\n                    () => {\n                        database.ref(`${userTripRef}`).remove().catch(error => {\n                            this.setState({ errorUpdatingUserTrips: `When deleting trip from user trips list: ${error}` })\n                        })\n                    }\n                ).then(\n                    () => {\n                        this.setState({ tripDeleted: true })\n                    }\n                )\n            }\n        )\n    }\n\n    toggleDeleteFrom() {\n        this.setState({ confirmDelete: !this.state.confirmDelete })\n    }\n\n\n    componentDidUpdate(prevProps) {\n        if (this.props.originalTripPrivacy !== prevProps.originalTripPrivacy) {\n            this.setState({ tripPrivacy: this.props.originalTripPrivacy })\n        }\n\n    }\n\n    renderUpdateForm() {\n        let pathQuery = this.props.searchQuery;\n        let searchParams = new URLSearchParams(pathQuery);\n        let searchPrivacy = searchParams.get(\"privacy\")\n        let privacy = this.state.tripPrivacy ? this.state.tripPrivacy : searchPrivacy;\n\n        let defaultPrivate = privacy === 'private'\n        let defaultPublic = privacy === 'public'\n        let defaultShareable = privacy === 'shareable'\n\n        return (\n            <>\n                {this.renderDatabaseErrors()}\n\n                <form className=\"modal-content-padding\">\n                    <div className=\"form-component-wrapper\">\n                        <label htmlFor=\"trip-name\">Title (Max 50 Characters)</label>\n                        <TexInput id=\"trip-name\"\n                            value={this.state.nameUpdated ? this.state.tripName : this.props.originalTripName}\n                            onChange={(e) => this.handleTripNamelInput(e)}\n                            required />\n                        {this.state.tripNameLength !== 0 && <p className=\"character-count\" aria-live=\"polite\">Characters left: {50 - this.state.tripNameLength}</p>}\n                        {this.state.tripNameError && <p className=\"error-font\" aria-live=\"polite\">{this.state.tripNameError}</p>}\n                    </div>\n\n                    <div className=\"form-component-wrapper\">\n                        <label htmlFor=\"trip-tags\">Tags (Comma separated)</label>\n                        <TexInput id=\"trip-tags\"\n                            value={this.state.tagsUpdated ? this.state.tripTags : this.props.originalTripTags}\n                            onChange={(e) => this.handleTripTagsInput(e)} />\n                        {this.state.tripTagsError && <p className=\"error-font\" aria-live=\"polite\">{this.state.tripTagsError}</p>}\n                    </div>\n\n                    <fieldset className=\"form-component-wrapper\">\n                        <legend>Visibility Settings</legend>\n\n                        <RadioButton\n                            defaultChecked={defaultPublic}\n                            onChange={(e) => this.handleTripPrivacy(e)}\n                            labelText=\"Public\"\n                            name=\"trip-privacy\"\n                            value=\"public\" />\n\n                        <label className=\"caption-font\" htmlFor=\"public\">Anyone can see</label>\n\n                        <RadioButton\n                            defaultChecked={defaultPrivate}\n                            onChange={(e) => this.handleTripPrivacy(e)}\n                            labelText=\"Private\"\n                            name=\"trip-privacy\"\n                            value=\"private\" />\n                        <label className=\"caption-font\" htmlFor=\"private\">Only you can see</label>\n\n                        <RadioButton\n                            defaultChecked={defaultShareable}\n                            onChange={(e) => this.handleTripPrivacy(e)}\n                            labelText=\"Shareable\"\n                            name=\"trip-privacy\"\n                            value=\"shareable\" />\n                        <label className=\"caption-font\" htmlFor=\"shareable\">Anyone with a link can see</label>\n\n                    </fieldset>\n\n                    <div className=\"form-component-wrapper\">\n                        <SubmitButton onClick={(e) => this.updateTrip(e)} value={`${this.state.updatingTrip ? 'Updating Trip...' : 'Update Trip'}`} />\n                    </div>\n\n                </form>\n\n                {\n                    <div className=\"modal-content-padding\">\n                        <button onClick={() => this.toggleDeleteFrom()} className=\"secondary-button delete-button\">Delete Trip</button>\n                        {this.state.confirmDelete && <div>\n                            <ul className=\"button-group\">\n                                <li><button onClick={() => this.deleteTrip()} className=\"default-button\">Delete</button></li>\n                                <li><button onClick={() => this.toggleDeleteFrom()} className=\"button-link\">Cancel</button></li>\n                            </ul>\n                        </div>}\n                    </div>\n                }\n            </>\n        )\n\n    }\n\n    handleTripNamelInput(e) {\n        e.preventDefault();\n        let value = e.target.value;\n        let valueLength = value.length;\n\n        this.setState({\n            nameUpdated: true,\n            tripName: e.target.value,\n            tripNameLength: valueLength,\n            tripNameError: \"\"\n        })\n        if (valueLength === 0) {\n            this.setState({\n                tripNameError: \"Your trip must have a name.\"\n            })\n        }\n        if (valueLength > 50) {\n            this.setState({\n                tripNameError: \"Your trip name is too long.\"\n            })\n        }\n    }\n\n    handleTripTagsInput(e) {\n        e.preventDefault();\n\n        this.setState({\n            tagsUpdated: true,\n            tripTags: e.target.value,\n            tripTagsError: \"\"\n        }, () => {\n            //check if tags have special characters other than comma\n            let testString = /^[a-zA-Z ,0-9]+$/;\n\n            if (this.state.tripTags && !testString.test(this.state.tripTags)) {\n                this.setState({\n                    tripTagsError: \"Tags may only contain letters, numbers, and commas\"\n                })\n            }\n        });\n\n    }\n\n    handleTripPrivacy(e) {\n        this.setState({ tripPrivacy: e.target.value })\n    }\n\n\n    renderModalContent() {\n        if (this.state.tripDeleted) {\n            return this.tripDeleted()\n        } else {\n            if (!this.state.tripUpdate ||\n                this.state.errorUpdatingTrip ||\n                this.state.errorUpdatingUserTrips ||\n                this.state.tripNameError ||\n                this.state.tripTagsError) {\n                return this.renderUpdateForm()\n            } else {\n                return this.tripUpdated()\n            }\n        }\n\n    }\n\n    closeModal() {\n\n        //if the trip was updated\n        //reset the state of the modal\n        //and tell the parent of the update\n        //else close the modal and indate that the update did not happen\n\n        let update = {}\n\n        if (!this.state.tripDeleted) {\n\n            if (this.state.tripUpdate) {\n\n                let originalPrivacy = this.props.originalTripPrivacy\n                let newPrivacy = this.state.tripPrivacy\n\n\n                if (newPrivacy && (newPrivacy !== originalPrivacy)) {\n                    update = {\n                        updated: true,\n                        newPrivacy: newPrivacy\n                    }\n                } else {\n                    update = {\n                        updated: true\n                    }\n                }\n\n            } else {\n                update = { updated: false }\n            }\n\n            this.setState({ tripUpdate: false, nameUpdated: false, tagsUpdated: false },\n                () => this.props.handleClose(update))\n\n        } else {\n            update = { updated: true, deleted: true }\n            this.props.handleClose(update)\n        }\n\n    }\n\n\n    render() {\n        return (\n\n            <Modal\n                modalId='edit-trip-modal'\n                modalTitle={'Update Trip'}\n                isOpen={this.props.isOpen}\n                handleClose={() => this.closeModal()}\n            >\n                {this.renderModalContent()}\n            </Modal>\n\n\n        )\n    }\n\n}\n\nexport default EditTripModal;\n","import firebase from './firebase/firebaseConfig';\n\nlet addToBookmarks = (userId, tripId, tripAuthor, tripPrivacy, callback) => {\n    let database = firebase.database();\n    let bookmarkingError = false\n    let update = {};\n    update[userId] = true;\n    //add reference on \n    database.ref(`${tripPrivacy}Trips/${tripId}/bookmarks`).update(\n        update\n    ).catch(\n        (error) => {\n            bookmarkingError = error.message\n        }\n    ).then(() => {\n        //add to user bookmarks\n        database.ref(`userBookmarks/${userId}/${tripId}`).set({\n            tripPrivacy: tripPrivacy,\n            tripAuthor: tripAuthor\n        }).catch((error) => {\n            bookmarkingError = error.message\n        }).then(() => {\n            callback(bookmarkingError)\n        })\n\n    }\n\n    )\n\n\n\n}\n\nexport default addToBookmarks;","import React from 'react'\nimport Authenticate from '../../screens/authentication/Authenticate'\nimport Modal from './Modal'\nimport addToBookmarks from '../../utils/addToBookmarks'\n\nclass BookmarkModal extends React.Component {\n    state = {\n        isAuthenticated: false,\n        modalTitle: 'Sign In',\n        modalDescription: 'Sign in to add bookmark.',\n        newUser: false,\n        error: ''\n    }\n\n    changeUserType(newUserValue) {\n        this.setState({ newUser: newUserValue }, () => {\n\n            if (this.state.newUser) {\n                this.setState(\n                    {\n                        modalTitle: 'Sign Up',\n                        modalDescription: 'Create an account to add bookmark.'\n                    }\n                )\n            }\n        })\n    }\n\n    bookmarkTrip(user) {\n        //do the bookmarking, then\n\n        if (user) {\n            this.setState({ isAuthenticated: true })\n            let userId = user.uid;\n\n            if (userId !== this.props.tripAuthor) {\n                addToBookmarks(\n                    userId,\n                    this.props.tripId,\n                    this.props.tripAuthor,\n                    this.props.tripPrivacy,\n                    (errorMessage) => {\n                        if (!errorMessage) {\n                            this.setState({\n                                modalTitle: 'Bookmark',\n                                modalDescription: ''\n                            })\n\n                        } else {\n                            this.setState({\n                                modalTitle: 'Issue Bookmarking',\n                                modalDescription: '',\n                                error: errorMessage\n                            })\n                        }\n                    }\n                )\n            } else {\n                this.setState({\n                    error: 'Cannot bookmark this trip because you are its author.'\n                })\n            }\n        }\n\n    }\n\n    verifyBookmark() {\n        if (this.state.error) {\n            return (\n                <div aria-live=\"polite\" className=\"modal-content-padding center-text\">\n                    <p className=\"error-font\">\n                        {this.state.error}\n                    </p>\n                </div>\n\n            )\n\n        } else {\n            return (\n                <div aria-live=\"polite\" className=\"modal-content-padding center-text\">\n                    <h3 className=\"h5-font center-text\">\n                        Trip bookmarked!\n                    </h3>\n                </div>\n            )\n        }\n    }\n\n    renderContent() {\n        if (!this.state.isAuthenticated) {\n            return (\n                <div className=\"modal-content-padding\">\n                    <Authenticate\n                        hideTitle\n                        changeUserOnParent={(newUserValue) => this.changeUserType(newUserValue)}\n                        afterSignIn={(user) => this.bookmarkTrip(user)}\n                        afterCreateAccount={(user) => this.bookmarkTrip(user)}\n                    />\n                </div>\n            )\n        } else {\n            return this.verifyBookmark()\n        }\n    }\n\n    closeModal() {\n        this.setState({\n            isAuthenticated: false,\n            modalTitle: 'Sign In',\n            modalDescription: 'Sign in to add bookmark.',\n            newUser: false,\n            error: ''\n        }, () => {\n            this.props.handleClose()\n        })\n    }\n\n    render() {\n        let {\n            modalTitle,\n            modalDescription\n        } = this.state;\n\n        return (\n            <Modal\n                modalId='manage-trips-modal'\n                modalTitle={modalTitle}\n                modalDescription={modalDescription}\n                isOpen={this.props.isOpen}\n                handleClose={() => this.closeModal()}\n            >\n\n                {this.renderContent()}\n\n            </Modal>\n        )\n    }\n\n}\n\nexport default BookmarkModal;","import firebase from './firebase/firebaseConfig'\n\nlet removeFromBookmarks = (userId, tripId, tripPrivacy, callback) => {\n    let database = firebase.database()\n    let userBookmarksRef = `userBookmarks/${userId}/${tripId}`\n    let tripRef = `${tripPrivacy}Trips/${tripId}/bookmarks/${userId}`\n\n    database.ref(userBookmarksRef).remove().catch(\n        error => {\n            console.log(error)\n        } \n    ).then(\n        () => {\n            database.ref(tripRef).remove().catch(\n                error => {\n                    console.log(error)\n                } \n            )\n        }\n    ).then(\n        () => callback()\n    )\n}\n\nexport default removeFromBookmarks;","import React from 'react'\nimport MapWithCards from '../../components/layout/MapWithCards'\nimport ResultsList from '../../components/content/ResultsList'\nimport firebase from '../../utils/firebase/firebaseConfig'\nimport { EditTripLarge, EditTripSmall } from '../../components/buttons/EditTripButtons'\nimport { BookmarkTripLarge, BookmarkTripSmall } from '../../components/buttons/BookmarkTripButtons'\nimport EditTripModal from '../../components/modals/EditTripModal'\nimport BookmarkModal from '../../components/modals/BookmarkModal'\nimport addToBookmarks from '../../utils/addToBookmarks'\nimport removeFromBookmarks from '../../utils/removeFromBookmarks'\n\nclass TripContent extends React.Component {\n    state = {\n        loaded: false,\n        tripList: [],\n        tripName: '',\n        tripTags: '',\n        locationsCount: 0,\n        mapLat: null,\n        mapLon: null,\n        mapZoom: 10,\n        showEditModal: false,\n        tripPrivacy: null,\n        authorId: '',\n        authorName:'',\n        bookmarked: false,\n        updatingBookmark: false,\n        showBookmarkModal: false\n    }\n    _isMounted = false;\n\n    tripId = this.getTripId()\n\n    getPrivacy() {\n        let pathQuery = this.props.location.search;\n        let searchParams = new URLSearchParams(pathQuery);\n        let privacy = searchParams.get(\"privacy\");\n        return privacy;\n    }\n\n    getTripId() {\n        let pathname = this.props.location.pathname;\n        let tripId = pathname.replace(\"/trip/\", \"\");\n        return tripId;\n    }\n\n\n    componentDidMount() {\n        this._isMounted = true;\n\n        let privacy = this.getPrivacy()\n\n        this.setState({ tripPrivacy: privacy }, () => {\n            this._isMounted && this.getTripDetails(this.state.tripPrivacy, this.tripId);\n            //check if bookmarked\n            this._isMounted && this.checkIfInBookmarks(this.props.userId);\n        }\n        )\n\n    }\n\n    componentDidUpdate(nextProps) {\n        if(this.props.userId !== nextProps.userId) {\n            this._isMounted && this.checkIfInBookmarks(this.props.userId);\n        }\n    }\n\n\n\n    getTripDetails(privacy, tripId) {\n        let database = firebase.database();\n\n        let tripName, locationsCount, tripTags, authorId;\n        let list = []\n        let tripRef = `${privacy}Trips/${tripId}`\n\n        database.ref(`${tripRef}`).get().then(\n            snapshot => {\n                let tripData = snapshot.val()\n                tripName = tripData['tripName']\n                tripTags = tripData['tags']\n                authorId = tripData['author']\n                locationsCount = tripData['locationsCount']\n                this._isMounted && this.setState({\n                    tripName: tripName,\n                    locationsCount: locationsCount,\n                    tripTags: tripTags,\n                    authorId: authorId\n                })\n\n                database.ref(`users/${authorId}/displayName`).get().catch(error=>console.log(error)).then(\n                    snapshot => {\n                        if(snapshot){\n                            let authorName = snapshot.val()\n                            this._isMounted &&  this.setState({authorName: authorName})\n                        }\n                    }\n                )\n\n                let locations = tripData['locations']\n\n\n\n                for (const locationId in locations) {\n\n\n                    let location, src, woeId, url, title, lat, lon, locationRef, photoId;\n                    if (locationId.startsWith(\"flickr-\")) {\n                        src = \"flickr\"\n                        locationRef = `appLocations/flickrSourced/${locationId}`\n                        photoId = locationId.replace(\"flickr-\", \"\");\n                    }\n\n\n                    database.ref(`${locationRef}`).get().then(\n                        (snapshot) => {\n                            let locationData = snapshot.val()\n                            if (locationData) {\n                                let photos = locationData[\"photos\"]\n                                let firstPhoto = photos[Object.keys(photos)[0]]\n                                let coordinates = locationData[\"coordinates\"]\n                                woeId = locationData['woeId']\n                                url = firstPhoto[\"src\"]\n                                title = locationData[\"locationName\"]\n                                lat = coordinates[\"latitude\"]\n                                lon = coordinates[\"longitude\"]\n                            }\n\n                            location = {\n                                \"src\": src,\n                                \"locationId\": photoId,\n                                \"woeId\": woeId,\n                                \"thumbnail\": url,\n                                \"title\": title,\n                                \"destination\": {\n                                    \"latitude\": parseFloat(lat),\n                                    \"longitude\": parseFloat(lon)\n                                }\n                            }\n\n                        }\n                    ).then(() => list.push(location)).catch(error => console.log(\"issue getting location info\", error)).then(\n                        () => {\n\n                            let firstLocation = list[0]\n                            let coordinates = firstLocation[\"destination\"]\n                            let lon = coordinates[\"longitude\"]\n                            let lat = coordinates[\"latitude\"]\n\n                            let update = {\n                                tripList: list,\n                                loaded: true,\n                                mapLat: lat,\n                                mapLon: lon\n                            }\n\n\n                            this.setState(update)\n                        }\n                    )\n                }\n            }\n        ).catch(error => console.log(error))\n\n    }\n\n    openEditModal() {\n        let privacy = this.getPrivacy()\n        this.setState({ tripPrivacy: privacy },\n            () => this.setState({ showEditModal: true }))\n    }\n\n\n\n    closeEditModal(update) {\n        let updated = update['updated']\n        let deleted = update['deleted']\n\n        if (updated) {\n            if (deleted) {\n                this.setState({ showEditModal: !this.state.showEditModal },\n                    () => {\n                        this.props.history.push('/trips')\n                    })\n\n            } else {\n                let newPrivacy = update['newPrivacy']\n\n                if (newPrivacy && (this.state.tripPrivacy !== newPrivacy)) {\n                    this.props.history.push({\n                        search: `?privacy=${newPrivacy}`\n                    })\n\n                    this.setState({ tripPrivacy: newPrivacy })\n                    this._isMounted && this.getTripDetails(newPrivacy, this.tripId);\n                } else {\n                    this._isMounted && this.getTripDetails(this.state.tripPrivacy, this.tripId);\n                }\n            }\n\n        }\n        this.setState({ showEditModal: !this.state.showEditModal })\n\n    }\n\n\n    checkIfInBookmarks(userId) {\n        if (userId !== 'notSignedIn') {\n           \n\n            this.setState({updatingBookmark: true})\n            let database = firebase.database()\n        \n\n            //get the user's bookmakrs\n            this._isMounted && database.ref(`userBookmarks/${userId}`).get().catch(error=> console.log(error)).then((snapshot) => {\n                let inBookmarks = false\n                if (snapshot.exists()) {\n                    let trips = snapshot.val();\n                    //go through each trip and check if they match the current triId\n                    for (const tripId in trips) {\n\n                        if (tripId === this.tripId) {\n                            inBookmarks = true\n                        } \n                    }\n\n                }\n\n                return this.setState({bookmarked: inBookmarks, updatingBookmark: false})\n            })\n        }\n\n    }\n\n\n\n\n    handleBookmark() {\n        if (this.props.userId !== 'notSignedIn') {\n            this.setState({updatingBookmark: true })\n            if(!this.state.bookmarked) {\n                //add to book marks\n                addToBookmarks(\n                    this.props.userId,\n                    this.tripId,\n                    this.state.authorId,\n                    this.state.tripPrivacy,\n                    (errorMessage) => {\n                        if(!errorMessage){\n                            this.checkIfInBookmarks(this.props.userId)\n                        } else {\n                            this.setState({updatingBookmark:false})\n                            console.log(errorMessage)\n                        }\n                    }\n                )\n               \n           } else {\n            //delete bookmark\n            removeFromBookmarks(\n                this.props.userId,\n                this.tripId, \n                this.state.tripPrivacy,\n                () => {\n                    this.checkIfInBookmarks(this.props.userId)\n                }\n            )\n           }\n            \n        } else {\n            //bookmark\n            this.setState({showBookmarkModal: true})\n        }\n    }\n\n\n\n    closeBoomarkModal() {\n        this.setState({showBookmarkModal: false})\n        //check if in bookmarks\n    }\n\n\n    render() {\n        let {\n            loaded,\n            tripList,\n            mapLat,\n            mapLon,\n            mapZoom,\n            locationsCount,\n            tripName,\n            tripTags,\n            tripPrivacy,\n            authorId,\n            bookmarked,\n            updatingBookmark,\n            authorName } = this.state;\n\n\n        return (\n            <>\n                <div className={`trip`}>\n\n                    <MapWithCards\n                        mapLoctaions={tripList}\n                        mapLat={mapLat}\n                        mapLon={mapLon}\n                        mapZoom={mapZoom}\n                    >\n                        <div className='dark-background mobile-header'>\n                            <div className={`container mobile-padding`}>\n                                <button onClick={() => { window.history.back() }} className={`secondary-button back-button`}>Back</button>\n                                {loaded && this.props.userId === authorId && <EditTripSmall onClick={() => this.openEditModal()} />}\n                                {loaded && this.props.userId !== authorId && <BookmarkTripSmall updating={updatingBookmark} bookmarked={bookmarked} onClick={() => this.handleBookmark()} />}\n                            </div>\n                        </div>\n\n                        <div className={`gird-70-30`}>\n                            <div className={`col-70`}>\n                                <div className={`container mobile-padding`}>\n                                    <h2 className=\"h6-font\">{tripName}</h2>\n                                    <p className={`meta-data`}>by {authorName}</p>\n                                    <p className={`meta-data ${tripPrivacy === 'public' ? 'public' : 'private'}`}>{tripPrivacy}</p>\n                                    <p className={`meta-data marker`}>{locationsCount} {locationsCount === 1 ? 'Location' : 'Locations'}</p>\n                                    <p className={`meta-data tags`}>Tags: {tripTags}</p>\n                                </div>\n                            </div>\n                            <div className={`col-30`}>\n                                <ul className=\"actions\">\n                                    {loaded && this.props.userId === authorId && <li>\n                                        <EditTripLarge onClick={() => this.openEditModal()} />\n                                    </li>}\n                                    {loaded && this.props.userId !== authorId && <li>\n                                        <BookmarkTripLarge bookmarked={bookmarked} updating={updatingBookmark} onClick={() => this.handleBookmark()} />\n                                    </li>}\n                                </ul>\n                            </div>\n                        </div>\n                        <div className={`container`}>\n                            <ResultsList loaded={loaded} list={tripList} />\n                        </div>\n\n                    </MapWithCards>\n                    <EditTripModal\n                        isOpen={this.state.showEditModal}\n                        handleClose={(update) => this.closeEditModal(update)}\n                        originalTripName={tripName}\n                        originalTripTags={tripTags}\n                        originalTripPrivacy={tripPrivacy}\n                        userId={this.props.userId}\n                        tripId={this.tripId}\n                        searchQuery={this.props.location.search}\n                    />\n\n                    <BookmarkModal\n                        isOpen={this.state.showBookmarkModal}\n                        handleClose={() => this.closeBoomarkModal()}\n                        tripId={this.tripId}\n                        tripPrivacy={tripPrivacy}\n                        tripauthorId={authorId}\n                    />\n                </div>\n            </>\n        )\n    }\n}\n\nexport default TripContent;","import { Switch, Route } from 'react-router-dom';\nimport React from 'react';\nimport firebase from './utils/firebase/firebaseConfig'\n\nimport Navbar from './components/navigation/Navbar';\nimport Home from './screens/explore/Home';\nimport SearchResults from './screens/explore/SearchResults';\nimport Account from './screens/Account';\nimport Trips from './screens/trips/Trips';\nimport PrivateRoute from './components/navigation/PrivateRoute';\nimport Footer from './components/content/Footer';\nimport Location from './screens/location/Location';\nimport TripContent from './screens/trips/TripContent';\nimport './styles/main.scss';\n\n\nclass App extends React.Component {\n\n  state = {\n    signedIn: false,\n    userVerified: false,\n    userId: null\n\n  }\n\n\n\n  componentDidMount() {\n    firebase.auth().onAuthStateChanged(user => {\n      if (user) {\n        this.setState({\n          signedIn: true,\n          userVerified: user.emailVerified,\n          userId: user.uid\n        });\n      } else {\n        this.setState({ signedIn: false });\n      }\n    });\n  };\n\n\n  render() {\n\n    let { signedIn, userVerified } = this.state;\n\n    return (\n      <>\n\n        <Navbar />\n        <main>\n\n          <Switch>\n            <Route exact path=\"/\" component={Home} />\n\n            <Route path=\"/explore\" component={SearchResults} />\n\n            <Route path=\"/location\"\n\n              render={\n                (props) => <Location {...props} isAuthenticated={signedIn} userId={this.state.userId} />\n\n              } />\n\n            <Route path=\"/trips\"\n\n              render={\n                (props) => <Trips {...props} userId={this.state.userId} isAuthenticated={signedIn} isVerified={userVerified} />\n\n              } />\n\n            <Route path=\"/trip\"\n\n              render={\n                (props) => <TripContent {...props} userId={signedIn ? this.state.userId : 'notSignedIn'} />\n\n              } />\n\n            <PrivateRoute path=\"/account\" component={Account} isAuthenticated={signedIn} isVerified={userVerified} logInLocation={\"account\"} />\n\n\n          </Switch>\n\n\n        </main>\n\n        <Footer />\n\n      </>\n    );\n  }\n}\n\n\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport App from './App';\n\n\n\n\n\n\n\nReactDOM.render(\n  <React.StrictMode>\n     <BrowserRouter>\n         <App />  \n    </BrowserRouter>    \n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}