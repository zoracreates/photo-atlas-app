{"version":3,"sources":["utils/firebase/firebaseConfig.js","components/navigation/Navbar.js","images/icons/nav-logo.png","components/forms/SearchBar.js","components/layout/TitleCardCols.js","components/cards/TtitleCard.js","utils/flickr/getFlickrPhotos.js","utils/flickr/getFlickrPlace.js","utils/getCurrentLocation.js","utils/getGeoSuggestions.js","screens/explore/Home.js","components/map/MapPopUp.js","components/map/ChangeMapView.js","components/map/Map.js","components/layout/MapWithCards.js","components/content/ResultsList.js","components/forms/CheckBox.js","components/forms/SubmitButton.js","utils/filterTags.js","components/forms/SubjectFilters.js","screens/explore/SearchResults.js","components/modals/Modal.js","components/modals/ResetPasswordModal.js","components/forms/TextInput.js","components/modals/ChangeDisplayName.js","screens/Account.js","utils/getPublicTrips.js","components/layout/OneToTwoCols.js","components/cards/TripCard.js","components/content/UnfilteredTrips.js","components/content/FilteredTrips.js","screens/trips/PublicTrips.js","components/forms/EmailInput.js","components/forms/PasswordInput.js","screens/authentication/SignIn.js","screens/authentication/SignUp.js","screens/authentication/Authenticate.js","screens/authentication/VerifyEmail.js","components/navigation/PrivateTab.js","utils/getUserTrips.js","screens/trips/MyTrips.js","utils/getUserBookmarks.js","screens/trips/BookmarkedTrips.js","screens/trips/Trips.js","components/navigation/PrivateRoute.js","components/content/Footer.js","components/slider/PhotoSlider.js","components/content/SubjectIndicators.js","utils/flickr/getFlickrPhotoInfo.js","utils/flickr/createFlickrImageUrl.js","components/buttons/DirectionsButtons.js","components/buttons/AddToTripsButtons.js","components/forms/RadioButton.js","utils/generateDateAndTime.js","utils/generateId.js","components/modals/ManageTripsModal.js","utils/getSavesCount.js","screens/location/Location.js","components/buttons/EditTripButtons.js","components/buttons/BookmarkTripButtons.js","components/modals/EditTripModal.js","utils/addToBookmarks.js","components/modals/BookmarkModal.js","utils/removeFromBookmarks.js","screens/trips/TripContent.js","App.js","index.js"],"names":["firebase","initializeApp","apiKey","process","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","Navbar","location","useLocation","pathname","tripsPath","RegExp","accountPath","tripPagePath","locationPagePath","tripsActive","test","accountActive","tripPageActive","locationPageActive","exploreActive","className","to","src","alt","SearchBar","props","name","onClick","placeholder","backSearch","id","labelText","action","method","searchSuggestions","autoComplete","handleSuggestion","rest","searchStyle","htmlFor","window","history","back","type","map","suggestion","tabIndex","data","y","x","label","TitleCardCols","children","TitleCard","thumbnail","title","locationId","woeId","titleLength","length","extraChars","slicedTitle","slice","lastSpace","lastIndexOf","createUrl","url","item","options","hasOwnProperty","a","axios","get","response","console","log","getFlickrPhotos","placeId","place","woe_name","getFlickrPlace","getCurrentLocation","handleSuccess","handleError","navigator","geolocation","getCurrentPosition","position","err","input","provider","AlgoliaProvider","search","query","results","getGeoSuggestions","Home","state","currentLocation","errorMessage","noLocations","locationResults","searchBarSuggestions","default","_isMounted","getNearbyLocations","currentLat","latitude","currentLon","longitude","existingLocations","list","then","photos","photo","forEach","url_n","woeid","tags","includes","push","placeName","setState","e","preventDefault","this","target","value","aria-live","lat","lon","defaultLocation","setDefault","coords","message","setTimeout","renderDefaultLocations","renderNearby","onChange","handleInput","handleSubmit","suggestionClick","renderLocations","React","Component","MapPopup","Popup","ChangeMapView","center","zoom","useMap","setView","propTypes","PropTypes","arrayOf","number","DefaultIcon","L","icon","iconUrl","shadowUrl","iconShadow","Marker","prototype","Map","locations","MapContainer","TileLayer","attribution","destination","MapWithCards","openedMap","handleToggle","mapLoctaions","mapLat","mapLon","mapZoom","toggleBarClass","bind","ResultsList","loaded","needLocation","count","CheckBox","SubmitButton","filterTags","abandonedTags","architectureTags","astroTags","landscapeTags","sunriseTags","sunsetTags","transportTags","peopleTags","urbanTags","waterTags","natureTags","streetArtTags","SubjectFilters","open","filters","abandoned","architecture","astro","landscape","sunrise","sunset","transport","people","urban","water","nature","streetArt","formChanged","previousFilters","prevProps","resetFilters","filterString","activeFilters","filter","index","concat","prevState","checked","toggleDropdown","closeDropdown","handleChange","sendData","SearchResults","searchResults","getSearchResults","searchLat","searchLon","parseFloat","address","decodeURIComponent","searchParams","URLSearchParams","has","handleFilters","findNearby","Modal","modalId","modalTitle","modalDescription","isOpen","handleClose","modalTitleId","closeModal","role","aria-modal","aria-labelledby","ResetPasswordModal","error","successReset","auth","emailAddress","email","form","sendPasswordResetEmail","catch","resetPassword","TextInput","ChangeDisplayNameModal","newName","nameUpdated","loading","confirmReset","user","currentUser","database","userId","uid","ref","update","displayName","triggerUpdate","currentName","changeDisplayName","Account","changeName","updateUser","reseted","signOut","component","snapshot","exists","val","openDisplayNameModal","openPasswordModal","closePasswordModal","logInLocation","ChangeDisplayName","closeDisplayNameModal","getPublicTrips","callback","existingTrips","trips","tripId","locationsCount","authorId","existingTripUpdate","privacy","OneToTwoCols","TripCard","authorName","getAuthor","UnfilteredTrips","trip","FilteredTrips","PublicTrips","searching","loadingSearchResults","searchTerms","tripsList","toLowerCase","titleMatch","tagsMatch","handleSearchInput","renderPublicTrips","EmailInput","PasswordInput","checkName","changeType","SignIn","emailError","forgotPassword","hideTitle","tabContent","introtext","onSubmit","handleEmailInput","required","password","handlePassInput","passError","togglePasswordReset","SignUp","firstname","handleNameInput","nameError","lastname","handleLastnameInput","lastnameError","confirmPassword","handleConfirmPassInput","confirmPassError","Authenticate","newUser","fetchSignInMethodsForEmail","signInMethods","indexOf","EmailAuthProvider","EMAIL_PASSWORD_SIGN_IN_METHOD","signInWithEmailAndPassword","userCredential","afterSignIn","errorCode","code","testString","createUserWithEmailAndPassword","userInfo","set","afterCreateAccount","changeUserOnParent","text","handleCreateAccount","handleSignIn","renderContent","changeUserType","VerifyEmail","sendEmailVerification","PrivateTab","isAuthenticated","isVerified","componentContent","getUserTrips","tripRef","inTrip","tripData","MyTrips","getTripsList","nextProps","renderUserTrips","BookmarkedTrips","getUserBookmarks","renderUserBookmarks","Trips","tab","switchTabs","PrivateRoute","render","Footer","PhotoSlider","imageList","imagesCount","buttons","showDownloadButton","showAutoplayButton","image","author","creditUrl","href","SubjectIndicators","subjects","photoId","handleResponse","responseData","fetch","ok","Error","statusText","json","getFlickrPhotoInfo","createFlickrImageUrl","photoData","farm","server","secret","DirectionsSmall","DirectionsLarge","AddToTripsLarge","added","AddToTripsSmall","RadioButton","idName","generateDate","d","Date","day","getDate","month","getMonth","year","getFullYear","generateId","prefix","sufix","result","characters","charactersLength","i","charAt","Math","floor","random","ManageTripsModal","newTripPrivacy","newTripName","newTripTags","creatingTrip","tripNameLength","tripNameError","tripTagsError","newTripCreated","needNewTrip","errorCreatingTrip","errorCreatingLocation","errorUpdatingUserTrips","errorAddingFilters","updatingTrips","newUserValue","checkExistingTrips","checkAuth","selectExistingTrip","getNewTripInfo","renderExistingTrips","switchForm","addOrRemoveFromTrip","valueLength","renderDatabaseErrors","handleTripNamelInput","handleTripTagsInput","handleNewTripPrivacy","defaultChecked","createNewTrip","locationRef","locationPhotosArray","locationName","locationCoordinates","coordinates","locationSubjectsArray","date","locationSubjects","locationPhotos","flickrId","subject","savedCount","addedDate","curated","userLastEditedDate","subjectRef","errorAddingFilter","tripPrivacy","tripName","tripFeaturedImgSrc","tripAuthor","tripTags","endsWith","time","hour","getHours","minutes","getMinutes","seconds","getSeconds","milliseconds","getMilliseconds","generateTimeNumber","generateID","featuredImg","createdOn","lastEdited","startsWith","transaction","createNewFlickrSourcedLocation","renderModalContent","getSavesCount","Location","distance","saves","firstPhoto","showTripsModal","inTrips","checkIfInTrips","locationTrips","replace","pathQuery","_content","description","owner","realname","username","urls","getLocationDetailsFromFlickr","tagsList","tag","tagsString","setSubject","tagsArray","split","newTitle","newSrc","newAlt","newAuthor","ownername","ownerId","newLocation","manageTripsModal","data-micromodal-trigger","EditTripLarge","EditTripSmall","BookmarkTripLarge","bookmarked","updating","BookmarkTripSmall","EditTripModal","errorUpdatingTrip","tagsUpdated","originalTripPrivacy","updatingTrip","tripUpdate","confirmDelete","tripDeleted","tagButtons","originalPrivacy","userTripRef","newPrivacy","originalTripName","originalTripTags","deleteBookmarks","remove","errorUpdatingTrips","userTripsUpdate","bookmarks","searchQuery","searchPrivacy","defaultPrivate","defaultPublic","defaultShareable","handleTripPrivacy","updateTrip","toggleDeleteFrom","deleteTrip","renderUpdateForm","tripUpdated","updated","deleted","addToBookmarks","bookmarkingError","BookmarkModal","verifyBookmark","bookmarkTrip","removeFromBookmarks","userBookmarksRef","TripContent","tripList","showEditModal","updatingBookmark","showBookmarkModal","getTripId","getPrivacy","getTripDetails","checkIfInBookmarks","locationData","Object","keys","inBookmarks","openEditModal","handleBookmark","closeEditModal","closeBoomarkModal","tripauthorId","App","signedIn","userVerified","onAuthStateChanged","emailVerified","exact","path","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.151500ea.chunk.js","sourcesContent":["import firebase from 'firebase/app';\nimport \"firebase/auth\";\nimport \"firebase/database\";\n\nconst config = {\n    apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n    authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n    databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\n    projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.REACT_APP_FIREBASE_APP_ID\n};\n\nfirebase.initializeApp(config);\n\nexport default firebase;","import { Link, useLocation } from 'react-router-dom';\n\nimport logo from '../../images/icons/nav-logo.png'\n\nfunction Navbar() {\n\n    // Check Router's location to set active status\n    let location = useLocation().pathname;\n\n    let tripsPath = new RegExp('/trips/?');\n    let accountPath = new RegExp('/account/?');\n    let tripPagePath = new RegExp('/trip/?');\n    let locationPagePath = new RegExp('/location/?');\n\n    let tripsActive = tripsPath.test(location);\n    let accountActive = accountPath.test(location);\n    let tripPageActive = tripPagePath.test(location)\n    let locationPageActive = locationPagePath.test(location)\n\n    let exploreActive = (!tripsActive && !accountActive && !tripPageActive && !locationPageActive );\n    \n\n    return (\n        <header>\n            <div className={`container`}>\n                <div className={`logo`}>\n                    <Link to=\"/\">\n                        <h1>Photo Atlas</h1>\n                        <img src={logo} alt={`PhotoAtlas logo`} />\n                    </Link>\n                </div>\n                <nav>\n                    <ul>\n                        <li>\n                            <Link to=\"/\" className={`explore ${exploreActive ? 'active' : 'normal'}`}>\n                                <span>Explore</span>\n                            </Link>\n                        </li>\n\n                        <li>\n                            <Link to=\"/trips\" className={`trips ${tripsActive ? 'active' : 'normal'}`}>\n                                <span>Trips</span>\n                            </Link>\n                        </li>\n\n                        <li>\n                            <Link to=\"/account\" className={`profile ${accountActive ? 'active' : 'normal'}`}>\n                                <span>Account</span>\n                            </Link>\n                        </li>\n                    </ul>\n                </nav>\n            </div>\n        </header>\n    )\n}\n\nexport default Navbar;","export default \"data:image/png;base64,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\"","import PropTypes from 'prop-types';\n\nfunction SearchBar(props) {\n\n    let {\n        className,\n        name,\n        onClick,\n        placeholder,\n        backSearch,\n        id,\n        labelText,\n        action,\n        method,\n        searchSuggestions,\n        autoComplete,\n        handleSuggestion,\n        ...rest } = props;\n\n\n    function sendData(data) {\n        if (handleSuggestion) {\n            handleSuggestion(data)\n        } else {\n            return undefined\n        }\n    }\n\n    let searchStyle = backSearch ? 'back-search' : 'standard-search';\n\n    return (\n        <>\n            {labelText && <label className={`search-label ${searchStyle}-label`} htmlFor={id ? id : 'gsearch'}>{labelText}</label>}\n            <div className={`search-bar-container ${searchStyle} ${className ? className : ''}`}>\n                <button onClick={() => { window.history.back() }} className={`search-back-button`}>Back</button>\n\n                <form className=\"search-form\" action={action} method={method}>\n\n                    <input\n\n                        type=\"search\"\n\n                        className={`text-bar`}\n\n                        name={name ? name : 'q'}\n\n                        id={id ? id : 'gsearch'}\n\n                        placeholder={placeholder ? placeholder : 'Search Term'}\n\n                        autoComplete={autoComplete ? autoComplete : 'off'}\n\n                        {...rest}\n\n                    />\n\n\n\n                    {searchSuggestions &&\n\n                        <ul className={`search-suggestions`}>\n\n                            {searchSuggestions[0] && searchSuggestions.map((suggestion, id) => {\n                                return (\n                                    <li key={id}>\n                                        <button\n                                            tabIndex=\"0\"\n\n                                            onClick={() => sendData(\n                                                //geocoding search means x = lat and y = lon https://smeijer.github.io/leaflet-geosearch/usage\n                                                {\n                                                    'lat': suggestion.y,\n                                                    'lon': suggestion.x,\n                                                    'label': suggestion.label\n                                                }\n                                            )}>{suggestion.label}</button></li>\n                                )\n\n                            }\n\n                            )\n                            }\n\n                        </ul>\n                    }\n                    <button className={`search-button`} onClick={onClick}>Search</button>\n                </form>\n            </div>\n        </>\n    )\n}\n\nSearchBar.propTypes = {\n    className: PropTypes.string,\n    labelText: PropTypes.string,\n    backSearch: PropTypes.bool,\n    name: PropTypes.string,\n    onClick: PropTypes.func,\n    placeholder: PropTypes.string,\n    autoComplete: PropTypes.string,\n    handleSuggestion: PropTypes.func\n}\n\n\nexport default SearchBar;","function TitleCardCols(props) {\n\n    return (\n        <div className={`grid-title-card`}>\n            {props.children}\n        </div>\n    )\n\n}\n\nexport default TitleCardCols;","import PropTypes from 'prop-types';\nimport { Link } from 'react-router-dom'\n\nfunction TitleCard(props) {\n    let {\n        thumbnail,\n        title,\n        src,\n        locationId,\n        woeId } = props;\n\n    if (!title) {\n        title = \"Unamed Location\"\n    }\n\n    let titleLength = title.length;\n\n    //keep the lenght of the title at 45 characters\n    if (titleLength > 150) {\n        let extraChars = 150 - titleLength;\n        let slicedTitle = title.slice(0, extraChars);\n        let lastSpace = slicedTitle.lastIndexOf(\" \");\n        slicedTitle = slicedTitle.slice(0, lastSpace);\n        title = `${slicedTitle}...`\n    }\n\n    return (\n        <Link className={`title-card`} to={ `/location/${src}-${locationId}?woe=${woeId}`}>\n            <div className={`title-card-image`}>\n                <img src={thumbnail} alt=\"\" />\n            </div>\n\n            <p className={`title`}>{title}</p> \n        </Link>\n    )\n}\n\nTitleCard.propTypes = {\n    thumbnail: PropTypes.string,\n    title: PropTypes.string,\n    src: PropTypes.string,\n    locationId: PropTypes.string,\n    woeId: PropTypes.string\n}\n\n\nexport default TitleCard;","import axios from 'axios';\n\nfunction createUrl(options = {}) {\n    let url, item;\n    url = `https://api.flickr.com/services/rest/?api_key=${process.env.REACT_APP_FLICKR_API_KEY}&method=flickr.photos.search&format=json&nojsoncallback=true}`\n\n    for (item in options) {\n        if (options.hasOwnProperty(item)) {\n            url += \"&\" + item + \"=\" + options[item];\n        }\n    }\n\n    return url;\n}\n\nasync function getFlickrPhotos(options = {}) {\n    \n    let url = createUrl(options)\n    let response;\n\n    try {\n       response = await axios.get(url)\n       return response.data\n       \n    } catch(err) {\n        console.log(err); \n    }\n\n};\n\n\nexport default getFlickrPhotos;","import axios from 'axios';\n\nasync function getFlickrPlace(options = {}) {\n    \n    let url, response;\n\n    if (options.placeId) {\n        url = `https://api.flickr.com/services/rest/?api_key=${process.env.REACT_APP_FLICKR_API_KEY}&method=flickr.places.getInfo&format=json&nojsoncallback=1}&place_id=${options.placeId}`\n    }\n    else if (options.woeId) {\n        url = `https://api.flickr.com/services/rest/?api_key=${process.env.REACT_APP_FLICKR_API_KEY}&method=flickr.places.getInfo&format=json&nojsoncallback=1}&woe_id=${options.woeId}`\n    }\n    else {\n        return\n    }\n\n        try {\n            response = await axios.get(url)\n            if (response.data) {\n                if(response.data.place.woe_name) {\n                    return response.data.place.woe_name\n                 }\n            }\n         } catch(err) {\n             console.log(err); \n         }\n     \n};\n\nexport default getFlickrPlace;\n","function getCurrentLocation  (handleSuccess, handleError) {\n    window.navigator.geolocation.getCurrentPosition(\n        position => handleSuccess(position),\n        err => handleError(err)\n    );\n}\n\nexport default getCurrentLocation;","import { AlgoliaProvider } from 'leaflet-geosearch';\n\nasync function getGeoSuggestions(input) {\n    const provider = new AlgoliaProvider();\n\n    try {\n        const results = await provider.search({query: input});\n        if (results) {\n            return results\n        }\n        else {\n            return []\n        }\n    }\n    catch (err) {\n        console.log(err);\n    }\n}\n\nexport default getGeoSuggestions;\n\n//https://smeijer.github.io/leaflet-geosearch/providers/algolia\n//https://smeijer.github.io/leaflet-geosearch/usage","import React from 'react';\nimport SearchBar from '../../components/forms/SearchBar';\nimport TitleCardCols from '../../components/layout/TitleCardCols'\nimport TitleCard from '../../components/cards/TtitleCard'\nimport getFlickrPhotos from '../../utils/flickr/getFlickrPhotos';\nimport getFlickrPlace from '../../utils/flickr/getFlickrPlace';\nimport getCurrentLocation from '../../utils/getCurrentLocation';\nimport getGeoSuggestions from '../../utils/getGeoSuggestions'\n\nclass Home extends React.Component {\n\n    state = {\n        query: '',\n        currentLocation: null,\n        errorMessage: '',\n        noLocations: false,\n        locationResults: [],\n        searchBarSuggestions: '',\n        default: false\n    };\n\n    _isMounted = false;\n\n    handleSubmit(e) {\n        e.preventDefault();\n\n        // use the first suggestion to search\n        if (this.state.searchBarSuggestions) {\n            let suggestion = this.state.searchBarSuggestions[0]\n\n            this.setState({ query: suggestion.label })\n\n            //geocoding search means x = lat and y = lon https://smeijer.github.io/leaflet-geosearch/usage\n            let search = `address=${suggestion.label}&lat=${suggestion.y}&lon=${suggestion.x}`\n            this.props.history.push(`/explore/?q&${search}`);\n        }\n        else {\n            return undefined\n        }\n    }\n\n\n    handleInput(e) {\n        this.setState(\n\n            { query: e.target.value },\n\n            () => {\n\n                if (!this.state.query) {\n                    this.setState({ searchBarSuggestions: '' })\n                }\n                else {\n                    getGeoSuggestions(this.state.query).then(results => this.setState({ searchBarSuggestions: results }))\n                }\n\n            })\n\n    }\n\n    renderNearby(list) {\n\n        if (!this.state.errorMessage && this.state.noLocations) {\n            return <p aria-live=\"polite\">Looks like there aren't any photo spots nearby yet. Let's explore a different location</p>\n        }\n\n        if (!this.state.errorMessage && this.state.currentLocation) {\n            return (\n                <>\n                <h2 className={`h5-font`}>Explore Nearby</h2>\n                    <p aria-live=\"polite\" className=\"sr-only\">Showing nearby locations</p>\n                    <TitleCardCols>\n                        {list.map((location, id) => {\n                            const { thumbnail, title, src, locationId, woeId } = location;\n                            return (\n                                //make these into links where the search param should be the photo id\n                                <TitleCard\n                                    key={id}\n                                    thumbnail={thumbnail}\n                                    title={title}\n                                    src={src}\n                                    locationId={locationId}\n                                    woeId={woeId}\n                                />\n                            )\n\n                        })}\n                    </TitleCardCols>\n                </>\n            )\n\n        }\n\n        return <p>Getting photo spots...</p>\n    }\n\n    renderDefaultLocations(list) {\n\n        while (list.length === 0) {\n            return (\n                <>\n                    <p>Getting photo spots...</p>\n                </>\n            )\n        }\n        return (\n            <>\n                <h2 className={`h5-font`}>Explore Cabo Rojo, Puerto Rico</h2>\n                <p aria-live=\"polite\" className=\"sr-only\">Showing Cabo Rojo Puerto Rico</p>\n                <TitleCardCols>\n                    {list.map((location, id) => {\n                        const { thumbnail, title, src, locationId, woeId } = location;\n                        return (\n                            //make these into links where the search param should be the photo id\n                            <TitleCard\n                                key={id}\n                                thumbnail={thumbnail}\n                                title={title}\n                                src={src}\n                                locationId={locationId}\n                                woeId={woeId}\n                            />\n                        )\n\n                    })}\n                </TitleCardCols>\n            </>\n        )\n    }\n\n\n    getNearbyLocations = () => {\n\n\n        let location = this.state.currentLocation\n\n\n        if (location) {\n\n\n            let currentLat = location.latitude;\n\n            let currentLon = location.longitude;\n            let options = {\n                \"lat\": currentLat,\n                \"lon\": currentLon,\n                \"accuracy\": 16,\n                \"extras\": \"geo, tags, url_n\"\n            }\n\n            //create a list of locations\n            let existingLocations = [];\n\n            let list = [];\n\n            getFlickrPhotos(options).then(data => {\n\n                if (!data) {\n                    return undefined\n                }\n\n                let photos = data.photos.photo;\n\n                if (!photos[0]) {\n                    this.setState({ noLocations: true })\n                }\n\n                else {\n\n                    photos.forEach(\n\n                        photo => {\n\n                            let url = photo.url_n\n\n\n                            let title = photo.title;\n\n                            let woeId = photo.woeid;\n\n                            let locationId = photo.id;\n\n                            let tags = photo.tags;\n\n                            //prevent duplicate locations and locations with no tags\n                            if (woeId && !existingLocations.includes(woeId) && tags) {\n\n                                existingLocations.push(woeId);\n\n                                let location = {\n                                    \"src\": \"flickr\",\n                                    \"locationId\": locationId,\n                                    \"thumbnail\": url,\n                                    \"title\": title,\n                                    \"woeId\": woeId\n                                }\n\n                                let place = async (options) => {\n                                    let placeName = await getFlickrPlace(options);\n                                    return placeName\n                                }\n\n                                place({ \"woeId\": woeId }).then(placeName => {\n\n                                    if (placeName) {\n                                        location.title = placeName\n                                    }\n\n                                }).then(\n\n                                    list.push(location)\n\n                                )\n                            }\n                        }\n                    )\n\n\n\n                    this.setState({\n                        locationResults: list,\n                        noLocations: false\n                    })\n\n\n                }\n            }\n\n            )\n        }\n\n    }\n\n    suggestionClick(suggestion, e) {\n        this.setState({ query: suggestion.label })\n        let search = `address=${suggestion.label}&lat=${suggestion.lat}&lon=${suggestion.lon}`\n        this.props.history.push(`/explore/?q&${search}`);\n    }\n\n    componentDidMount() {\n\n        this._isMounted = true;\n\n        let defaultLocation = {\n            latitude: 18.087,\n            longitude: -67.1459\n        }\n\n        let setDefault = () => {\n            if (!this.state.currentLocation) {\n                this.setState(\n                    { currentLocation: defaultLocation, default: true },\n                    () => this.getNearbyLocations()\n                )\n            }\n        }\n\n        getCurrentLocation(\n            position =>  {\n                if( this._isMounted && !this.state.default) {\n                    this.setState({ currentLocation: position.coords}, () => this.getNearbyLocations())\n                }\n            },\n            err => this._isMounted && this.setState({ errorMessage: err.message }, ()=>setDefault())\n        )\n\n        setTimeout(function(){ setDefault() }, 3500);\n\n\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n\n    renderLocations(locationResults) {\n        if (!this.state.default) {\n            return (\n                <>\n                    {this.renderNearby(locationResults)}\n                </>\n            )\n        } else {\n            return (\n                <>\n                    {this.renderDefaultLocations(locationResults)}\n                </>\n            )\n        }\n    }\n\n\n\n    render() {\n        let { query, locationResults, searchBarSuggestions } = this.state;\n\n        return (\n            <div className={`home`}>\n                <div className={`background-image`}>\n                    <div className={`container mobile-padding`}>\n                        <p className={`home-heading`}>Photo Atlas</p>\n                        <h2 className={`h5-font`}>Find new places to capture your best work.</h2>\n                        <SearchBar\n\n                            method={`get`}\n\n                            value={query}\n\n                            onChange={(e) => { this.handleInput(e) }}\n\n                            labelText=\"Where do you want to go?\"\n\n                            placeholder=\"Search a place\"\n\n                            onClick={(e) => this.handleSubmit(e)}\n\n                            searchSuggestions={searchBarSuggestions}\n\n                            handleSuggestion={(suggestion, e) => { this.suggestionClick(suggestion) }}\n                        />\n\n\n                    </div>\n                </div>\n                <div className={`container mobile-padding`}>\n\n                    {this.renderLocations(locationResults)}\n                </div>\n\n            </div>\n        )\n\n    }\n\n}\n\nexport default Home;","import PropTypes from 'prop-types';\nimport { Popup } from 'react-leaflet';\nimport { Link } from 'react-router-dom'\n\nfunction MapPopup(props) {\n\n    let {\n        thumbnail,\n        title,\n        src,\n        locationId,\n        woeId } = props;\n\n    if (!title) {\n        title = \"Unamed Location\"\n    }\n\n    let titleLength = title.length;\n\n    //keep the lenght of the title at 45 characters\n    if (titleLength > 150) {\n        let extraChars = 150 - titleLength;\n        let slicedTitle = title.slice(0, extraChars);\n        let lastSpace = slicedTitle.lastIndexOf(\" \");\n        slicedTitle = slicedTitle.slice(0, lastSpace);\n        title = `${slicedTitle}...`\n    }\n\n    return (\n        <Popup>\n            <div className={\"map-popup\"}>\n\n                <div className={\"location-popup-image\"}>\n                    <img src={thumbnail} alt=\"\" />\n                </div>\n                <Link to={ `/location/${src}-${locationId}?woe=${woeId}`} className={`title`}>{title}</Link>\n\n            </div>\n        </Popup>\n    )\n}\n\nMapPopup.propTypes = {\n    thumbnail: PropTypes.string,\n    title: PropTypes.string,\n    src: PropTypes.string,\n    locationId: PropTypes.string,\n    woeId: PropTypes.string\n}\n\n\nexport default MapPopup;","import PropTypes from 'prop-types';\nimport { useMap } from 'react-leaflet';\nfunction ChangeMapView(props) {\n    let { center, zoom } = props;\n    const map = useMap();\n    map.setView(center, zoom);\n    return null\n}\n\nChangeMapView.propTypes = {\n    center: PropTypes.arrayOf(PropTypes.number),\n    zoom:PropTypes.number\n}\n\nexport default ChangeMapView;\n/* \nExcept for its children, MapContainer props are immutable, and changes must be passed as events in children\nhttps://react-leaflet.js.org/docs/api-map/\nhttps://stackoverflow.com/questions/64665827/react-leaflet-center-attribute-does-not-change-when-the-center-state-changes*/","import React from 'react';\nimport { MapContainer, TileLayer, Marker } from 'react-leaflet';\nimport PropTypes from 'prop-types';\nimport MapPopup from '../map/MapPopUp'\n\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\n\nimport ChangeMapView from './ChangeMapView';\n\n/* fix marker icon not rendering */\nimport icon from 'leaflet/dist/images/marker-icon.png';\nimport iconShadow from 'leaflet/dist/images/marker-shadow.png';\n\nlet DefaultIcon = L.icon({\n    iconUrl: icon,\n    shadowUrl: iconShadow\n});\n\nL.Marker.prototype.options.icon = DefaultIcon;\n\n\nfunction Map(props) {\n\n    let { locations, lat, lon, zoom } = props;\n\n    if (!locations) {\n        locations = []\n    }\n\n    if (!lat || !lon) {\n        lat = 34.36;\n        lon = -20.58;\n    }\n\n    let center = [lat, lon]\n\n    return (\n\n        <MapContainer center={center} zoom={10} >\n            <ChangeMapView center={center} zoom={zoom} />\n            <TileLayer\n                attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n            />\n\n\n            {locations.map((location, id) => {\n                const { thumbnail, title, destination, locationId, src, woeId } = location;\n\n                let lat = destination.latitude;\n                let lon = destination.longitude;\n\n                return (\n                    <Marker key={id} position={[lat, lon]}>\n                        <MapPopup \n                            thumbnail={thumbnail}\n                            title={title}\n                            locationId={locationId}\n                            src={src}\n                            woeId={woeId}\n                             />\n                    </Marker>\n                )\n            })\n\n            }\n\n        </MapContainer>\n\n    )\n}\n\nMap.propTypes ={\n    locations: PropTypes.arrayOf(PropTypes.object),\n    lat: PropTypes.number,\n    lon: PropTypes.number,\n    zoom:PropTypes.number\n}\n\nexport default Map;","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Map from '../map/Map';\n\nclass MapWithCards extends React.Component {\n\n    state = {\n        openedMap: false\n    }\n\n    handleToggle = () => {\n        this.setState({ openedMap: !this.state.openedMap });\n    }\n\n    render() {\n        let { children, mapLoctaions, mapLat, mapLon, mapZoom } = this.props;\n\n        let { openedMap } = this.state;\n\n        let handleToggle = this.handleToggle;\n\n        let toggleBarClass = openedMap ? 'open' : 'close';\n\n        return (\n            <div className={`grid-map`}>\n\n                <div className={`cards-container ${toggleBarClass}`}>\n                    {children}\n                </div>\n\n                <div className={`map-container ${toggleBarClass}`}>\n\n                    <div className={`toggle-bar`} onClick={handleToggle.bind(this)}>\n                        <p>\n                            {openedMap ? 'Hide Map' : 'Show Map'}\n                        </p>\n\n                    </div>\n\n                    <div className={'map'}>\n                        <Map locations={mapLoctaions} lat={mapLat} lon={mapLon} zoom={mapZoom}/>\n                    </div>\n                </div>\n\n            </div>\n\n        )\n\n    }\n\n}\n\n\nMapWithCards.propTypes ={\n    mapLocations: PropTypes.arrayOf(PropTypes.object),\n    mapLat: PropTypes.number,\n    mapLon: PropTypes.number,\n    mapZoom:PropTypes.number\n}\n\n\n\nexport default MapWithCards;","\nimport PropTypes from 'prop-types';\n\n\nimport TitleCard from '../cards/TtitleCard'\nimport TitleCardCols from '../../components/layout/TitleCardCols';\n\nfunction ResultsList(props) {\n\n    let { loaded, list, needLocation } = props;\n\n    let count = list.length;\n\n    if (!loaded) {\n        return <p>Getting Locations...</p>\n    }\n\n    if (loaded && count > 0) {\n        return (\n            <>\n            <div aria-live=\"polite\" className=\"sr-only\">\n                <p>Showing search results</p>\n            </div>\n            <TitleCardCols>\n            {list.map((location, id) => {\n                const { thumbnail, title, src, locationId, woeId } = location;\n\n                return (\n                    \n                    <TitleCard\n                        key={id}\n                        thumbnail={thumbnail}\n                        title={title}\n                        src={src}\n                        locationId={locationId}\n                        woeId={woeId}\n                        />\n                    \n                )\n\n            })}\n            </TitleCardCols>\n            </>\n        )\n\n    }\n\n    if (loaded && needLocation && count === 0) {\n        return (\n            <p aria-live=\"polite\">\n                Share your location to explore what's nearby.\n            </p>\n        )\n    }\n\n    if (loaded && count === 0 && !needLocation) {\n        return (\n            <p aria-live=\"polite\">\n                Sorry, no photo spots here yet.\n            </p>\n        )\n    }\n\n}\n\nResultsList.propTypes = {\n    loaded: PropTypes.bool.isRequired,\n    list: PropTypes.arrayOf(PropTypes.object).isRequired,\n    needLocation: PropTypes.bool\n}\n\nexport default ResultsList;","import PropTypes from 'prop-types';\n\nfunction CheckBox(props) {\n\n    let {\n        className,\n        id,\n        name,\n        labelText,\n        ...rest } = props;\n\n    return (\n        <>\n            <label className={`check-container ${className ? className : ''}` } htmlFor={name}>{labelText ? labelText : 'label'}\n                \n                <input\n                    \n                    type=\"checkbox\"\n\n                    className={`${className}`}\n                    \n                    id={id ? id : name}\n\n                    name={name}\n\n                    {...rest}\n\n                />\n\n                <span className={`checkmark`}></span>\n\n            </label>\n\n        </>\n    )\n}\n\nCheckBox.propTypes = {\n    className: PropTypes.string,\n    id: PropTypes.string,\n    name: PropTypes.string.isRequired,\n    labelText: PropTypes.string.isRequired,\n}\n\n\nexport default CheckBox;","import PropTypes from 'prop-types';\n\nfunction SubmitButton(props) {\n    \n    let { className, value, ...rest } = props;\n\n    return (\n        <input \n            type=\"submit\" \n\n            className={`${className ? className : 'default-button'}`} \n\n            value={value ? value : 'Submit'} \n\n            {...rest}\n\n        />\n    )\n}\n\nSubmitButton.propTypes = {\n    className: PropTypes.string,\n    value: PropTypes.string\n}\n\nexport default SubmitButton;","\n\n const filterTags = {\n    abandonedTags: 'abandoned, ruins, ghost',\n    architectureTags: 'architecture',\n    astroTags: 'astrophotography, stars, moon',\n    landscapeTags: 'landscape, mountains, outdoors',\n    sunriseTags: 'sunrise',\n    sunsetTags: 'sunset',\n    transportTags: 'transport, train, bus, boat, airplane, airport, transit',\n    peopleTags: 'people, portrait',\n    urbanTags: 'urban, cityscape, skyline, city',\n    waterTags: 'water, lake, river, ocean, waterfall, pond, reservoir, esplanade, sea',\n    natureTags: 'trees, flower, nature, foliage, leaves, grass, animals, forest, garden, park',\n    streetArtTags: 'graffiti, mural, sreet art'\n}\n\nexport default  filterTags;","import React from 'react';\nimport CheckBox from './CheckBox';\nimport SubmitButton from './SubmitButton';\nimport filterTags from '../../utils/filterTags'\n\n\nclass SubjectFilters extends React.Component {\n\n    state = {\n        open: false,\n        filters: {\n            abandoned: false,\n            architecture: false,\n            astro: false,\n            landscape: false,\n            sunrise: false,\n            sunset: false,\n            transport: false,\n            people: false,\n            urban: false,\n            water: false,\n            nature: false,\n            streetArt: false\n        },\n        formChanged: false,\n        previousFilters: []\n    }\n\n\n    componentDidUpdate(prevProps) {\n\n        if (this.props.resetFilters !== prevProps.resetFilters) {\n\n            if (this.props.resetFilters) {\n                this.setState(\n                    {\n                        filters:\n                        {\n                            abandoned: false,\n                            architecture: false,\n                            astro: false,\n                            landscape: false,\n                            sunrise: false,\n                            sunset: false,\n                            transport: false,\n                            people: false,\n                            urban: false,\n                            water: false,\n                            nature: false,\n                            streetArt: false\n                        }\n                    })\n            }\n\n        }\n\n\n    }\n\n\n    toggleDropdown() {\n        this.setState({ open: !this.state.open })\n    }\n\n    closeDropdown() {\n\n        if (this.state.formChanged && this.state.previousFilters) {\n            this.setState({ filters: this.state.previousFilters })\n        }\n        this.setState({ open: false, formChanged: false })\n\n    }\n\n    sendData(e) {\n        e.preventDefault();\n\n        let {\n            abandoned,\n            architecture,\n            astro,\n            landscape,\n            sunrise,\n            sunset,\n            transport,\n            people,\n            urban,\n            water,\n            nature,\n            streetArt\n        } = this.state.filters;\n\n\n        let abandonedTags = abandoned ? filterTags.abandonedTags : false;\n        let architectureTags = architecture ? filterTags.architectureTags : false;\n        let astroTags = astro ? filterTags.astroTags : false;\n        let landscapeTags = landscape ? filterTags.landscapeTags : false;\n        let sunriseTags = sunrise ? filterTags.sunriseTags : false;\n        let sunsetTags = sunset ? filterTags.sunsetTags : false;\n        let transportTags = transport ? filterTags.transportTags : false;\n        let peopleTags = people ? filterTags.peopleTags : false;\n        let urbanTags = urban ? filterTags.urbanTags : false;\n        let waterTags = water ? filterTags.urbanTags : false;\n        let natureTags = nature ? filterTags.natureTags : false;\n        let streetArtTags = streetArt ? filterTags.streetArtTags : false;\n\n        let filterString = '';\n        let allFilterTags = [\n            abandonedTags,\n            architectureTags,\n            astroTags,\n            landscapeTags,\n            sunriseTags,\n            sunsetTags,\n            transportTags,\n            peopleTags,\n            urbanTags,\n            waterTags,\n            natureTags,\n            streetArtTags\n        ];\n\n        let activeFilters = [];\n\n        allFilterTags.forEach(\n            filter => {\n                if (filter) {\n                    activeFilters.push(filter)\n                }\n            }\n        )\n\n\n        activeFilters.forEach(\n            (filter, index) => {\n                if (index === 0) {\n                    filterString = filterString.concat(filter)\n                } else {\n                    filterString = filterString.concat(`, ${filter}`)\n                }\n            }\n        )\n\n        this.setState({ open: !this.state.open, formChanged: false, previousFilters: this.state.filters })\n\n\n\n\n        return this.props.handleSubmit(filterString)\n    }\n\n\n    handleChange(e) {\n\n        let filter = e.target.name;\n\n        switch (filter) {\n            case 'abandoned':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        abandoned: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'architecture':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        architecture: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'astro':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        astro: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'landscape':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        landscape: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'sunrise':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        sunrise: e.target.checked      // update the value of specific key\n                    }\n                }))\n                break;\n            case 'sunset':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        sunset: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'transport':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        transport: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'people':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        people: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'urban':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        urban: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'water':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        water: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'nature':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        nature: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            case 'street-art':\n                this.setState(prevState => ({\n                    filters: {                   // object that we want to update\n                        ...prevState.filters,    // keep all other key-value pairs\n                        streetArt: e.target.checked      // update the value of specific key\n                    }\n                }));\n                break;\n            default:\n                console.log('filter does not exist')\n        }\n    }\n\n    render() {\n        let {\n            open\n        } = this.state;\n\n        let {\n            abandoned,\n            architecture,\n            astro,\n            landscape,\n            sunrise,\n            sunset,\n            transport,\n            people,\n            urban,\n            water,\n            nature,\n            streetArt\n        } = this.state.filters;\n\n        return (\n            <span className={`search-filter-container ${open ? 'open' : 'closed'}`} >\n                <button className={`search-filter`} onClick={(e) => { this.toggleDropdown() }}>\n                    Filter by Subject\n                </button>\n                <div className={`search-filter-dropdown`}>\n                    <button className={`close-button`} onClick={() => this.closeDropdown()}>Close</button>\n                    <form onChange={() => { this.setState({ formChanged: true }) }}>\n                        <CheckBox name=\"abandoned\" checked={abandoned} labelText=\"Abandoned\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"architecture\" checked={architecture} labelText=\"Architecture\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"astro\" checked={astro} labelText=\"Astrophotography\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"landscape\" checked={landscape} labelText=\"Landscape\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"nature\" checked={nature} labelText=\"Nature\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"street-art\" checked={streetArt} labelText=\"Street Art\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"sunrise\" checked={sunrise} labelText=\"Sunrise\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"sunset\" checked={sunset} labelText=\"Sunset\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"transport\" checked={transport} labelText=\"Transport\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"people\" checked={people} labelText=\"People\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"urban\" checked={urban} labelText=\"Urban\" onChange={(e) => { this.handleChange(e) }} />\n                        <CheckBox name=\"water\" checked={water} labelText=\"Water\" onChange={(e) => { this.handleChange(e) }} />\n                        \n                        \n\n                        <SubmitButton onClick={(e) => { this.sendData(e) }} value=\"Apply Filters\" />\n                    </form>\n                </div>\n            </span>\n        )\n    }\n}\n\nexport default SubjectFilters;","import React from 'react';\n\nimport SearchBar from '../../components/forms/SearchBar';\nimport MapWithCards from '../../components/layout/MapWithCards';\n\nimport getFlickrPhotos from '../../utils/flickr/getFlickrPhotos';\nimport getFlickrPlace from '../../utils/flickr/getFlickrPlace';\nimport getCurrentLocation from '../../utils/getCurrentLocation';\nimport ResultsList from '../../components/content/ResultsList';\nimport getGeoSuggestions from '../../utils/getGeoSuggestions'\nimport SubjectFilters from '../../components/forms/SubjectFilters';\n\nclass SearchResults extends React.Component {\n    state = {\n        query: '',\n        loaded: false,\n        searchResults: [],\n        mapLat: null,\n        mapLon: null,\n        mapZoom: 10\n    }\n\n    _isMounted = false;\n\n    getSearchResults = (lat, lon, tags) => {\n        \n\n        let searchLat = lat;\n\n        let searchLon = lon;\n\n        let options = {\n            \"lat\": searchLat,\n            \"lon\": searchLon,\n            \"extras\": \"geo, tags, url_n\",\n            \"accuracy\": 6\n        }\n\n        console.log(options)\n\n        if (tags) {\n            options.tags = tags\n        }\n\n        //create a list of locations\n        let existingLocations = [];\n\n        let list = [];\n\n\n        //get from firebase\n        //in firebase I need to store the photo.id and the photo.woeid\n\n\n        //get from Flickr\n\n        getFlickrPhotos(options).then(data => {\n\n            let photos; \n\n            if (data) {\n                photos = data.photos\n            }\n\n\n            if (!photos) {\n                return this.setState({ loaded: true })\n            }\n\n            else {\n\n                photos = photos.photo\n\n\n                photos.forEach(\n\n                    photo => {\n\n                        let url = photo.url_n\n\n                        let title = photo.title;\n\n                        let lat = photo.latitude;\n\n                        let lon = photo.longitude;\n\n                        let woeId = photo.woeid;\n\n                        let locationId = photo.id;\n\n                        let tags = photo.tags;\n\n\n                        // prevent duplicate locations, and locations with no tags\n                        if (woeId && !existingLocations.includes(woeId) && tags ) {\n\n                            \n                            //add photo locations to existing list\n                            existingLocations.push(woeId);\n\n                            let location = {\n                                \"src\": \"flickr\", //added,\n                                \"locationId\": locationId,\n                                \"woeId\" : woeId,\n                                \"thumbnail\": url,\n                                \"title\": title,\n                                \"destination\": {\n                                    \"latitude\": parseFloat(lat),\n                                    \"longitude\": parseFloat(lon)\n                                }\n                            }\n\n    \n                            let place = async (options) => {\n                                let placeName = await getFlickrPlace(options);\n                                return placeName\n                            }\n\n                            place({ \"woeId\": woeId }).then(placeName => {\n\n                                if (placeName) {\n                                    location.title = placeName\n                                }\n\n                            }).then(\n\n                                list.push(location)\n\n                            )\n                        }\n                    }\n                )\n\n                this.setState({\n                    searchResults: list,\n                    loaded: true,\n                    mapLat: parseFloat(searchLat),\n                    mapLon: parseFloat(searchLon),\n                    mapZoom: 10,\n                    resetFilters: false\n                })\n\n            }\n\n        }\n\n        )\n\n    }\n\n    handleInput(e) {\n        this.setState(\n\n            { query: e.target.value },\n\n            () => {\n\n                if (!this.state.query) {\n                    this.setState({ searchBarSuggestions: '' })\n                }\n                else {\n                    getGeoSuggestions(this.state.query).then(results => this.setState({ searchBarSuggestions: results }))\n                }\n\n            })\n\n    }\n\n    handleSubmit(e) {\n\n        e.preventDefault();\n\n        this.setState({ searchResults: [], loaded: false, needLocation: false, resetFilters: true });\n\n        if (!this.state.searchBarSuggestions && !this.state.query) {\n            this.setState({ loaded: true, mapZoom: 1.5, resetFilters: false })\n        } else {\n\n            this.setState({ resetFilters: true });\n\n            let suggestion;\n\n            if (this.state.searchBarSuggestions) {\n                suggestion = this.state.searchBarSuggestions[0];\n            } else {\n                suggestion = {\n                    \"label\": this.state.query,\n                    \"y\": this.state.mapLat,\n                    \"x\": this.state.mapLon\n                }\n            }\n\n\n            this.setState({ query: suggestion.label, searchBarSuggestions: '' });\n\n            let address = suggestion.label;\n\n            let lat = suggestion.y;\n\n            let lon = suggestion.x;\n\n            let search = `address=${address}&lat=${lat}&lon=${lon}`\n\n            this.props.history.push(`/explore/?q=&${search}`)\n            this.getSearchResults(lat, lon)\n        }\n\n\n\n    }\n\n    findNearby() {\n        this.setState({ searchResults: [], loaded: false, query: 'Current Location' });\n        this.props.history.push(`/explore/`)\n\n        getCurrentLocation(\n            (position) =>\n\n                this.setState({ currentLocation: position.coords },\n                    () => {\n                        let lat = this.state.currentLocation.latitude;\n                        let lon = this.state.currentLocation.longitude;\n\n                        this.getSearchResults(lat, lon)\n                    }),\n\n            () => this.setState({ loaded: true, needLocation: true, mapZoom: 1.5 })\n        )\n    }\n\n    suggestionClick(suggestion) {\n\n        this.setState({\n            searchResults: [],\n            loaded: false,\n            needLocation: false,\n            query: suggestion.label,\n            searchBarSuggestions: '',\n            resetFilters: true\n        });\n\n\n        let search = `address=${suggestion.label}&lat=${suggestion.lat}&lon=${suggestion.lon}`\n\n        this.props.history.push(`/explore/?q=&${search}`)\n\n        if (!suggestion.lat || !suggestion.lon) {\n            this.setState({ loaded: true, mapZoom: 1.5, resetFilters: false })\n        } else {\n            let lat = suggestion.lat;\n            let lon = suggestion.lon;\n            this.getSearchResults(lat, lon)\n        }\n\n    }\n\n    handleFilters(data) {\n\n        this.setState({ searchResults: [], loaded: false, needLocation: false });\n\n        if (!this.state.searchBarSuggestions && !this.state.query) {\n            this.setState({ loaded: true, mapZoom: 1.5 })\n        } else {\n\n            let suggestion = {\n                \"label\": this.state.query,\n                \"y\": this.state.mapLat,\n                \"x\": this.state.mapLon\n            }\n\n\n            let address = suggestion.label;\n\n            let lat = suggestion.y;\n\n            let lon = suggestion.x;\n\n            let search = `address=${address}&lat=${lat}&lon=${lon}`\n\n            this.props.history.push(`/explore/?q=&${search}`)\n            this.getSearchResults(lat, lon, data)\n        }\n    }\n\n    componentDidMount() {\n        let query = decodeURIComponent(this.props.location.search);\n\n        let searchParams = new URLSearchParams(query);\n\n        this._isMounted = true\n\n        if (!searchParams.has(\"lon\") || !searchParams.has(\"lat\")) {\n\n            this._isMounted && this.setState({ loaded: true, mapZoom: 1.5 })\n\n        } else {\n            let address = searchParams.get(\"address\");\n\n            let lat = searchParams.get(\"lat\");\n\n            let lon = searchParams.get(\"lon\");\n\n            this._isMounted && this.setState({ query: address });\n\n            this.getSearchResults(lat, lon)\n        }\n    }\n\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n\n\n    render() {\n\n        let { query, searchResults, loaded, mapLat, mapLon, mapZoom, needLocation, searchBarSuggestions } = this.state;\n\n        return (\n            <div className={`search`}>\n\n                <div className={`dark-background`}>\n                    <div className={`container mobile-padding header-container`}>\n                        <SearchBar\n                            labelText=\"Location\"\n                            backSearch\n                            placeholder=\"Search a place\"\n                            value={query}\n                            onChange={(e) => { this.handleInput(e) }}\n                            onClick={(e) => this.handleSubmit(e)}\n                            searchSuggestions={searchBarSuggestions}\n                            handleSuggestion={(suggestion) => { this.suggestionClick(suggestion) }}\n                        />\n                        <SubjectFilters handleSubmit={(data) => this.handleFilters(data)} resetFilters={this.state.resetFilters} />\n                        <button className={`search-filter`} onClick={() => { this.findNearby() }}>Spots Near Me</button>\n                    </div>\n                </div>\n\n                <div className={`container`}>\n\n                    <MapWithCards\n                        mapLoctaions={searchResults}\n                        mapLat={mapLat}\n                        mapLon={mapLon}\n                        mapZoom={mapZoom}\n\n                    >\n                        <ResultsList loaded={loaded} list={searchResults} needLocation={needLocation} />\n\n                    </MapWithCards>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default SearchResults;","import PropTypes from 'prop-types'\n\nfunction Modal({ modalId, modalTitle, modalDescription, isOpen, handleClose, children } ) {\n\n    let modalTitleId = `${modalId}-title`\n\n    function closeModal() {\n        handleClose(); //this should set props.isOpen to false on the parent\n    }\n\n    return (\n        <>\n            <div\n                className={`${isOpen ? 'open' : 'closed'} modal-overlay`}\n\n                onClick={() => closeModal()}\n\n                tabIndex=\"-1\">\n            </div>\n            <div id={modalId} className={`${isOpen ? 'open' : 'closed'} modal-wrapper ${modalId}`}>\n\n                <div className=\"modal-body\" role=\"dialog\" aria-modal=\"true\" aria-labelledby={`${modalTitleId}`}>\n\n                    <button className={`close-button`} onClick={() => closeModal()}>Close</button>\n\n                    <div aria-live=\"polite\" className=\"modal-header\">\n                        <h2 id={`${modalTitleId}`}>\n                            {modalTitle}\n                        </h2>\n                        <h3>{modalDescription}</h3>\n                    </div>\n\n                    <div className=\"modal-main\">\n                        {children}\n                    </div>\n                </div>\n\n            </div>\n        </>\n    )\n}\n\nModal.propTypes = {\n    modalId: PropTypes.string, \n    modalTitle: PropTypes.string, \n    modalDescription: PropTypes.string,\n    isOpen: PropTypes.bool,\n    handleClose: PropTypes.func.isRequired,\n    initiallyOpen: PropTypes.bool\n}\n\nexport default Modal;","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport firebase from '../../utils/firebase/firebaseConfig'\n\nimport Modal from './Modal'\n\n\nclass ResetPasswordModal extends React.Component {\n    state = {\n        error: '',\n        successReset: false\n    }\n\n    _isMounted = false;\n\n    closeModal() {\n        this.props.handleClose(this.state.successReset)\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n\n    resetPassword(e) {\n        e.preventDefault();\n        console.log('clicked')\n        let auth = firebase.auth();\n\n        let emailAddress = this.props.email;\n\n        let form = this;\n\n        form.setState({ error: '' })\n\n\n        let actionCodeSettings = { url: `https://photoatlasapp.com/` }\n\n\n        this._isMounted && auth.sendPasswordResetEmail(emailAddress, actionCodeSettings)\n            .then(() => {\n                form.setState({ successReset: true })\n\n            }\n            ).catch(function (error) {\n                form.setState({\n                    error: error.message,\n                    successReset: false\n                })\n            });\n    }\n\n    render() {\n\n        return (\n            <Modal\n                modalId='reset-password-modal'\n                modalTitle={\"Reset Password\"}\n                isOpen={this.props.isOpen}\n                handleClose={() => this.closeModal()}\n            >\n\n                <div className=\"modal-content-padding center-text\">\n\n                    {!this.state.error && !this.state.successReset &&\n                        <>\n                            <h3 className=\"h5-font\">Are you sure you want to reset your password?</h3>\n                            <ul className=\"button-group\">\n                                <li><button onClick={(e) => this.resetPassword(e)} className=\"default-button\">Reset Password</button></li>\n                                <li><button onClick={() => this.closeModal()} className=\"button-link\">Cancel</button></li>\n                            </ul>\n                        </>\n                    }\n                    {this.state.error &&\n                        <p className=\"error-font\" aria-live=\"polite\">\n                            {this.state.error}\n                        </p>\n                    }\n                    {this.state.successReset &&\n                        <div aria-live=\"polite\">\n                           <h3 className=\"h5-font\">Check your email to reset your password.</h3> \n                        </div>}\n\n                </div>\n\n            </Modal>\n        )\n    }\n}\n\nResetPasswordModal.propTypes = {\n    email: PropTypes.string,\n    handleClose: PropTypes.func.isRequired,\n    logInLocation: PropTypes.string.isRequired,\n    isOpen: PropTypes.bool.isRequired\n}\n\nexport default ResetPasswordModal;","import PropTypes from 'prop-types';\n\nfunction TextInput(props) {\n\n    let { className, ...rest } = props;\n\n    return <input type=\"text\" className={`text-bar ${className ? className : ''}`} {...rest} />\n    \n}\n\nTextInput.propTypes = {\n    className: PropTypes.string\n}\n\nexport default TextInput;","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport firebase from '../../utils/firebase/firebaseConfig'\nimport TextInput from '../forms/TextInput'\nimport Modal from './Modal'\n\n\nclass ChangeDisplayNameModal extends React.Component {\n    state = {\n        error: '',\n        newName: '',\n        nameUpdated: false,\n        loading: false\n    }\n\n    closeModal() {\n        this.setState({\n            confirmReset: false,\n            nameUpdated: false\n        }, () => this.props.handleClose());\n    }\n\n    handleInput(e) {\n        this.setState({ newName: e.target.value, nameUpdated: true })\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n\n    // updateUser() {\n    //     if (this._isMounted) {\n\n    //         let user = firebase.auth().currentUser;\n\n    //         if (user) {\n    //             this.setState({\n    //                 currentName: user.displayName\n    //             })\n    //         }\n    //     }\n    // }\n\n\n\n    changeDisplayName(e) {\n        e.preventDefault();\n        let form = this;\n\n        form.setState({ error: '', loading: true })\n\n        let user = firebase.auth().currentUser;\n\n        let newName = this.state.newName;\n\n\n        //check that name and lastname does not include special characters, except for hypens\n        let testString = /^[a-zA-Z][ a-zA-Z \\-' -]+$/;\n\n\n        if (!testString.test(newName)) {\n            form.setState({ error: \"Display can only contain letters, apostrophes, hypens and spaces.\" })\n        } else {\n                let database = firebase.database();\n\n                let userId = user.uid\n                \n\n                database.ref(`users/${userId}`).update({\n                    displayName: newName\n                }\n                   \n                ).catch((error) => {\n                    console.log(error)\n                })\n           // })\n            .then(function () {\n                // Update successful.\n                form.props.triggerUpdate();\n                form.props.handleClose()\n                form.setState({loading: false})\n            }).catch(function (error) {\n                // An error happened.\n                form.setState({error: error.message, loading: false})\n            });\n\n        }\n\n    }\n\n    render() {\n\n        return (\n            <Modal\n                modalId='reset-password-modal'\n                modalTitle={\"Change Display Name\"}\n                isOpen={this.props.isOpen}\n                handleClose={() => this.closeModal()}\n            >\n\n                <div className=\"modal-content-padding\">\n\n\n                    {this.state.error &&\n                        <p className=\"error-font\" aria-live=\"polite\">\n                            {this.state.error}\n                        </p>\n                    }\n                    <label htmlFor=\"new-name\">New Name</label>\n                    <TextInput id=\"new-name\" value={this.state.nameUpdated ? this.state.newName : this.props.currentName} onChange={(e) => this.handleInput(e)} />\n\n\n                    <div aria-live=\"polite\">\n                        <button onClick={(e) => this.changeDisplayName(e)} className=\"default-button\">\n                            {this.state.loading ? 'Changing Name' : 'Change Display Name'}\n                        </button>\n                    </div>\n                </div>\n\n            </Modal>\n        )\n    }\n}\n\nChangeDisplayNameModal.propTypes = {\n    handleClose: PropTypes.func.isRequired,\n    triggerUpdate: PropTypes.func.isRequired,\n    isOpen: PropTypes.bool.isRequired,\n    currentName: PropTypes.string\n}\n\nexport default ChangeDisplayNameModal;","\nimport React from 'react'\nimport firebase from '../utils/firebase/firebaseConfig'\nimport ResetPasswordModal from '../components/modals/ResetPasswordModal'\nimport ChangeDisplayNameModal from '../components/modals/ChangeDisplayName'\n\n\nclass Account extends React.Component {\n\n    state = {\n        displayName: '',\n        email: '',\n        successReset: false,\n        resetPassword: false,\n        changeName: false\n    }\n\n\n    _isMounted = false;\n\n\n\n    componentDidMount() {\n        this._isMounted = true;\n        this.updateUser();\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n    openPasswordModal() {\n        this.setState({ resetPassword: true })\n    }\n\n    closePasswordModal(reseted) {\n        this.setState({ resetPassword: false })\n\n        if(reseted) {\n            firebase.auth().signOut()\n        }\n    }\n\n    openDisplayNameModal() {\n        this.setState({ changeName: true })\n    }\n\n    closeDisplayNameModal() {\n        this.setState({ changeName: false })\n    }\n\n    updateUser() {\n\n        let component = this;\n\n        if (this._isMounted) {\n\n            let user = firebase.auth().currentUser;\n            let userId = user.uid;\n\n            if (userId) {\n                let database = firebase.database();\n\n\n                database.ref(`users/${userId}`).get().then(function (snapshot) {\n                    if (snapshot.exists()) {\n\n                        let displayName = snapshot.val().displayName;\n                        let email = user.email;\n\n\n\n                        component.setState({\n                            displayName: displayName,\n                            email: email\n                        })\n                    }\n                    else {\n                        console.log(\"No data available\");\n                    }\n                }).catch(function (error) {\n                    console.error(error);\n                });\n\n\n\n            }\n        }\n    }\n\n    render() {\n\n        return (\n            <>\n                <div className={`container trips mobile-padding`}>\n                    <h2>Account Settings</h2>\n                    <ul className=\"settings-list\">\n                        <li aria-live=\"polite\">\n                            Display Name: {this.state.displayName}\n                            <button onClick={() => this.openDisplayNameModal()} className=\"secondary-button\">Change Display Name</button>\n                        </li>\n                        <li>\n                            <p>Email: {this.state.email}</p>\n                        </li>\n                        <li>\n                            Password: **** <button onClick={() => this.openPasswordModal()} className=\"secondary-button\">Reset Password</button>\n                        </li>\n                    </ul>\n\n                    <button className=\"button-link\"\n                        onClick={\n                            () => {\n                                firebase.auth().signOut()\n                            }\n                        }>Sign Out</button>\n                </div>\n                <ResetPasswordModal\n                    email={this.state.email}\n                    handleClose={(reseted) => this.closePasswordModal(reseted)}\n                    logInLocation=\"account\"\n                    isOpen={this.state.resetPassword}\n                />\n\n                <ChangeDisplayNameModal\n                    handleClose={() => this.closeDisplayNameModal()}\n                    currentName={this.state.displayName}\n                    isOpen={this.state.changeName}\n                    triggerUpdate={() => this.updateUser()}\n                />\n\n            </>\n        )\n\n    }\n}\n\nexport default Account;","import firebase from './firebase/firebaseConfig'\n\nlet getPublicTrips = (callback) => {\n   \n    let database = firebase.database();\n    let existingTrips = [];\n\n    database.ref(`publicTrips`).get().then((snapshot) => { \n\n        let trips = snapshot.val();\n\n\n        for (const tripId in trips) {\n     \n                    //get title\n                    let title = trips[tripId]['tripName']\n\n                    //get locationsCount\n                    let locationsCount = trips[tripId]['locationsCount']\n\n                    //get thumnail\n                    let thumbnail = trips[tripId]['featuredImg']\n\n                    //get authorId\n                    let authorId = trips[tripId]['author']\n\n                    //get tags\n                    let tags = trips[tripId]['tags']\n\n                    let existingTripUpdate = {\n                        tripId: tripId,\n                        thumbnail: thumbnail,\n                        title: title,\n                        locationsCount: locationsCount,\n                        privacy: 'public',\n                        authorId: authorId,\n                        tags: tags ? tags : ''\n                    }\n\n                existingTrips.push(existingTripUpdate)\n        }\n\n        return existingTrips\n    }).catch(error => console.log(error)).then((existingTrips) => callback(existingTrips))\n}\n\nexport default getPublicTrips;","function OneToTwoCols(props) {\n\n    return (\n        <div className={`grid-1_2`}>\n            {props.children}\n        </div>\n    )\n\n}\n\nexport default OneToTwoCols;","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { Link } from 'react-router-dom'\nimport firebase from '../../utils/firebase/firebaseConfig'\n\n\nclass TripCard extends React.Component{\n    \n    state = {\n        authorName: ''\n    }\n    _isMounted = false;\n\n    getAuthor = (authorId) =>{\n        let database = firebase.database()\n        database.ref(`users/${authorId}/displayName`).get().catch(error=>console.log(error)).then(\n           snapshot => {\n               if(snapshot){\n                   let authorName = snapshot.val()\n                   this._isMounted && this.setState({authorName: authorName})\n               }\n           }\n        )\n    }\n\n    componentDidMount() {\n        this._isMounted = true\n        this.getAuthor(this.props.authorId)\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false\n    }\n    \n    \n    render() {\n\n        let {\n            thumbnail,\n            title,\n            tripId,\n            privacy,\n            locationsCount } = this.props;\n\n    \n        return (\n            <Link className={`trip-card`} to={ `/trip/${tripId}?privacy=${privacy}`}>\n    \n                <div className={`trip-card-image`}>\n                    <img src={thumbnail} alt=\"\" />\n                </div>\n                <div className={`trip-card-content`}>\n                    <h3 className={`title`}>{title}</h3>\n                    <p className={`meta-data`}>by {this.state.authorName}</p>\n                    <p className={`meta-data ${privacy}`}>\n                        {privacy}</p> \n                    <p className={`meta-data marker`}>\n                       {locationsCount} {(locationsCount > 1 || locationsCount < 1) ? 'Locations' : 'Location'}</p>\n                </div>\n    \n            </Link>\n        )\n    \n\n    }\n}\n\nTripCard.propTypes = {\n    thumbnail: PropTypes.string,\n    title: PropTypes.string,\n    isPublic: PropTypes.bool,\n    locationCount: PropTypes.number,\n    tripId: PropTypes.string,\n    authorId: PropTypes.string,\n    isShared: PropTypes.bool\n}\n\n\nexport default TripCard;","import OneToTwoCols from '../layout/OneToTwoCols'\nimport TripCard from '../cards/TripCard'\n\n\nfunction UnfilteredTrips({existingTrips}) {\n    return (<>\n        <div aria-live=\"polite\" className=\"sr-only\">\n            <p>Showing trips</p>\n        </div>\n        <OneToTwoCols>\n            {existingTrips.map((trip, index) => {\n                let {\n                    thumbnail,\n                    title,\n                    locationsCount,\n                    privacy,\n                    tripId,\n                    authorId } = trip;\n\n                return (\n                    <TripCard\n                        key={index}\n                        thumbnail={thumbnail}\n                        title={title}\n                        tripId={tripId}\n                        privacy={privacy}\n                        locationsCount={locationsCount}\n                        authorId={authorId}\n                    />\n                )\n            })}\n        </OneToTwoCols>\n    </>)\n}\n\nexport default UnfilteredTrips;","import OneToTwoCols from '../layout/OneToTwoCols'\nimport TripCard from '../cards/TripCard'\n\nfunction FilteredTrips({loading, searchResults}) {\n   \n    while (loading) {\n        return (\n            <div aria-live=\"polite\">\n                <p>Getting trips...</p>\n            </div>\n        )\n    }\n\n    if (searchResults.length > 0) {\n        return (\n            <>\n                <div aria-live=\"polite\" className=\"sr-only\">\n                    <p>Showing search results</p>\n                </div>\n                <OneToTwoCols>\n                    {searchResults.map((trip, index) => {\n                        let {\n                            thumbnail,\n                            title,\n                            locationsCount,\n                            privacy,\n                            tripId,\n                            authorId } = trip;\n\n                        return (\n                            <TripCard\n                                key={index}\n                                thumbnail={thumbnail}\n                                title={title}\n                                tripId={tripId}\n                                privacy={privacy}\n                                locationsCount={locationsCount}\n                                authorId={authorId}\n                            />\n                        )\n                    })}\n                </OneToTwoCols>\n            </>\n        )\n    } else {\n        return <p>Sorry, no trips match your search criteria.</p>\n    }\n}\n\nexport default FilteredTrips;","import React from 'react'\nimport getPublicTrips from '../../utils/getPublicTrips'\nimport SearchBar from '../../components/forms/SearchBar'\nimport UnfilteredTrips from '../../components/content/UnfilteredTrips'\nimport FilteredTrips from '../../components/content/FilteredTrips'\n\nclass PublicTrips extends React.Component {\n    state = {\n        existingTrips: [],\n        loading: true,\n        searching: false,\n        loadingSearchResults: false,\n        searchResults: [],\n        searchTerms: ''\n    }\n\n    _isMounted = false;\n\n    componentDidMount() {\n        this._isMounted = true;\n        getPublicTrips((tripsList) => {\n            this._isMounted && this.setState({ existingTrips: tripsList, loading: false })\n        })\n    }\n\n    handleSearchInput(e) {\n        this.setState({ searchTerms: e.target.value }, () => {\n            if (!this.state.searchTerms) {\n                this.setState({ searching: false })\n            }\n        })\n    }\n\n    getSearchResults(e) {\n        e.preventDefault();\n\n        //use search terms to create searcResults array\n        let existingTrips = this.state.existingTrips;\n        let results = []\n        let searchTerms = this.state.searchTerms.toLowerCase();\n        \n        this.setState({ searching: true, loadingSearchResults: true })\n\n        existingTrips.forEach(trip => {\n            let title = trip.title.toLowerCase()\n            let tags = trip.tags.toLowerCase()\n\n            let titleMatch = title.includes(searchTerms)\n            let tagsMatch = tags.includes(searchTerms)\n\n            if (titleMatch || tagsMatch) {\n\n                results.push(trip)\n\n            }\n        }\n\n        )\n\n        this.setState({ loadingSearchResults: false, searchResults: results })\n\n    }\n\n    tripsList(existingTrips) {\n        let {searching, loadingSearchResults, searchResults} = this.state;\n        if (!searching) {\n            return <UnfilteredTrips existingTrips={existingTrips}/>\n        } else {\n            return <FilteredTrips loading={loadingSearchResults} searchResults={searchResults}/>\n        }\n    }\n\n    renderPublicTrips() {\n        let { existingTrips, loading } = this.state;\n\n        while (loading) {\n            return (\n                <div aria-live=\"polite\">\n                    <p>Getting trips...</p>\n                </div>\n            )\n        }\n        if (existingTrips.length > 0) {\n            return (\n                <>\n                    <SearchBar\n                        className=\"border-search\"\n                        id=\"trips-search\"\n                        placeholder=\"cityscapes\"\n                        labelText=\"Search trips by tags or title\"\n                        value={this.state.searchTerms}\n                        onChange={(e) => this.handleSearchInput(e)}\n                        onClick={(e) => this.getSearchResults(e)}\n                    />\n                    {this.tripsList(existingTrips)}\n                </>\n            )\n        } else {\n            return (\n                <div aria-live=\"polite\">\n                    <p>No trips here yet.</p>\n                </div>\n            )\n        }\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n    render() {\n        return (\n            <>\n                {this.renderPublicTrips()}\n            </>\n        )\n    }\n\n}\n\n\n\nexport default PublicTrips;","import PropTypes from 'prop-types';\n\nfunction EmailInput(props) {\n\n    let { className, ...rest} = props;\n\n    return <input type=\"email\" className={`text-bar ${className ? className : ''}`} {...rest} />\n}\n\nEmailInput.propTypes = {\n    className: PropTypes.string\n}\n\nexport default EmailInput;","import PropTypes from 'prop-types';\nimport React from 'react'\nimport CheckBox from './CheckBox'\n\n\nclass PasswordInput extends React.Component {\n    state = {\n        type: \"password\"\n    }\n\n    changeType() {\n        if (this.state.type === \"password\") {\n            this.setState(\n                { type: \"text\" }\n            )\n        }\n        else {\n            this.setState(\n                { type: \"password\" }\n            )\n\n        }\n    }\n\n    render() {\n\n        let { className, checkName, ...rest } = this.props;\n\n\n        return (\n            <>\n                <input type={this.state.type} \n                    className={`text-bar ${className ? className : ''}`} \n                    {...rest} \n                  /><br/>\n                \n\n            <CheckBox className=\"show-pass\" name={checkName ?  checkName : 'show-pass'} onChange={() => { this.changeType()}} labelText=\"Show password\" />\n\n            </>\n        )\n    }\n\n}\n\nPasswordInput.propTypes = {\n    className: PropTypes.string\n}\n\n\nexport default PasswordInput;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport EmailInput from '../../components/forms/EmailInput'\nimport PasswordInput from '../../components/forms/PasswordInput'\nimport SubmitButton from '../../components/forms/SubmitButton'\nimport firebase from '../../utils/firebase/firebaseConfig'\n\n\n\nclass SignIn extends React.Component {\n\n  state = {\n    email: '',\n    emailError: '',\n    successReset: false,\n    forgotPassword: false\n  }\n\n  handleEmailInput(e) {\n    this.setState({ email: e.target.value })\n  }\n\n  togglePasswordReset(e) {\n    e.preventDefault();\n    this.setState({forgotPassword: !this.state.forgotPassword})\n  }\n\n  resetPassword(e) {\n    e.preventDefault();\n\n    let auth = firebase.auth();\n\n    let emailAddress = this.state.email;\n\n    let form = this;\n\n    form.setState({emailError:''})\n\n    let actionCodeSettings = { url: `https://photoatlasapp.com/` }\n\n\n    auth.sendPasswordResetEmail(emailAddress, actionCodeSettings).then(() => {\n        form.setState({successReset: true, forgotPassword: false, email: ''})\n    } \n    ).catch(function (error) {\n        form.setState({\n          emailError: error.message, \n          forgotPassword: true, \n          successReset: false\n        })\n    });\n  }\n\n\n  render() {\n    return (\n      <>\n        <div className={`container mobile-padding`}>\n          <div className={this.props.hideTitle ? \"hidden\" : \"visible\"}>\n            {this.props.tabContent ? <h3>Sign In</h3> : <h2>Sign In</h2>}\n\n            {this.props.tabContent ?\n              <h4 className=\"h5-font\">Sign in to {this.props.introtext}.</h4> :\n              <h3 className=\"h5-font\">Sign in to {this.props.introtext}.</h3>}\n          </div>\n\n    \n          <p className={`${this.state.successReset ? \"visible\" : \"hidden\"} success-font`} aria-live=\"polite\">Check your email to reset your password.</p> \n\n          <form className={this.state.forgotPassword? 'hidden' : 'visible'} action={\"/\"} onSubmit={(e) => this.props.handleSubmit(e)}>\n\n            <div className=\"form-component-wrapper\">\n              <label htmlFor=\"email\">Email</label>\n              <EmailInput autoComplete=\"username\"\n                id=\"email\"\n                value={this.props.email}\n                onChange={(e) => this.props.handleEmailInput(e)} required />\n              {this.props.emailError && <p className=\"error-font\" aria-live=\"polite\">{this.props.emailError}</p>}\n            </div>\n\n            <div className=\"form-component-wrapper\">\n              <label htmlFor=\"pass\">Password</label>\n              <PasswordInput autoComplete=\"current-password\"\n                id=\"pass\"\n                value={this.props.password}\n                onChange={(e) => this.props.handlePassInput(e)} required />\n              {this.props.passError && <p className=\"error-font\" aria-live=\"polite\">{this.props.passError}</p>}\n            </div>\n\n            <div className=\"form-component-wrapper\">\n              <SubmitButton value={`${this.props.loading ? 'Signing In...' : 'Sign In'}`} />\n            </div>\n\n          </form>\n\n          <div className={`${this.state.forgotPassword ? 'hidden' : 'visible'} form-component-wrapper`}>\n              <button\n                onClick={(e) => { this.togglePasswordReset(e) }}\n                className=\"secondary-button forgot-pass\">Forgot password?</button>\n            </div>\n\n          <form className={this.state.forgotPassword ? 'visible' : 'hidden'} action={\"/\"}  onSubmit={(e) => this.resetPassword(e)}>\n            <div className=\"form-component-wrapper\">\n              \n              <label htmlFor=\"password-reset-email\">Email</label>\n              \n              <EmailInput id=\"password-reset-email\"\n                value={this.state.email}\n\n                onChange={(e) => this.handleEmailInput(e)} required />\n              \n                {this.state.emailError && <p className=\"error-font\"\n                aria-live=\"polite\">\n                  {this.state.emailError}\n                  </p>}\n            </div>\n            \n            <div className=\"form-component-wrapper\">\n              <SubmitButton value=\"Reset Password\" />\n            </div>\n          </form>\n\n\n          <div className={`${this.state.forgotPassword ? 'visible' : 'hidden'} form-component-wrapper`}>\n            <button className=\"button-link\" onClick={(e) => { this.togglePasswordReset(e) }}>\n              Sign In\n              </button>\n          </div>\n\n\n        </div>\n      </>\n    )\n\n  }\n\n}\n\n\n\nSignIn.propTypes = {\n  introtext: PropTypes.string,\n  handleSubmit: PropTypes.func,\n  email: PropTypes.string,\n  handleEmailInput: PropTypes.func,\n  emailError: PropTypes.string,\n  password: PropTypes.string,\n  handlePassInput: PropTypes.func,\n  passError: PropTypes.string,\n  tabContent: PropTypes.bool,\n  hiddeTitle: PropTypes.bool,\n  logInLocation: PropTypes.string\n}\n\n\nexport default SignIn;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport EmailInput from '../../components/forms/EmailInput'\nimport TextInput from '../../components/forms/TextInput'\nimport PasswordInput from '../../components/forms/PasswordInput'\nimport SubmitButton from '../../components/forms/SubmitButton'\n\n\n\nfunction SignUp(props) {\n\n  return (\n    <>\n      <div className={`container mobile-padding`}>\n        <div className={props.hideTitle ? \"hidden\" : \"visible\"}>\n          {props.tabContent ? <h3>Sign Up</h3> : <h2>Sign Up</h2>}\n\n          {props.tabContent ?\n            <h4 className=\"h5-font\">Create an account to {props.introtext}.</h4> :\n            <h3 className=\"h5-font\">Create an account to {props.introtext}.</h3>}\n        </div>\n        <form action={\"/\"} onSubmit={(e) => props.handleSubmit(e)}>\n\n\n\n          <div className=\"form-component-wrapper\">\n            <label htmlFor=\"firstname\">Name</label>\n            <TextInput autoComplete=\"name\" id=\"firstname\" value={props.firstname} onChange={(e) => props.handleNameInput(e)} required />\n            {props.nameError && <p className=\"error-font\" aria-live=\"polite\">{props.nameError}</p>}\n          </div>\n\n          <div className=\"form-component-wrapper\">\n            <label htmlFor=\"lastname\">Last Name <span>(Optional)</span></label>\n            <TextInput autoComplete=\"lastname\" id=\"lastname\" value={props.lastname} onChange={(e) => props.handleLastnameInput(e)} />\n            {props.lastnameError && <p className=\"error-font\" aria-live=\"polite\">{props.lastnameError}</p>}\n          </div>\n\n\n          <div className=\"form-component-wrapper\">\n            <label htmlFor=\"email\">Email</label>\n            <EmailInput autoComplete=\"username\" id=\"email\" value={props.email} onChange={(e) => props.handleEmailInput(e)} required />\n            {props.emailError && <p className=\"error-font\" aria-live=\"polite\">{props.emailError}</p>}\n          </div>\n\n\n\n          <div className=\"form-component-wrapper\">\n            <label htmlFor=\"pass\">Password (6 characters minimum)</label>\n            <PasswordInput autoComplete=\"new-password\" id=\"pass\" value={props.password} onChange={(e) => props.handlePassInput(e)} required />\n            {props.passError && <p className=\"error-font\" aria-live=\"polite\">{props.passError}</p>}\n          </div>\n\n\n          <div className=\"form-component-wrapper\">\n            <label htmlFor=\"confirm-pass\">Confirm Password</label>\n            <PasswordInput  autoComplete=\"new-password\" checkName=\"show-confirm-pass\" id=\"confirm-pass\" value={props.confirmPassword} onChange={(e) => props.handleConfirmPassInput(e)} required />\n            {props.confirmPassError && <p className=\"error-font\" aria-live=\"polite\">{props.confirmPassError}</p>}\n          </div>\n\n          <div className=\"form-component-wrapper\">\n            <SubmitButton value={`${props.loading ? 'Creating Account...' : 'Create Account'}`} />\n          </div>\n\n        </form>\n      </div>\n    </>\n  )\n\n}\n\n\n\nSignUp.propTypes = {\n  introtext: PropTypes.string,\n  handleSubmit: PropTypes.func,\n  name: PropTypes.string,\n  handleNameInput: PropTypes.func,\n  nameError: PropTypes.string,\n  lastname: PropTypes.string,\n  handleLastnameInput: PropTypes.func,\n  lastnameError: PropTypes.string,\n  email: PropTypes.string,\n  handleEmailInput: PropTypes.func,\n  emailError: PropTypes.string,\n  password: PropTypes.string,\n  handlePassInput: PropTypes.func,\n  passError: PropTypes.string,\n  confirmPassword: PropTypes.string,\n  handleConfirmPassInput: PropTypes.func,\n  confirmPassError: PropTypes.string,\n  tabContent: PropTypes.bool,\n  hiddeTitle: PropTypes.bool\n}\n\n\nexport default SignUp;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport firebase from '../../utils/firebase/firebaseConfig'\n\nimport SignIn from './SignIn'\nimport SignUp from './SignUp'\n\n\n\nclass Authenticate extends React.Component {\n\n    state = {\n        newUser: false,\n        firstname: '',\n        lastname: '',\n        email: '',\n        password: '',\n        confirmPassword: '',\n        emailError: '',\n        passError: '',\n        confirmPassError: '',\n        nameError: '',\n        lastnameError: '',\n        loading: false\n    }\n\n    handleSignIn(e) {\n\n        e.preventDefault();\n        this.setState({\n            emailError: '',\n            passError: '',\n            loading: true\n        })\n\n\n        let email = this.state.email;\n        let password = this.state.password;\n        let component = this;\n\n\n        firebase.auth().fetchSignInMethodsForEmail(email).then(\n            signInMethods => {\n                if (signInMethods.indexOf(firebase.auth.EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD) !== -1) {\n\n                    firebase.auth().signInWithEmailAndPassword(email, password).then(\n                        (userCredential) => {\n                            if (this.props.afterSignIn) {\n                                let user = userCredential.user;\n                                this.props.afterSignIn(user)\n                            }\n                        }\n                    )\n                        .catch((error) => {\n                            let errorCode = error.code;\n                            let errorMessage = error.message;\n                            if (errorCode === \"auth/too-many-requests\") {\n                                component.setState({ passError: \"Too many sign in attempts, reset password or try again later.\" })\n                            }\n                            else if (errorCode === \"auth/wrong-password\") {\n                                component.setState({ passError: \"Invalid password\" })\n                            }\n                            else {\n                                component.setState({ passError: errorMessage })\n                            }\n\n                        });\n                }\n\n                else {\n                    this.setState({ emailError: \"Couldn't find an account with that email.\" })\n                }\n\n            }\n        )\n\n        this.setState({ loading: false })\n\n    }\n\n\n    handleCreateAccount(e) {\n\n        e.preventDefault();\n        this.setState({\n            confirmPassword: '',\n            emailError: '',\n            passError: '',\n            confirmPassError: '',\n            nameError: '',\n            lastnameError: '',\n            loading: true\n        })\n\n\n        let email = this.state.email;\n        let password = this.state.password;\n        let confirmPassword = this.state.confirmPassword;\n        let firstname = this.state.firstname;\n        let lastname = this.state.lastname;\n\n        let component = this;\n\n\n        firebase.auth().fetchSignInMethodsForEmail(email).then(\n            signInMethods => {\n                if (signInMethods.indexOf(firebase.auth.EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD) !== -1) {\n                    this.setState({ emailError: \"An account exist with that email.\" })\n                }\n\n                else {\n                    //check that name and lastname does not include special characters, except for hypens\n                    let testString = /^[a-zA-Z][ a-zA-Z \\-' -]+$/;\n\n\n                    if (!testString.test(firstname)) {\n                        component.setState({ nameError: \"Name can only contain letters, apostrophes, hypens and spaces.\" })\n                    }\n\n                    if (lastname) {\n                        if (!testString.test(lastname)) {\n                            component.setState({ lastnameError: \"Last name can only contain letters, apostrophes, hypens and spaces.\" })\n\n                        }\n                    }\n\n                    //check that name and lastname are longer than 1 character\n                    if (firstname.length === 1) {\n                        component.setState({ nameError: \"Name must be longer than one character.\" })\n                    }\n\n                    if (lastname.length === 1) {\n                        component.setState({ lastnameError: \"Last name, if provided, must be longer than one character.\" })\n                    }\n\n                    //check that passworrd is longer than 5 characters\n                    if (password.length < 6) {\n                        component.setState({ passError: \"Passowrd must be at least 6 characters long.\" })\n                    }\n\n                    //check that passwords match\n                    if (password !== confirmPassword) {\n                        component.setState({ confirmPassError: \"Passwords don't match\" })\n                    }\n\n                    //check that there are no errors\n                    if (!this.state.emailError && !this.state.confirmPassError && !this.state.nameError && !this.state.passError) {\n                        //create account\n                        let displayName = firstname;\n\n                        if (firstname && lastname) {\n                            displayName = `${firstname} ${lastname}`\n                        }\n                        //create credentials\n                        firebase.auth().createUserWithEmailAndPassword(email, password).then(userCredential => {\n                            let user = userCredential.user;\n                            let userId = user.uid;\n                            let email = user.email;\n                        \n\n                            //add user displayName and email to databsse\n                            let userInfo = {\n                                email: email,\n                                displayName: displayName\n                            }\n                            let database = firebase.database();\n\n                            database.ref(`users/${userId}`).set(\n                                userInfo\n                            ).catch((error) => {\n                                console.log(error)\n                            })\n\n                            if (this.props.afterCreateAccount) {\n                                let user = userCredential.user;\n                                this.props.afterCreateAccount(user)\n                            }\n\n                        }\n\n                        )\n                            .catch((error) => {\n                                var errorCode = error.code;\n                                var errorMessage = error.message;\n\n                                if (errorCode === \"auth/email-already-in-use\") {\n                                    this.setState({ emailError: \"An account exist with that email.\" })\n                                }\n\n                                if (errorCode === \"auth/invalid-email\") {\n                                    this.setState({ emailError: \"Please use a valid email address\" })\n                                }\n\n                                if (errorCode === \"auth/operation-not-allowed\") {\n                                    this.setState({ emailError: errorMessage })\n                                }\n\n                                if (errorCode === \"auth/weak-password\") {\n                                    component.setState({ passError: \"Passowrd must be at least 6 characters long.\" })\n                                }\n                            });\n                    }\n\n                }\n\n            }\n        )\n        this.setState({ loading: false })\n\n    }\n\n    handleEmailInput(e) {\n        this.setState({ email: e.target.value })\n    }\n\n    handlePassInput(e) {\n        this.setState({ password: e.target.value })\n    }\n\n    handleNameInput(e) {\n        this.setState({ firstname: e.target.value })\n    }\n\n    handleLastnameInput(e) {\n        this.setState({ lastname: e.target.value })\n    }\n\n    handleConfirmPassInput(e) {\n        this.setState({ confirmPassword: e.target.value })\n    }\n\n\n    changeUserType() {\n        this.setState({ newUser: !this.state.newUser }, () => {\n            if (this.props.changeUserOnParent) {\n                this.props.changeUserOnParent(this.state.newUser)\n            }\n        })\n    }\n\n    renderContent(newUser) {\n\n        let logInLocation = this.props.logInLocation;\n\n        let trips = 'trips'\n        let add = 'add'\n        let account = 'account'\n\n\n        let text;\n\n        switch (logInLocation) {\n            case trips:\n                text = \"view your trips\"\n                break;\n            case add:\n                text = \"add a location\"\n                break;\n            case account:\n                text = \"view your account information\"\n                break;\n            default:\n                text = \"continue your PhotoAtlas journey\"\n        }\n\n        if (newUser) {\n            return (\n                <>\n                    <SignUp\n                        hideTitle={this.props.hideTitle ? true : false}\n                        tabContent={this.props.tabContent}\n                        introtext={text}\n                        handleSubmit={(e) => this.handleCreateAccount(e)}\n                        email={this.state.email}\n                        handleEmailInput={(e) => this.handleEmailInput(e)}\n                        emailError={this.state.emailError}\n                        password={this.state.password}\n                        handlePassInput={(e) => this.handlePassInput(e)}\n                        passError={this.state.passError}\n                        loading={this.state.loading}\n\n                        firstname={this.state.firstname}\n                        nameError={this.state.nameError}\n                        handleNameInput={(e) => this.handleNameInput(e)}\n\n                        lastname={this.state.lastname}\n                        lastnameError={this.state.lastnameError}\n                        handleLastnameInput={(e) => this.handleLastnameInput(e)}\n\n                        confirmPassword={this.state.confirmPassword}\n                        confirmPassError={this.state.confirmPassError}\n                        handleConfirmPassInput={(e) => this.handleConfirmPassInput(e)}\n                    />\n                </>\n            )\n        }\n        else {\n            return (\n                <>\n                    <SignIn\n                        hideTitle={this.props.hideTitle ? true : false}\n                        tabContent={this.props.tabContent}\n                        introtext={text}\n                        handleSubmit={(e) => this.handleSignIn(e)}\n                        email={this.state.email}\n                        handleEmailInput={(e) => this.handleEmailInput(e)}\n                        emailError={this.state.emailError}\n                        password={this.state.password}\n                        handlePassInput={(e) => this.handlePassInput(e)}\n                        passError={this.state.passError}\n                        loading={this.state.loading}\n                        logInLocation={logInLocation}\n                    />\n                </>\n            )\n        }\n    }\n\n\n    render() {\n\n        let { newUser } = this.state;\n\n        return (\n            <>\n\n                {this.renderContent(newUser)}\n\n                <div className=\"container mobile-padding\">\n                    <button className=\"button-link\" onClick={() => this.changeUserType()}>\n                        {newUser ? \"Sign In\" : \"Create Account\"}\n                    </button>\n                </div>\n            </>\n\n        )\n\n    }\n\n}\n\nAuthenticate.propTypes = {\n    logInLocation: PropTypes.string,\n    tabContent: PropTypes.bool,\n    hideTitle: PropTypes.bool,\n    afterSignIn: PropTypes.func,\n    afterCreateAccount: PropTypes.func\n}\n\n\nexport default Authenticate;","import React from 'react'\nimport PropTypes from 'prop-types';\nimport firebase from '../../utils/firebase/firebaseConfig'\n\n\nclass VerifyEmail extends React.Component {\n\n    state = {\n        error: null\n    }\n\n    componentDidMount() {\n\n        let user = firebase.auth().currentUser;\n        let component = this;\n\n        let actionCodeSettings = {\n            url: `https://photoatlasapp.com/`\n        };\n\n        if (user) {\n\n            user.sendEmailVerification(actionCodeSettings)\n                .catch(function (error) {\n                    component.setState({ error: `${error}` })\n                });\n\n        }\n\n    }\n\n    renderContent() {\n        if (!this.state.error) {\n            return (\n                <>\n                    {this.props.tabContent ? \n                        <h3 className=\"h4-font\">Just one more step</h3> :\n                        <h2 className=\"h4-font\">Just one more step</h2>}\n                    <p>\n                        We've sent a verification link to your email.<br />\n                        Please check your inbox to verify your account.\n                    </p>\n\n                    <h3 className=\"h6-font\">\n                        Need a new link?\n                    </h3>\n\n                    <button className=\"button-link\">Re-Send Link</button>\n\n                </>\n\n            )\n        }\n        else {\n            return (\n                <>\n                    <h2 className=\"h4-font\">Sorry, there was a problem</h2>\n                    <p className=\"error-font\">{this.state.error}</p>\n                    <p>\n                        Please contact support at photoatlasapp@gmail.com.\n                </p>\n                </>\n            )\n        }\n    }\n\n    render() {\n        return (\n            <>\n                <div className={`container mobile-padding`}>\n                    {this.renderContent()}\n                    <button className=\"secondary-button back-button\"\n                        onClick={\n                            () => {\n                                firebase.auth().signOut()\n                            }\n                        }>\n                        Back to Sign In\n                    </button>\n                </div>\n            </>\n        )\n    }\n}\n\nVerifyEmail.propTypes = {\n    logInLocation: PropTypes.string,\n    tabContent: PropTypes.bool\n}\n\nexport default VerifyEmail;","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Authenticate from '../../screens/authentication/Authenticate'\nimport VerifyEmail from '../../screens/authentication/VerifyEmail'\n\n\n\n\nfunction PrivateTab (props) {\n        if (props.isAuthenticated) {\n            if (!props.isVerified) {\n                return <VerifyEmail logInLocation={props.logInLocation} tabContent={true}/>\n            } else {\n               return props.componentContent();\n            }\n        }\n        else {\n            return (\n                <Authenticate logInLocation={props.logInLocation} tabContent={true}/>\n            )\n        }\n}\n\nPrivateTab.propTypes = {\n    logInLocation: PropTypes.string,\n    componentContent: PropTypes.func.isRequired\n}\n\n\n\nexport default PrivateTab;","import firebase from './firebase/firebaseConfig'\n\nlet getUserTrips = (userId, callback, locationId = null) => {\n\n    let database = firebase.database();\n    let existingTrips = [];\n    if(userId) {\n        database.ref(`userTrips/${userId}`).get().then((snapshot) => {\n\n            if (snapshot.exists()) { \n                let trips = snapshot.val();\n    \n    \n                for (const tripId in trips) { \n                    let trip = trips[tripId]\n    \n                    //get privacy setting \n                    let privacy = trip['tripPrivacy']\n    \n                    let tripRef = `${privacy}Trips/${tripId}`\n    \n                    database.ref(`${tripRef}`).get().catch(error=>console.log(error)).then(\n                        (snapshot) => {\n                            if (snapshot.exists()) {\n                                let tripData = snapshot.val()\n                                //get title\n                                let title = tripData['tripName']\n    \n                                //get locationsCount\n                                let locationsCount = tripData['locationsCount']\n    \n                                //get thumnail\n                                let thumbnail = tripData['featuredImg']\n\n                                //get tags\n                                let tags = tripData['tags']\n    \n                                //see if location is in trip\n                                let inTrip;\n    \n                                if (locationId) {\n                                    let locations = tripData.locations;\n    \n    \n                                    if (locations) {\n                                        let location = locations[locationId]\n                                        if (location) {\n                                            inTrip = true\n                                        } else {\n                                            inTrip = false\n                                        }\n                                    } else {\n                                        inTrip = false\n                                    }\n                                }\n    \n                                let existingTripUpdate = {\n                                    tripId: tripId,\n                                    thumbnail: thumbnail,\n                                    title: title,\n                                    locationsCount: locationsCount,\n                                    privacy: privacy,\n                                    inTrip: inTrip,\n                                    authorId: userId,\n                                    tags: tags ? tags : ''\n                                }\n    \n                                existingTrips.push(existingTripUpdate)\n    \n                                return existingTrips\n                            } else {\n                                console.log(`issue fetching: ${tripRef}`)\n                            }\n                        }\n                    ).catch((error) => console.log(`could not fetch trips: ${error}`)).then((existingTrips) => callback(existingTrips))\n    \n                }\n    \n            } else {\n                callback(existingTrips)\n            }\n    \n        })\n\n    }\n\n}\n\nexport default getUserTrips;","import React from 'react'\nimport PropTypes from 'prop-types'\nimport PrivateTab from '../../components/navigation/PrivateTab'\nimport getUserTrips from '../../utils/getUserTrips'\nimport SearchBar from '../../components/forms/SearchBar'\nimport UnfilteredTrips from '../../components/content/UnfilteredTrips'\nimport FilteredTrips from '../../components/content/FilteredTrips'\n\nclass MyTrips extends React.Component {\n\n    state = {\n        existingTrips: [],\n        loading: true,\n        searching: false,\n        loadingSearchResults: false,\n        searchResults: [],\n        searchTerms: ''\n    }\n    _isMounted = false;\n\n    getTripsList() {\n        let userId = this.props.userId;\n        if (this.props.isAuthenticated) {\n            getUserTrips(userId, (tripsList) => {\n                if (tripsList.length > 0) {\n                    this._isMounted &&  this.setState({ existingTrips: tripsList, loading: false })\n                } else {\n                    this._isMounted && this.setState({ loading: false })\n                }\n            }\n            )\n        }\n    }\n\n    handleSearchInput(e) {\n        this.setState({ searchTerms: e.target.value }, () => {\n            if (!this.state.searchTerms) {\n                this.setState({ searching: false })\n            }\n        })\n    }\n\n    getSearchResults(e) {\n        e.preventDefault();\n\n        //use search terms to create searcResults array\n        let existingTrips = this.state.existingTrips;\n        let results = []\n        let searchTerms = this.state.searchTerms.toLowerCase();\n        \n        this.setState({ searching: true, loadingSearchResults: true })\n\n        existingTrips.forEach(trip => {\n            let title = trip.title.toLowerCase()\n            let tags = trip.tags.toLowerCase()\n\n            let titleMatch = title.includes(searchTerms)\n            let tagsMatch = tags.includes(searchTerms)\n\n            if (titleMatch || tagsMatch) {\n\n                results.push(trip)\n\n            }\n        }\n\n        )\n\n        this.setState({ loadingSearchResults: false, searchResults: results })\n\n    }\n\n    tripsList(existingTrips) {\n        let {searching, loadingSearchResults, searchResults} = this.state;\n        if (!searching) {\n            return <UnfilteredTrips existingTrips={existingTrips}/>\n        } else {\n            return <FilteredTrips loading={loadingSearchResults} searchResults={searchResults}/>\n        }\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n        this.getTripsList()\n    }\n\n    componentDidUpdate(nextProps) {\n        if(this.props.isAuthenticated !== nextProps.isAuthenticated) {\n            this.getTripsList()\n        }\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n    renderUserTrips() {\n\n        let { existingTrips, loading } = this.state;\n\n        while (loading) {\n            return (\n                <div aria-live=\"polite\">\n                    <p>Getting Trips...</p>\n                </div>\n            )\n        } \n        \n            if (existingTrips.length > 0) {\n                return (\n                    <>\n                    <SearchBar\n                        className=\"border-search\"\n                        id=\"trips-search\"\n                        placeholder=\"cityscapes\"\n                        labelText=\"Search trips by tags or title\"\n                        value={this.state.searchTerms}\n                        onChange={(e) => this.handleSearchInput(e)}\n                        onClick={(e) => this.getSearchResults(e)}\n                    />\n                    {this.tripsList(existingTrips)}\n                    </>)\n\n            } else {\n\n                return (\n                    <div aria-live=\"polite\">\n                        <p>No trips here yet.</p>\n                    </div>\n                )\n\n\n            }\n\n    }\n\n    render() {\n        return (\n            <>\n                <PrivateTab\n                    componentContent={() => this.renderUserTrips()}\n                    logInLocation={\"trips\"}\n                    isVerified={this.props.isVerified}\n                    isAuthenticated={this.props.isAuthenticated}\n                />\n            </>\n        )\n    }\n\n}\n\nMyTrips.propTypes = {\n    userId: PropTypes.string,\n    isAuthenticated: PropTypes.bool,\n    isVerified: PropTypes.bool\n}\n\n\n\nexport default MyTrips;","import firebase from './firebase/firebaseConfig'\n\nlet getUserTrips = (userId, callback) => {\n\n    let database = firebase.database();\n    let existingTrips = [];\n\n    if(userId) {\n        database.ref(`userBookmarks/${userId}`).get().then((snapshot) => {\n\n            if (snapshot.exists()) { \n                let trips = snapshot.val();\n    \n    \n                for (const tripId in trips) { \n                    let trip = trips[tripId]\n    \n                    //get privacy setting \n                    let privacy = trip['tripPrivacy']\n    \n                    let tripRef = `${privacy}Trips/${tripId}`\n    \n                    database.ref(`${tripRef}`).get().catch(error=>console.log(error)).then(\n                        (snapshot) => {\n                            if (snapshot.exists()) {\n                                let tripData = snapshot.val()\n                                //get title\n                                let title = tripData['tripName']\n    \n                                //get locationsCount\n                                let locationsCount = tripData['locationsCount']\n\n                                //get authorId\n                                let authorId = tripData['author']\n    \n                                //get thumnail\n                                let thumbnail = tripData['featuredImg']\n\n                                //get tags\n                                let tags = tripData['tags']\n    \n    \n                                let existingTripUpdate = {\n                                    tripId: tripId,\n                                    thumbnail: thumbnail,\n                                    title: title,\n                                    locationsCount: locationsCount,\n                                    privacy: privacy,\n                                    authorId: authorId,\n                                    tags: tags ? tags : ''\n                                }\n    \n                                existingTrips.push(existingTripUpdate)\n    \n                                return existingTrips\n                            } else {\n                                console.log(`issue fetching: ${tripRef}`)\n                            }\n                        }\n                    ).catch((error) => console.log(`could not fetch trips: ${error}`)).then((existingTrips) => callback(existingTrips))\n    \n                }\n    \n            } else {\n                callback(existingTrips)\n            }\n    \n        })\n\n    }\n\n}\n\nexport default getUserTrips;","import React from 'react'\nimport PropTypes from 'prop-types'\nimport PrivateTab from '../../components/navigation/PrivateTab'\nimport getUserBookmarks from '../../utils/getUserBookmarks'\nimport SearchBar from '../../components/forms/SearchBar'\nimport UnfilteredTrips from '../../components/content/UnfilteredTrips'\nimport FilteredTrips from '../../components/content/FilteredTrips'\n\n\n\nclass BookmarkedTrips extends React.Component {\n\n    state = {\n        existingTrips: [],\n        loading: true,\n        searching: false,\n        loadingSearchResults: false,\n        searchResults: [],\n        searchTerms: ''\n    }\n    _isMounted = false;\n\n    getTripsList() {\n        let userId = this.props.userId;\n        if (this.props.isAuthenticated) {\n            getUserBookmarks(userId, (tripsList) => {\n                if (tripsList.length > 0) {\n                    this._isMounted && this.setState({ existingTrips: tripsList, loading: false })\n                } else {\n                    this._isMounted && this.setState({ loading: false })\n                }\n            }\n            )\n        }\n    }\n\n    handleSearchInput(e) {\n        this.setState({ searchTerms: e.target.value }, () => {\n            if (!this.state.searchTerms) {\n                this.setState({ searching: false })\n            }\n        })\n    }\n\n    getSearchResults(e) {\n        e.preventDefault();\n\n        //use search terms to create searcResults array\n        let existingTrips = this.state.existingTrips;\n        let results = []\n        let searchTerms = this.state.searchTerms.toLowerCase();\n\n        this.setState({ searching: true, loadingSearchResults: true })\n\n        existingTrips.forEach(trip => {\n            let title = trip.title.toLowerCase()\n            let tags = trip.tags.toLowerCase()\n\n            let titleMatch = title.includes(searchTerms)\n            let tagsMatch = tags.includes(searchTerms)\n\n            if (titleMatch || tagsMatch) {\n\n                results.push(trip)\n\n            }\n        }\n\n        )\n\n        this.setState({ loadingSearchResults: false, searchResults: results })\n\n    }\n\n    tripsList(existingTrips) {\n        let { searching, loadingSearchResults, searchResults } = this.state;\n        if (!searching) {\n            return <UnfilteredTrips existingTrips={existingTrips} />\n        } else {\n            return <FilteredTrips loading={loadingSearchResults} searchResults={searchResults} />\n        }\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n        this.getTripsList()\n    }\n\n    componentDidUpdate(nextProps) {\n        if (this.props.isAuthenticated !== nextProps.isAuthenticated) {\n            this.getTripsList()\n        }\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n    renderUserBookmarks() {\n\n        let { existingTrips, loading } = this.state;\n\n        while (loading) {\n            return (\n                <div aria-live=\"polite\">\n                    <p>Getting Trips...</p>\n                </div>\n            )\n        }\n\n        if (existingTrips.length > 0) {\n            return (\n                <>\n                    <SearchBar\n                        className=\"border-search\"\n                        id=\"trips-search\"\n                        placeholder=\"cityscapes\"\n                        labelText=\"Search trips by tags or title\"\n                        value={this.state.searchTerms}\n                        onChange={(e) => this.handleSearchInput(e)}\n                        onClick={(e) => this.getSearchResults(e)}\n                    />\n                    {this.tripsList(existingTrips)}\n                </>)\n\n        } else {\n\n            return (\n                <div aria-live=\"polite\">\n                    <p>No trips here yet.</p>\n                </div>\n            )\n\n\n        }\n\n    }\n\n    render() {\n        return (\n            <>\n                <PrivateTab\n                    componentContent={() => this.renderUserBookmarks()}\n                    logInLocation={\"trips\"}\n                    isVerified={this.props.isVerified}\n                    isAuthenticated={this.props.isAuthenticated}\n                />\n            </>\n        )\n    }\n\n}\n\nBookmarkedTrips.propTypes = {\n    userId: PropTypes.string,\n    isAuthenticated: PropTypes.bool,\n    isVerified: PropTypes.bool\n}\n\n\n\nexport default BookmarkedTrips;","import React from 'react'\nimport PropTypes from 'prop-types';\nimport PublicTrips from './PublicTrips'\nimport MyTrips from './MyTrips'\nimport BookmarkedTrips from './BookmarkedTrips'\n\n\n\n\nclass Trips extends React.Component {\n\n    state = {\n        tab: 'public'\n    }\n\n    renderContent() {\n        let { tab } = this.state\n\n        // console.log(tab)\n        if (tab === 'public') {\n            return <PublicTrips />\n        }\n\n        if (tab === 'private') {\n            return (\n                <MyTrips\n                    isVerified={this.props.isVerified}\n                    isAuthenticated={this.props.isAuthenticated}\n                    userId={this.props.userId}\n                />\n            )\n        }\n\n        if (tab === 'bookmarks') {\n            return (\n                <BookmarkedTrips\n                    isVerified={this.props.isVerified}\n                    isAuthenticated={this.props.isAuthenticated}\n                    userId={this.props.userId}\n                />\n\n            )\n        }\n\n\n    }\n\n    switchTabs(value) {\n        this.setState({ tab: value })\n\n    }\n\n    render() {\n        let { tab } = this.state;\n        return (\n            <>\n                <div className={`container trips mobile-padding`}>\n                    <h2>Trips</h2>\n                    <ul className={`tabs`}>\n                        <li>\n                            <button\n                                className={tab === 'public' ? 'active' : 'inactive'}\n                                onClick={() => this.switchTabs('public')}>Public Trips\n                            </button>\n                        </li>\n                        <li>\n                            <button\n                                className={tab === 'private' ? 'active' : 'inactive'}\n                                onClick={() => this.switchTabs('private')}>\n                                My Trips\n                            </button>\n                        </li>\n\n                        <li>\n                            <button\n                                className={tab === 'bookmarks' ? 'active' : 'inactive'}\n                                onClick={() => this.switchTabs('bookmarks')}>\n                                Bookmarks\n                            </button>\n                        </li>\n\n\n                    </ul>\n                    {this.renderContent()}\n                </div>\n            </>\n        )\n    }\n\n}\n\nTrips.propTypes = {\n    userId: PropTypes.string,\n    isAuthenticated: PropTypes.bool,\n    isVerified: PropTypes.bool\n}\n\n\n\nexport default Trips;","import { Route } from \"react-router-dom\";\nimport PropTypes from 'prop-types';\nimport Authenticate from '../../screens/authentication/Authenticate'\nimport VerifyEmail from '../../screens/authentication/VerifyEmail'\n\n\nfunction PrivateRoute({ component: Component, isAuthenticated, logInLocation, isVerified, user, ...rest }) {\n    \n    return (\n        <Route\n\n            {...rest}\n\n            render={props => (\n\n                isAuthenticated ?\n\n                    (\n                        isVerified ?\n\n                            <Component {...props} />\n                            :\n                            <VerifyEmail logInLocation={logInLocation} />\n\n                    )\n\n                    :\n\n                    (<Authenticate logInLocation={logInLocation} />)\n            )} />\n\n    )\n}\n\n\nPrivateRoute.propTypes = {\n    isAuthenticated: PropTypes.bool.isRequired,\n    isVerified: PropTypes.bool.isRequired,\n    logInLocation: PropTypes.string\n}\n\nexport default PrivateRoute;","function Footer() {\n    return (\n        <footer>\n            <div className={`container`}>\n                <p>&copy; PhotoAtlas 2021</p>\n                <p className={`caption`}>\n                    All photographs and their titles/metadata on PhotoAtlas are copyrighted and owned by\n                    their respective owners (the photographers) and not by PhotoAtlas. As such Photo Atlas does\n                    not grant any licenses to any copyrights, patents or any other intellectual property rights. \n                    PhotoAtlas is not affiliated with Flickr.com, but sources its photos through the Flickr API.\n          </p>\n            </div>\n        </footer>\n    )\n}\n\nexport default Footer;","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport SimpleReactLightbox, { SRLWrapper } from \"simple-react-lightbox\";\n\n\nconst PhotoSlider = (props) => {\n  const { imageList } = props;\n  const imagesCount = imageList.length;\n\n  const lightboxOptions = {\n    buttons: {\n      showDownloadButton: false,\n      showAutoplayButton: false\n    }\n  }\n\n  return (\n    <SimpleReactLightbox>\n      <div className={`photo-slider`}>\n\n        <SRLWrapper options={lightboxOptions}>\n\n          {imageList.map((image, id) => {\n\n            const { src, alt, author, creditUrl } = image;\n\n            return (\n              <div key={id} className={`image-with-credit`}>\n                <a href={src}>\n                 <div className={`image-container`}>\n                 <img  src={src} alt={alt ? alt : ''}   />\n                 </div>\n                </a>\n                {author && <span className={`credit`}><a href={creditUrl}>{author}</a></span>}\n              </div>\n            )\n\n          })}\n\n        </SRLWrapper>\n\n      </div>\n\n      <p className={`caption`}>Total images: {imagesCount}</p>\n\n    </SimpleReactLightbox>\n\n  )\n\n}\n\nPhotoSlider.propTypes = {\n  imageList: PropTypes.arrayOf(PropTypes.object).isRequired\n}\n\n\nexport default PhotoSlider;\n","import PropTypes from 'prop-types';\n\nfunction SubjectIndicators(props) {\n\n    let { subjects } = props;\n\n    if (!subjects) {\n        subjects = [];\n    }\n\n\n    return (\n        <>\n            <h3>Photo Subjects</h3>\n            <div className={`data-container`}>\n                <ul className={`subject-indicators`}>\n\n                    {subjects.includes('abandoned') && <li className={`abandoned`}>Abandoned</li>}\n\n                    {subjects.includes('architecture') && <li className={`architecture`}>Architecture</li>}\n\n                    {subjects.includes('astro') && <li className={`astro`}>Astrophotography</li>}\n\n                    {subjects.includes('landscape') && <li className={`landscape`}>Landscape</li>}\n\n                    {subjects.includes('nature') && <li className={`nature`}>Nature</li>}\n\n                    {subjects.includes('street art') && <li className={`street-art`}>Street Art</li>}\n\n                    {subjects.includes('sunrise') && <li className={`sunrise`}>Sunrise</li>}\n\n                    {subjects.includes('sunset') && <li className={`sunset`}>Sunset</li>}\n\n                    {subjects.includes('transport') && <li className={`transport`}>Transport</li>}\n\n                    {subjects.includes('people') && <li className={`people`}>People</li>}\n\n                    {subjects.includes('urban') && <li className={`urban`}>Urban</li>}\n\n                    {subjects.includes('water') && <li className={`water`}>Water Feature</li>}\n\n                </ul>\n            </div>\n        </>\n    )\n\n}\n\nSubjectIndicators.propTypes = {\n    subjects: PropTypes.arrayOf(PropTypes.string)\n}\n\nexport default SubjectIndicators;","async function getFlickrPhotoInfo(photoId, handleResponse =\n    (responseData) => console.log(responseData)) {\n\n    let url = `https://api.flickr.com/services/rest/?api_key=${process.env.REACT_APP_FLICKR_API_KEY}&method=flickr.photos.getInfo&format=json&nojsoncallback=1}&photo_id=${photoId}`\n\n    await fetch(url)\n        .then(response => {\n            if (!response.ok) {\n                throw Error(response.statusText);\n            }\n            return response.json().then(data => {\n                handleResponse(data);\n            });\n        }).catch(error => {\n            console.log(error)\n        }\n        )\n};\n\nexport default getFlickrPhotoInfo;","\n\nfunction createFlickrImageUrl(photoData) {\n\n    let {farm,server,id,secret} = photoData;\n\n    return `https://farm${farm}.staticflickr.com/${server}/${id}_${secret}.jpg`\n}\n\n//reference https://idratherbewriting.com/learnapidoc/docapis_flickr_example.html\n\nexport default createFlickrImageUrl;","\nimport PropTypes from 'prop-types'\n\nconst DirectionsSmall = (props) => {\n    return (\n        <a href={`https://maps.google.com/?q=${props.latitude},${props.longitude}`} className={`action-button-small directions`}>Directions</a>\n    )\n}\n\nconst DirectionsLarge = (props) => {\n    return (\n        <a href={`https://maps.google.com/?q=${props.latitude},${props.longitude}`} className={`action-button directions`}>Directions</a>\n    )\n}\n\nDirectionsLarge.propTypes = {\n    latitude: PropTypes.number,\n    longitude: PropTypes.number\n}\n\nexport {DirectionsLarge, DirectionsSmall};","import PropTypes from 'prop-types'\n\nconst AddToTripsLarge = ({added, ...rest}) => {\n\n    return (\n        <button className={`action-button ${added ? 'added' : 'add'}`} {...rest}>\n            {\n                added ? 'Change Trips' : 'Add to Trip'\n            }\n        </button>\n    )\n}\n\nconst AddToTripsSmall = ({added, ...rest}) => {\n\n    return (\n        <button className={`action-button-small ${added ? 'added' : 'add'}`} {...rest}>\n            {\n                added ? 'Change Trips' : 'Add to Trip'\n            }\n        </button>\n    )\n}\n\nAddToTripsLarge.propTypes = {\n    added: PropTypes.bool\n}\n\nAddToTripsSmall.propTypes = {\n    added: PropTypes.bool\n}\n\nexport {AddToTripsLarge, AddToTripsSmall};","import PropTypes from 'prop-types';\n\nfunction RadioButton(props) {\n\n    let { \n        id,\n        value,\n        labelText,\n        className,\n        name,\n        ...rest } = props;\n \n    let idName = id ? id : value;\n\n    return (\n        \n        <>\n        \n            <label className={`check-container ${className ? className : ''}`} htmlFor={idName}>{labelText ? labelText : 'label'}\n\n                <input\n                    \n                    type=\"radio\"\n\n                    id={idName}\n\n                    name={name}\n\n                    value={value}\n\n                    {...rest}\n\n                />\n\n                <span className={`radiomark`}></span>\n\n            </label>\n    </>\n    )\n}\n\nRadioButton.propTypes = {\n    className: PropTypes.string,\n    value: PropTypes.string.isRequired,\n    labelText: PropTypes.string.isRequired,\n    name: PropTypes.string.isRequired\n}\n\n\nexport default RadioButton;","function generateDate() {\n\tlet result;\n\tlet months = [\"JAN\",\"FEB\",\"MAR\",\"APR\",\"MAY\",\"JUN\",\"JUL\",\"AUG\",\"SEP\",\"OCT\",\"NOV\",\"DEC\"]\n\tlet d = new Date();\n\tlet day = d.getDate();\n\tlet month = months[d.getMonth()];\n\tlet year = d.getFullYear();\n\n\tresult = `${day}-${month}-${year}`\n\n\treturn result;\n\n}\n\nfunction generateTimeNumber() {\n\tlet result;\n\tlet d = new Date();\n\tlet hour = d.getHours();\n\tlet minutes = d.getMinutes();\n\tlet seconds = d.getSeconds();\n\tlet milliseconds = d.getMilliseconds();\n\tresult = `${hour}-${minutes}-${seconds}-${milliseconds}`\n\treturn result;\n}\n\n\nexport {generateDate, generateTimeNumber}\n","function generateId(length, prefix, sufix) {\n    let result  = '';\n    let characters  = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    let charactersLength = characters.length;\n    for ( let i = 0; i < length; i++ ) {\n       result += characters.charAt(Math.floor(Math.random() * charactersLength));\n    }\n    if(prefix) {\n        result = `${prefix}-${result}`\n    }\n    if(sufix) {\n        result = `${result}-${sufix}`\n    }\n    \n    return result;\n }\n\n export default generateId;\n","import React from 'react'\n\nimport firebase from '../../utils/firebase/firebaseConfig'\nimport Authenticate from '../../screens/authentication/Authenticate'\nimport Modal from './Modal'\nimport TexInput from '../forms/TextInput'\nimport SubmitButton from '../forms/SubmitButton'\nimport RadioButton from '../forms/RadioButton'\nimport { generateDate, generateTimeNumber } from '../../utils/generateDateAndTime'\nimport generateID from '../../utils/generateId'\nimport getUserTrips from '../../utils/getUserTrips'\n\nclass ManageTripsModal extends React.Component {\n    state = {\n        modalTitle: 'Add or Remove from Trips',\n        modalDescription: '',\n        isAuthenticated: false,\n        userId: '',\n        existingTrips: [],\n        newTripPrivacy: 'public',\n        newTripName: '',\n        newTripTags: '',\n        newUser: false,\n        creatingTrip: false,\n        tripNameLength: 0,\n        tripNameError: '',\n        tripTagsError: '',\n        newTripCreated: false,\n        needNewTrip: false,\n        errorCreatingTrip: '',\n        errorCreatingLocation: '',\n        errorUpdatingUserTrips: '',\n        errorAddingFilters: '',\n        updatingTrips: true\n    }\n\n    _isMounted = false;\n\n    closeModal() {\n        this.setState({\n            newTripCreated: false,\n            newTripPrivacy: 'public',\n            newTripName: '',\n            newTripTags: '',\n            errorCreatingTrip: '',\n            errorCreatingLocation: '',\n            errorUpdatingUserTrips: '',\n            errorAddingFilters: '',\n            needNewTrip: false\n        }, () => this.props.handleClose());\n    }\n\n    changeUserType(newUserValue) {\n        this.setState({ newUser: newUserValue }, () => {\n\n            if (this.state.newUser) {\n                this.setState(\n                    {\n                        modalTitle: 'Sign Up',\n                        modalDescription: 'Create an account to manage your trips.'\n                    }\n                )\n            } else {\n                this.setState(\n                    {\n                        modalTitle: 'Sign In',\n                        modalDescription: 'Sign in to manage your trips.'\n                    }\n                )\n            }\n        })\n    }\n\n    checkExistingTrips(userId) {\n        \n        this.setState({ updatingTrips: true })\n\n        this._isMounted && \n        getUserTrips(userId,  (existingTrips) => this.setState({ existingTrips: existingTrips, updatingTrips: false }), this.props.locationId)\n    }\n\n\n\n    checkAuth() {\n\n        let userId = this.props.userId;\n\n        if(!userId) {\n            let user = firebase.auth().currentUser;\n            if(user) {\n                userId = user.uid;\n            } \n        }\n\n\n        if (this._isMounted) {\n\n\n            if (userId) {\n\n           \n                //get user trips\n                this._isMounted && this.checkExistingTrips(userId);\n\n                this.setState({ isAuthenticated: true, userId: userId })\n\n                if (this.state.existingTrips.length < 1) {\n                    this.setState(\n                        {\n                            modalTitle: 'Save to a New Trip',\n                            modalDescription: '',\n                            updatingTrips: false\n                        }\n                    )\n                }\n\n            } else {\n                this.setState(\n                    {\n                        modalTitle: 'Sign In',\n                        modalDescription: 'Sign in to manage your trips.'\n                    }\n                )\n            }\n        }\n\n\n\n    }\n\n    componentDidMount() {\n        this._isMounted = true;\n\n        this.checkAuth();\n        //set a listner or trips https://firebase.google.com/docs/database/web/read-and-write#web_value_events\n    }\n\n\n    componentDidUpdate(prevProps) {\n        this._isMounted = true;\n        // Typical usage (don't forget to compare props):\n        if (this.props.locationId !== prevProps.locationId) {\n            this.checkAuth();\n        }\n    }\n\n    renderModalContent() {\n        //modal will ask user to sign in or create account if user is not authenticated\n        //user will NOT be required to have a verified email when saving a location\n\n        //authenticate\n        if (!this.state.isAuthenticated) {\n            return (\n                <div className=\"modal-content-padding\">\n                    <Authenticate\n                        hideTitle\n                        changeUserOnParent={(newUserValue) => this.changeUserType(newUserValue)}\n                        afterSignIn={(user) => this.checkAuth(user)}\n                        afterCreateAccount={(user) => this.checkAuth(user)}\n\n                    />\n                </div>\n            )\n        } else {\n\n            if (this.state.updatingTrips) {\n                return (\n                    <div className=\"modal-content-padding center-text\">\n                        <p>Updating trips...</p>\n                    </div>)\n\n            } else {\n                if (this.state.existingTrips.length > 0 && !this.state.needNewTrip && !this.state.newTripCreated) {\n                    return this.selectExistingTrip();\n                }\n                else {\n                    if (!this.state.newTripCreated && !this.state.updatingTrips) {\n                        return this.getNewTripInfo();\n                    } else {\n\n                        return this.newTripCreated()\n\n\n                    }\n                }\n            }\n        }\n\n    }\n\n    selectExistingTrip() {\n        //show list of trips\n        //a button that triggets getNewTripInfo\n        return (\n            <>\n\n                {this.renderExistingTrips()}\n                <div className=\"modal-content-padding center-text\">\n                    <button onClick={() => this.switchForm()} className=\"button-link\"> + Create a New Trip</button>\n                </div>\n\n            </>\n        )\n\n    }\n\n    switchForm() {\n        this.setState({ needNewTrip: !this.state.needNewTrip })\n    }\n\n    renderExistingTrips() {\n        let { existingTrips } = this.state;\n\n\n\n        return (<ul className=\"existing-trips\">\n            {existingTrips.map((trip, index) => {\n                let {\n                    thumbnail,\n                    title,\n                    locationsCount,\n                    privacy,\n                    tripId,\n                    inTrip } = trip;\n\n                return (\n                    <li key={index} className=\"trip-card-small\">\n                        <div className={`trip-card-image`}>\n                            <img src={thumbnail} alt=\"\" />\n                        </div>\n                        <div className={`trip-card-content`}>\n                            <p className={`title`}>{title}</p>\n                            <p className={`meta-data ${privacy}`}>\n                                {privacy}</p>\n                            <p className={`meta-data marker`}>\n                                {locationsCount} {(locationsCount > 1 || locationsCount < 1) ? 'Locations' : 'Location'}</p>\n                            <button className=\"add-or-remove\" onClick={() => { this.addOrRemoveFromTrip(tripId, privacy) }}>\n                                {inTrip ? '- Remove' : '+ Add'}\n                                <span>{inTrip ? `from ${title}` : `to ${title}`}</span>\n                            </button>\n                        </div>\n                    </li>\n                )\n            })}\n        </ul>)\n\n    }\n\n    handleTripNamelInput(e) {\n        e.preventDefault();\n        let value = e.target.value;\n        let valueLength = value.length;\n\n        this.setState({\n            newTripName: e.target.value,\n            tripNameLength: valueLength,\n            tripNameError: \"\"\n        })\n        if (valueLength > 50) {\n            this.setState({\n                tripNameError: \"Your trip name is too long.\"\n            })\n        }\n    }\n\n    handleTripTagsInput(e) {\n        e.preventDefault();\n\n        this.setState({\n            newTripTags: e.target.value,\n            tripTagsError: \"\"\n        }, () => {\n            //check if tags have special characters other than comma\n            let testString = /^[a-zA-Z ,0-9]+$/;\n\n            if (this.state.newTripTags && !testString.test(this.state.newTripTags)) {\n                this.setState({\n                    tripTagsError: \"Tags may only contain letters, numbers, and commas\"\n                })\n            }\n        });\n\n\n    }\n\n    renderDatabaseErrors() {\n        if (\n            this.state.errorCreatingLocation ||\n            this.state.errorUpdatingUserTrips ||\n            this.state.errorCreatingTrip ||\n            this.state.errorAddingFilters\n        ) {\n            return (\n                <div className=\"error-font\" aria-live=\"polite\">\n                    <ul>\n                        {this.state.errorCreatingTrip && <li>{this.state.errorCreatingTrip}</li>}\n                        {this.state.errorUpdatingUserTrips && <li >{this.state.errorUpdatingUserTrips}</li>}\n                        {this.state.errorCreatingLocation && <li>{this.state.errorCreatingLocation}</li>}\n                        {this.state.errorAddingFilters && <li>{this.state.errorAddingFilters}</li>}\n                    </ul>\n                </div>\n            )\n        }\n\n\n    }\n\n    getNewTripInfo() {\n        return (\n            <>\n                <h3 className=\"h5-font center-text\">Create a New Trip</h3>\n                {this.renderDatabaseErrors()}\n\n                <form className=\"modal-content-padding\">\n                    <div className=\"form-component-wrapper\">\n                        <label htmlFor=\"trip-name\">Title (Max 50 Characters)</label>\n                        <TexInput placeholder=\"Beautiful City\" id=\"trip-name\" value={this.state.newTripName} onChange={(e) => this.handleTripNamelInput(e)} required />\n                        {this.state.tripNameLength !== 0 && <p className=\"character-count\" aria-live=\"polite\">Characters left: {50 - this.state.tripNameLength}</p>}\n                        {this.state.tripNameError && <p className=\"error-font\" aria-live=\"polite\">{this.state.tripNameError}</p>}\n                    </div>\n\n                    <div className=\"form-component-wrapper\">\n                        <label htmlFor=\"trip-tags\">Tags (Comma separated)</label>\n                        <TexInput placeholder=\"city, urban architecture\" id=\"trip-tags\" value={this.state.newTripTags} onChange={(e) => this.handleTripTagsInput(e)} />\n                        {this.state.tripTagsError && <p className=\"error-font\" aria-live=\"polite\">{this.state.tripTagsError}</p>}\n                    </div>\n\n                    <fieldset className=\"form-component-wrapper\">\n                        <legend>Visibility Settings</legend>\n                        <RadioButton onChange={(e) => this.handleNewTripPrivacy(e)} labelText=\"Public\" defaultChecked name=\"trip-privacy\" value=\"public\" />\n                        <label className=\"caption-font\" htmlFor=\"public\">Anyone can see</label>\n                        <RadioButton onChange={(e) => this.handleNewTripPrivacy(e)} labelText=\"Private\" name=\"trip-privacy\" value=\"private\" />\n                        <label className=\"caption-font\" htmlFor=\"private\">Only you can see</label>\n                        <RadioButton onChange={(e) => this.handleNewTripPrivacy(e)} labelText=\"Shareable\" name=\"trip-privacy\" value=\"shareable\" />\n                        <label className=\"caption-font\" htmlFor=\"shareable\">Anyone with a link can see</label>\n                    </fieldset>\n\n                    <div className=\"form-component-wrapper\">\n                        <SubmitButton onClick={(e) => this.createNewTrip(e)} value={`${this.state.creatingTrip ? 'Creating Trip...' : 'Create Trip'}`} />\n                    </div>\n\n\n                </form>\n\n                {this.state.existingTrips.length > 0 &&\n                    <div className=\"modal-content-padding\">\n                        <button onClick={() => this.switchForm()} className=\"secondary-button back-button\">Back to Existing Trips</button>\n                    </div>\n                }\n            </>\n        )\n\n    }\n\n    newTripCreated() {\n        return (\n            <div className=\"modal-content-padding center-text\">\n                <h3 className=\"h5-font center-text\">\n                    This location was added to your new trip.\n                </h3>\n            </div>\n        )\n\n    }\n\n    createNewFlickrSourcedLocation(locationRef) {\n        let database = firebase.database();\n        let locationId = this.props.locationId;\n        let locationPhotosArray = this.props.photos;\n        let locationName = locationPhotosArray[0].title;\n        let locationCoordinates = this.props.coordinates;\n        let locationSubjectsArray = this.props.subjects;\n        let date = generateDate();\n\n        // arrays are handled like objects on Firebase Realtime Database\n        //https://firebase.googleblog.com/2014/04/best-practices-arrays-in-firebase.html\n        //convert props arrays into objects for better database handling\n        let locationSubjects = {};\n        let locationPhotos = {};\n\n        locationPhotosArray.forEach(photo => {\n            let flickrId = photo.flickrId;\n            let photoId;\n            if (flickrId) {\n                photoId = `flickrPhoto-${flickrId}`\n            }\n\n            locationPhotos[photoId] = {\n                title: photo.title,\n                author: photo.author,\n                src: photo.src,\n                creditUrl: photo.creditUrl ? photo.creditUrl : null\n            }\n        }\n        )\n\n\n        locationSubjectsArray.forEach(subject => {\n\n            locationSubjects[subject] = true\n\n        });\n\n        database.ref(`${locationRef}`).set({\n            locationName: locationName,\n            photos: locationPhotos,\n            coordinates: locationCoordinates,\n            savedCount: 1,\n            subjects: locationSubjects,\n            addedDate: date,\n            curated: false, //indicates that app has not been curated by a PhotoAtlas user\n            userLastEditedDate: null,\n            woeId: this.props.woeId\n        }).then(() => {\n\n            // add subjects record\n            locationSubjectsArray.forEach(\n\n                subject => {\n\n                    let subjectRef = subject;\n\n                    let update = {};\n\n                    update[locationId] = true;\n\n                    database.ref(`subjects/${subjectRef}`).update(\n                        update\n                    ).catch(\n                        (error) => {\n                            this.setState({ errorAddingFilter: `Could not add all filters to database: ${error.message}` })\n                        });\n\n                })\n\n        }).catch(\n            (error) => {\n                this.setState({ errorCreatingLocation: `Could not add location to database: ${error.message}` })\n            }\n        )\n\n    }\n\n    createNewTrip(e) {\n        e.preventDefault();\n\n        this.setState(\n            {\n                errorCreatingTrip: '',\n                errorCreatingLocation: '',\n                errorUpdatingUserTrips: '',\n                errorAddingFilters: ''\n            }\n        )\n\n        if (!this.state.newTripName) {\n            this.setState({ tripNameError: 'Please name your trip.' })\n        }\n\n        if (!this.state.tripNameError && this.state.newTripName && !this.state.tripTagsError) {\n            this.setState({ creatingTrip: true })\n\n            let locationId = this.props.locationId;\n            let locationPhotosArray = this.props.photos;\n\n            let tripPrivacy = this.state.newTripPrivacy;\n            let tripName = this.state.newTripName;\n            let tripFeaturedImg = locationPhotosArray[0];\n            let tripFeaturedImgSrc = tripFeaturedImg.src;\n            let tripAuthor = this.state.userId;\n            let tripTags = this.state.newTripTags;\n            if (tripTags.endsWith(\",\") || tripTags.endsWith(\" ,\")) {\n                tripTags = tripTags.slice(0, -1)\n            }\n            let date = generateDate();\n            let time = generateTimeNumber();\n            let tripId = generateID(7, `trip-${date}`, `${time}`)\n\n            let locations = {}\n            locations[locationId] = true;\n\n            let database = firebase.database();\n\n            // create new trip\n            database.ref(`${tripPrivacy}Trips/` + tripId).set({\n                tripName: tripName,\n                featuredImg: tripFeaturedImgSrc,\n                author: tripAuthor,\n                locationsCount: 1,\n                locations: locations,\n                tags: tripTags,\n                createdOn: date,\n                lastEdited: date\n            }).catch((error) => {\n                this.setState({ errorCreatingTrip: `Could not create trip: ${error.message}` })\n            }).then(() => {\n                //add trip to user trips\n                database.ref(`userTrips/${tripAuthor}/${tripId}`).set({\n                    tripPrivacy: tripPrivacy\n                }).catch((error) => {\n                    this.setState({ errorUpdatingUserTrips: `Could to your list of trips: ${error.message}` })\n                });\n            }).then(() => {\n                if (locationId.startsWith(\"flickr-\")) { // check if primary source is from flickr or user created\n\n                    let locationRef = `appLocations/flickrSourced/${locationId}`;\n\n                    //check if location exists in lists of locations if not, then add location\n                    //use transactions to make sure that count stays accurate\n                    //https://firebase.google.com/docs/database/web/read-and-write#save_data_as_transactions\n\n                    database.ref(`${locationRef}`).get().then((snapshot) => {\n                        //if location exists\n                        if (snapshot.exists()) {\n                            //get how many people have saved it, and who has saved it\n                            let savedCount = snapshot.val().savedCount;\n\n                            //add to the saved count \n                            //and add the author\n                            if (savedCount) {\n                                database.ref(`${locationRef}`).transaction(\n                                    (location) => {\n                                        if (location) {\n                                            location.savedCount++;\n                                        }\n                                        return location;\n                                    }\n                                )\n                            }\n\n                        }\n                        else {\n                            //create the location\n                            this.createNewFlickrSourcedLocation(locationRef);\n                        }\n                    })\n                }\n\n            }).then(() => {\n\n                if (!this.state.errorCreatingTrip && !this.state.errorCreatingLocation && !this.state.errorUpdatingUserTrips && !this.state.errorAddingFilters) {\n                    this.setState({\n                        creatingTrip: false,\n                        newTripCreated: true,\n                        modalTitle: 'You have a New Trip',\n                        modalDescription: ''\n                    })\n                } else {\n                    this.setState({\n                        creatingTrip: false\n                    })\n                }\n            }).then(\n                () => this.checkExistingTrips(this.state.userId)\n            )\n\n        }\n\n    }\n\n    addOrRemoveFromTrip(tripId, privacy) {\n\n        this.setState({ updatingTrips: true })\n\n        let database = firebase.database();\n        let currentLocation = this.props.locationId;\n        let user = this.state.userId;\n        let date = generateDate();\n\n        let tripRef = `${privacy}Trips/${tripId}/`\n        //need to change\n        //last edited\n        //locationsCount\n        //locations\n\n        let locationRef = `appLocations/flickrSourced/${currentLocation}`\n        //need to change savedCount\n\n\n        database.ref(`${tripRef}/locations/${currentLocation}`).get().then(\n            snapshot => {\n\n                if (snapshot.exists()) {\n                    //remove\n\n                    database.ref(`${tripRef}`).transaction(\n                        trip => {\n                            if (trip) {\n                                //decrease locationsCount\n                                if (trip.locationsCount > 0) {\n                                    trip.locationsCount--;\n                                }\n                                //change the last edited\n                                trip.lastEdited = date;\n\n                            }\n                            return trip\n                        }).catch((error) => console.log(error)).then(() => {\n                            //remove location from trip\n                            database.ref(`${tripRef}/locations/${currentLocation}`).transaction(\n                                location => {\n                                    if (location) {\n                                        location = null\n                                    }\n                                    return location\n                                }\n                            )\n                        }).then(() => this.checkExistingTrips(user))\n\n                    database.ref(`${locationRef}`).transaction(\n                        location => {\n                            if (location) {\n                                //decrease savedCount\n\n                                location.savedCount--\n\n\n                            }\n                            return location\n                        }).catch((error) => console.log(error))\n\n\n                }\n                else {\n                    //add\n                    if (currentLocation.startsWith(\"flickr-\")) {\n                        let locationRef = `appLocations/flickrSourced/${currentLocation}`\n\n                        database.ref(`${locationRef}`).get().then(\n                            (snapshot) => {\n                                if (!snapshot.exists()) {\n                                    this.createNewFlickrSourcedLocation(locationRef)\n                                }\n                            }\n                        )\n                    }\n\n                    database.ref(`${tripRef}`).transaction(\n                        trip => {\n                            if (trip) {\n                                //increase locationsCount\n                                trip.locationsCount++;\n                                //change the last edited\n                                trip.lastEdited = date;\n                            }\n                            return trip\n                        }).catch((error) => console.log(error)).then(() => {\n                            //add location to trip\n                            //check if trip has locations\n                            database.ref(`${tripRef}/locations`).get().then((snapshot) => {\n                                if (snapshot.exists()) {\n                                    let update = {}\n                                    update[currentLocation] = true\n\n                                    database.ref(`${tripRef}/locations`).update(\n                                        update\n                                    ).catch((error) => console.log(error))\n                                } else {\n                                    let update = { locations: {} }\n                                    update.locations[currentLocation] = true\n\n                                    database.ref(`${tripRef}`).update(\n                                        update\n                                    ).catch((error) => console.log(error))\n                                }\n\n                            }).then(() => this.checkExistingTrips(user))\n\n                        })\n\n\n                    database.ref(`${locationRef}`).transaction(\n                        location => {\n                            if (location) {\n                                //increase savedCount\n                                location.savedCount++\n                            }\n                            return location\n                        }).catch((error) => console.log(error))\n\n                }\n            }).then(() => this.setState({ updatingTrips: false }))\n    }\n\n    handleNewTripPrivacy(e) {\n        this.setState({ newTripPrivacy: e.target.value })\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n    render() {\n        let {\n            modalTitle,\n            modalDescription\n        } = this.state;\n\n        return (\n            <Modal\n                modalId='manage-trips-modal'\n                modalTitle={modalTitle}\n                modalDescription={modalDescription}\n                isOpen={this.props.isOpen}\n                handleClose={() => this.closeModal()}\n            >\n                {this.renderModalContent()}\n            </Modal>\n        )\n    }\n}\n\nexport default ManageTripsModal;","import firebase from './firebase/firebaseConfig'\n\nlet getSavesCount = (locationId, callback) => {\n    let database = firebase.database();\n\n    database.ref(`appLocations/flickrSourced/${locationId}`).get().then(\n        (snapshot) => {\n            let count = 0;\n            if (snapshot.exists()) {\n                let location = snapshot.val();\n                count = location['savedCount'];\n            }\n            return count\n        }).catch((error)=> console.log(error)).then((count) => {\n            callback(count)\n        }\n        )\n\n}\n\nexport default getSavesCount;","import React from 'react'\nimport PropTypes from 'prop-types';\n\nimport PhotoSlider from '../../components/slider/PhotoSlider'\nimport SubjectIndicators from '../../components/content/SubjectIndicators'\nimport getFlickrPhotoInfo from '../../utils/flickr/getFlickrPhotoInfo'\nimport createFlickrImageUrl from '../../utils/flickr/createFlickrImageUrl'\nimport getFlickrPlace from '../../utils/flickr/getFlickrPlace'\nimport getFlickrPhotos from '../../utils/flickr/getFlickrPhotos'\nimport filterTags from '../../utils/filterTags'\nimport { DirectionsLarge, DirectionsSmall } from '../../components/buttons/DirectionsButtons'\nimport { AddToTripsLarge, AddToTripsSmall } from '../../components/buttons/AddToTripsButtons'\nimport ManageTripsModal from '../../components/modals/ManageTripsModal'\nimport firebase from '../../utils/firebase/firebaseConfig'\nimport getSavesCount from '../../utils/getSavesCount'\n\nclass Location extends React.Component {\n    state = {\n        locationId: '',\n        title: \"\",\n        distance: 'loading...',\n        saves: 0,\n        destination: {\n            latitude: 0,\n            longitude: 0,\n        },\n        imageList: [],\n        subjects: [],\n        firstPhoto: {},\n        showTripsModal: false,\n        inTrips: false,\n        userId: null,\n        woeId: null\n    };\n\n    _isMounted = false;\n\n\n    manageTripsModal() {\n        this.setState({ showTripsModal: !this.state.showTripsModal })\n        let userId = this.props.userId;\n        this.checkIfInTrips(userId)\n\n        getSavesCount(\n            this.state.locationId,\n            (count) => {\n\n                this.setState({ saves: count })\n            }\n        );\n\n    }\n\n    checkIfInTrips(userId) {\n\n        if (userId && this.props.isAuthenticated) {\n            let database = firebase.database()\n\n\n            this._isMounted && database.ref(`userTrips/${userId}`).get().catch(error => console.log(error)).then((snapshot) => {\n                let locationTrips = [];\n                if (snapshot.exists()) {\n                    let trips = snapshot.val();\n\n\n                    for (const tripId in trips) {\n\n                        let privacy = trips[tripId]['tripPrivacy']\n\n                        let location = this.state.locationId\n\n                        let locationRef = `${privacy}Trips/${tripId}/locations/${location}`\n\n                        this._isMounted && database.ref(`${locationRef}`).get().catch(error => console.log(error)).then(\n                            snapshot => {\n\n                                if (snapshot.exists()) {\n                                    locationTrips.push(tripId)\n                                }\n\n                                if (locationTrips.length > 0) {\n\n                                    this.setState({ inTrips: true })\n\n                                } else {\n                                    this.setState({ inTrips: false })\n                                }\n\n                            }).catch(error => console.log(error))\n\n\n                    }\n\n                }\n                return locationTrips\n            })\n        }\n\n    }\n\n    componentDidUpdate(prevProps) {\n        if (prevProps.userId !== this.props.userId) {\n            let userId = this.props.userId;\n\n            this.checkIfInTrips(userId)\n\n        }\n    }\n\n\n\n    componentDidMount() {\n        this._isMounted = true;\n        let userId = this.props.userId;\n        this.checkIfInTrips(userId)\n\n        //get the location id from the path\n        let path = this.props.location.pathname;\n        let locationId = path.replace(\"/location/\", \"\");\n        this.setState({ locationId: locationId });\n\n\n\n        getSavesCount(\n            locationId,\n            (count) => {\n\n                this.setState({ saves: count })\n            }\n        );\n\n\n\n        //get the woeId from the search query\n        let pathQuery = this.props.location.search;\n        let searchParams = new URLSearchParams(pathQuery);\n        let woeId = searchParams.get(\"woe\");\n        this.setState({ woeId: woeId })\n\n\n        //if the path starts with flickr\n        if (locationId.startsWith(\"flickr-\")) {\n\n\n            //get the photo id\n            let photoId = locationId.replace(\"flickr-\", \"\");\n\n\n            //get the photo information\n            this._isMounted && getFlickrPhotoInfo(\n\n                photoId,\n\n                (data) => {\n\n                    let photoData = data.photo;\n                    let src, title, alt, lat, lon, author, creditUrl, tags;\n\n                    if (photoData) {\n                        src = createFlickrImageUrl(photoData);\n                        title = photoData.title._content;\n                        alt = photoData.description._content;\n                        lat = photoData.location.latitude;\n                        lon = photoData.location.longitude;\n                        author = photoData.owner.realname;\n                        if (!author) {\n                            author = photoData.owner.username\n                        }\n                        creditUrl = photoData.urls.url[0]._content;\n                        tags = photoData.tags\n                    }\n\n                    let firstPhoto = {\n                        src: src,\n                        title: title,\n                        alt: alt,\n                        lon: lon,\n                        lat: lat,\n                        author: author,\n                        creditUrl: creditUrl,\n                        tags: tags\n                    }\n\n                    this.setState({ firstPhoto: firstPhoto }, () => {\n\n                        this.getLocationDetailsFromFlickr(photoId, woeId);\n\n                    })\n                }\n            )\n\n        }\n    }\n\n    componentWillUnmount() {\n        this._isMounted = false;\n    }\n\n\n    getLocationDetailsFromFlickr(photoId, woeId) {\n\n        //get the photo data\n        let photo = this.state.firstPhoto;\n        let src = photo.src;\n        let title = photo.title;\n        let alt = photo.alt;\n        let lat = photo.lat;\n        let lon = photo.lon;\n        let author = photo.author;\n        let creditUrl = photo.creditUrl;\n\n\n\n        //get each tag\n        let tagsList = photo.tags;\n\n        if (!tagsList) {\n            tagsList = [];\n        } else {\n            tagsList = tagsList.tag\n        }\n\n        // generate a string from tags\n        let tagsString = '';\n        tagsList.forEach(\n            (tag, index) => {\n                tag = tag._content;\n                if (tag) {\n                    if (index === 0) {\n                        tagsString = tagsString.concat(tag)\n                    } else {\n                        tagsString = tagsString.concat(`, ${tag}`)\n                    }\n                }\n            }\n        )\n\n        //check if filter tags are within the tagsString, if so add subjects list\n        if (tagsString) {\n\n            let subjects = []\n\n            //make the filterTags string into an array\n            //for each item in the array check if it's in tags string\n            //once one tag is found subject\n            //use a \"for\" loop instead of \"forEach\" so that it breaks on first match\n\n            let setSubject = (tagsArray, subject) => {\n                for (let i = 0; i < tagsArray.length; i++) {\n                    let tag = tagsArray[i];\n                    if (tagsString.includes(tag)) {\n                        subjects.push(subject)\n                        break;\n                    }\n                }\n            }\n\n            //'abandoned'\n            let abandonedString = filterTags.abandonedTags;\n            let abandonedArray = abandonedString.split(', ');\n            setSubject(abandonedArray, 'abandoned');\n\n            //'architecture'\n            let architectureString = filterTags.architectureTags;\n            let architectureArray = architectureString.split(', ');\n            setSubject(architectureArray, 'architecture');\n\n            //'astro'\n            let astroString = filterTags.astroTags;\n            let astroArray = astroString.split(', ');\n            setSubject(astroArray, 'astro');\n\n            //'landscape'\n            let landscapeString = filterTags.landscapeTags;\n            let landscapeArray = landscapeString.split(', ');\n            setSubject(landscapeArray, 'landscape');\n\n            //'nature'\n            let natureString = filterTags.natureTags;\n            let natureArray = natureString.split(', ');\n            setSubject(natureArray, 'nature');\n\n            //'street art'\n            let streetArtString = filterTags.streetArtTags;\n            let streetArtArray = streetArtString.split(', ');\n            setSubject(streetArtArray, 'street art');\n\n            //'sunrise'\n            let sunriseString = filterTags.sunriseTags;\n            let sunriseArray = sunriseString.split(', ');\n            setSubject(sunriseArray, 'sunrise');\n\n            //'sunset'\n            let sunsetString = filterTags.sunsetTags;\n            let sunsetArray = sunsetString.split(', ');\n            setSubject(sunsetArray, 'sunset');\n\n            //'transport'\n            let transportString = filterTags.transportTags;\n            let transportArray = transportString.split(', ');\n            setSubject(transportArray, 'transport');\n\n            //'people'\n            let peopleString = filterTags.peopleTags;\n            let peopleArray = peopleString.split(', ');\n            setSubject(peopleArray, 'people');\n\n            //'urban'\n            let urbanString = filterTags.urbanTags;\n            let urbanArray = urbanString.split(', ');\n            setSubject(urbanArray, 'urban');\n\n            //'water'\n            let waterString = filterTags.waterTags;\n            let waterArray = waterString.split(', ');\n            setSubject(waterArray, 'water');\n\n            //if the location contains any subjects, update the state\n            if (subjects.length > 0) {\n                this.setState({ subjects: subjects })\n            }\n        }\n\n        //create a location object and add it to imageList\n\n        createFlickrImageUrl(photo)\n\n        let location = {\n            \"title\": title,\n            \"src\": src,\n            \"alt\": alt,\n            \"author\": author,\n            \"creditUrl\": creditUrl,\n            \"flickrId\": photoId\n        }\n\n        let place = async (options) => {\n            let placeName = await getFlickrPlace(options);\n            return placeName\n        }\n\n        place({ \"woeId\": woeId }).then(placeName => {\n\n            if (placeName) {\n                location.title = placeName\n            }\n\n        }).then(\n\n            this.setState(\n                {\n                    title: title,\n                    destination: {\n                        latitude: parseFloat(lat),\n                        longitude: parseFloat(lon)\n                    },\n\n                    imageList: [location] //will need to makesure this stays as first photo when others are added\n                }\n            )\n\n        ).then(\n            () => {\n\n\n                //use woeid to get other images\n                let options = {\n                    \"lat\": lat,\n                    \"lon\": lon,\n                    \"extras\": \"geo, description, owner_name, tags\",\n                    \"accuracy\": 16\n                }\n\n                getFlickrPhotos(options).then(\n                    data => {\n\n                        if (data) {\n\n                            let photos = data.photos\n\n                            if (photos) {\n                                photos = photos.photo\n                                let imageList = this.state.imageList;\n\n                                photos.forEach(\n                                    photo => {\n                                        //only select photos with the same woeid (same location)\n                                        //prevent duplicate locations and locations with no tags\n                                        if (photo.woeid === woeId && photo.id !== photoId && photo.tags) {\n\n                                            let newTitle = photo.title;\n                                            let newSrc = createFlickrImageUrl(photo);\n                                            let newAlt = photo.description._content;\n                                            let newAuthor = photo.ownername;\n                                            let ownerId = photo.owner;\n                                            let newCreditUrl = `https://www.flickr.com/photos/${ownerId}/${photo.id}`;\n                                            let newphotoId = photo.id;\n\n\n                                            let newLocation = {\n                                                \"title\": newTitle,\n                                                \"src\": newSrc,\n                                                \"alt\": newAlt,\n                                                \"author\": newAuthor,\n                                                \"creditUrl\": newCreditUrl,\n                                                \"flickrId\": newphotoId\n                                            }\n\n                                            imageList.push(newLocation);\n\n                                            this.setState({ imageList: imageList })\n\n                                        }\n\n                                    }\n                                )\n                            }\n                        }\n\n\n                    }\n                )\n            }\n\n        )\n\n    }\n\n\n    render() {\n\n        let { title,\n            saves,\n            destination,\n            imageList,\n            subjects,\n            inTrips } = this.state;\n\n        if (!title) {\n            title = \"Untitled Location\"\n        }\n\n        if (!saves) {\n            saves = 0;\n        }\n\n        return (\n            <>\n                <div className=\"location\">\n                    <div className='mobile-header'>\n                        <div className={`container mobile-padding`}>\n                            <button onClick={() => { window.history.back() }} className={`secondary-button back-button`}>Back</button>\n                            <ul className=\"actions\">\n                                <li><AddToTripsSmall added={inTrips} onClick={() => { this.manageTripsModal() }} /></li>\n                            <li><DirectionsSmall latitude={destination.latitude} longitude={destination.longitude} /></li>\n                            </ul>\n                            \n                        </div>\n\n                    </div>\n                    <div className={`container mobile-padding`}>\n\n                        {imageList && <PhotoSlider imageList={imageList} />}\n\n                        <h2 className={`title`}>{title}</h2>\n                        <div className={`gird-70-30`}>\n                            <div className={`col-70`}>\n                                <p className={`meta-data saved`}>Saved in: {saves} {(saves > 1 || saves < 1) ? 'trips' : 'trip'}</p>\n                                <p className={`meta-data marker`}>Coordinates: {destination.latitude}, {destination.longitude}</p>\n                            </div>\n                            <div className={`col-30`}>\n                                <ul className=\"actions\">\n                                    <li>\n                                        <DirectionsLarge latitude={destination.latitude} longitude={destination.longitude} />\n                                    </li>\n                                    <li>\n                                        <AddToTripsLarge data-micromodal-trigger=\"modal-1\" onClick={() => { this.manageTripsModal() }} added={inTrips} />\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n\n                        {subjects.length > 0 && <SubjectIndicators subjects={subjects} />}\n\n                    </div>\n\n\n                </div>\n                <ManageTripsModal\n                    isOpen={this.state.showTripsModal}\n                    handleClose={() => this.manageTripsModal()}\n                    locationId={this.state.locationId}\n                    photos={this.state.imageList}\n                    coordinates={this.state.destination}\n                    subjects={this.state.subjects}\n                    userId={this.state.userId}\n                    woeId={this.state.woeId}\n\n                />\n            </>\n\n        )\n\n    }\n}\n\n\nLocation.propTypes = {\n    userId: PropTypes.string\n}\n\n\nexport default Location;","\nconst EditTripLarge = ({added, ...rest}) => {\n\n    return (\n        <button className={`action-button edit`} {...rest}>\n            Edit Trip\n        </button>\n    )\n}\n\nconst EditTripSmall = ({added, ...rest}) => {\n\n    return (\n        <button className={`action-button-small edit`} {...rest}>\n            Edit Trip\n        </button>\n    )\n}\n\n\nexport {EditTripLarge,  EditTripSmall};","import PropTypes from 'prop-types'\n\nconst BookmarkTripLarge = ({bookmarked, updating, ...rest}) => {\n\n    return (\n        <button className={`action-button ${bookmarked ? 'bookmarked' : 'bookmark'}`} {...rest}>\n            {\n               updating ? 'Updating'  : (bookmarked ? 'Unbookmark' : 'Bookmark')\n            }\n        </button>\n    )\n}\n\nconst BookmarkTripSmall = ({bookmarked, updating, ...rest}) => {\n\n    return (\n        <button className={`action-button-small ${bookmarked ? 'bookmarked' : 'bookmark'}`} {...rest}>\n            {\n                updating ? 'Updating'  : (bookmarked ? 'Unbookmark' : 'Bookmark')\n            }\n        </button>\n    )\n}\n\nBookmarkTripLarge.propTypes = {\n    bookmarked: PropTypes.bool\n}\n\nBookmarkTripSmall.propTypes = {\n    bookmarked: PropTypes.bool,\n    updating:  PropTypes.bool\n}\n\nexport {BookmarkTripLarge , BookmarkTripSmall};","import React from 'react'\nimport Modal from './Modal'\nimport TexInput from '../forms/TextInput'\nimport SubmitButton from '../forms/SubmitButton'\nimport RadioButton from '../forms/RadioButton'\nimport firebase from '../../utils/firebase/firebaseConfig'\nimport { generateDate } from '../../utils/generateDateAndTime'\n\nclass EditTripModal extends React.Component {\n\n    state = {\n        errorUpdatingTrip: '',\n        errorUpdatingUserTrips: '',\n        tripNameError: '',\n        tripNameLength: 0,\n        tripName: '',\n        nameUpdated: false,\n        tripTags: '',\n        tagsUpdated: false,\n        tripTagsError: '',\n        tripPrivacy: this.props.originalTripPrivacy,\n        updatingTrip: false,\n        tripUpdate: false,\n        confirmDelete: false,\n        tripDeleted: false,\n        tagButtons: ''\n    }\n\n    _isMounted = false;\n\n\n\n\n    updateTrip(e) {\n        //update userTrips\n        //update trip\n        e.preventDefault();\n\n\n        if (!this.state.errorUpdatingTrip &&\n            !this.state.errorUpdatingUserTrips &&\n            !this.state.tripNameError &&\n            !this.state.tripTagsError\n        ) {\n\n            this.setState({ updatingTrip: true })\n            let database = firebase.database()\n            let userId = this.props.userId;\n            let tripId = this.props.tripId;\n            let originalPrivacy = this.props.originalTripPrivacy;\n\n\n            let tripRef = `${originalPrivacy}Trips/${tripId}`\n            let userTripRef = `userTrips/${userId}/${tripId}`\n\n            let newPrivacy = this.state.tripPrivacy\n            let tripUpdate = {}\n\n\n            if (this.state.tripName && (this.state.tripName !== this.props.originalTripName)) {\n                tripUpdate[\"tripName\"] = this.state.tripName\n            }\n\n            //this gets buggy when I update tags plus it's not refreshing the update...\n            if (this.state.tagsUpdated && (this.state.tripTags !== this.props.originalTripTags)) {\n                tripUpdate[\"tags\"] = this.state.tripTags\n            }\n\n            //update trip name and tags\n            if (tripUpdate || newPrivacy) {\n                tripUpdate.lastEdited = generateDate()\n\n\n                //if the new privacy is private, then delete existing bookmarks\n\n                if (newPrivacy === 'private') {\n                    //get the existing bookmarks, and delete them from path\n                    this.deleteBookmarks(\n                        tripRef,\n                        tripId,\n                        () => {\n                            database.ref(`${tripRef}/bookmarks`).remove().catch(error => {\n                                this.setState({ errorUpdatingTrips: `When deleting bookmarks ${error}` })\n                            })\n                        }\n                    )\n                }\n\n\n                database.ref(`${tripRef}`).update(tripUpdate).catch(error => {\n                    this.setState({ errorUpdatingTrip: error })\n                }).then(() => {\n                    if (this.state.tripPrivacy) {\n                        let userTripsUpdate = {\n                            tripPrivacy: newPrivacy\n                        }\n                        //update userTrips\n                        database.ref(`${userTripRef}`).update(userTripsUpdate).catch(error => {\n                            this.setState({ errorUpdatingUserTrips: error })\n                        })\n\n                        //get trip from current spot and store it\n                        let tripData;\n                        database.ref(`${tripRef}`).get().then(\n                            (snapshot) => {\n                                tripData = snapshot.val()\n                            }\n                        ).catch(error => {\n                            this.setState({ errorUpdatingUserTrips: `When getting original privacy setting ${error}` })\n                        }).then(() => {\n                            //delete trip from current spot\n                            database.ref(`${tripRef}`).remove().catch(error => {\n                                this.setState({ errorUpdatingUserTrips: `When deleting original privacy setting ${error}` })\n                            })\n                        }).then(() => {\n                            //add trip under new privacy\n                            let tripRef = `${newPrivacy}Trips/${tripId}`\n                            database.ref(`${tripRef}`).set(\n                                tripData\n                            ).catch(error => {\n                                this.setState({ errorUpdatingUserTrips: `When setting new privacy setting ${error}` })\n                            })\n                        }).then(() =>\n                            //inidicate update finished\n                            this.setState({ updatingTrip: false, tripUpdate: true }))\n                    } else {\n                        //if privacy was not changed, simply indicate update done\n                        this.setState({ updatingTrip: false, tripUpdate: true })\n                    }\n                })\n\n            }\n\n        }\n\n\n    }\n\n    tripDeleted() {\n        return (\n            <div className=\"modal-content-padding center-text\">\n                <h3 className=\"h5-font center-text\">\n                    This trip has been deleted.\n                </h3>\n            </div>\n        )\n\n    }\n\n    tripUpdated() {\n        return (\n            <div className=\"modal-content-padding center-text\">\n                <h3 className=\"h5-font center-text\">\n                    Trip information updated.\n                </h3>\n            </div>\n        )\n\n    }\n\n    renderDatabaseErrors() {\n        if (\n            this.state.errorUpdatingUserTrips ||\n            this.state.errorUpdatingTrip\n        ) {\n            return (\n                <div className=\"error-font\" aria-live=\"polite\">\n                    <ul>\n                        {this.state.errorUpdatingTrip && <li>Issue updating trip: {this.state.errorUpdatingTrip}</li>}\n                        {this.state.errorUpdatingUserTrips && <li> Issue updating user trips: {this.state.errorUpdatingUserTrips}</li>}\n                    </ul>\n                </div>\n            )\n        }\n    }\n\n    deleteBookmarks(tripRef, tripId, callback) {\n        let database = firebase.database();\n\n        //first delete bookmar references, then delete the trip\n        database.ref(`${tripRef}/bookmarks`).get().catch(error => {\n            this.setState({ errorUpdatingTrips: `When deleting trip bookmarks ${error}` })\n        }).then(snapshot => {\n            if (snapshot) {\n                let bookmarks = snapshot.val()\n\n                for (const userId in bookmarks) {\n                    database.ref(`userBookmarks/${userId}/${tripId}`).remove().catch(error => {\n                        this.setState({ errorUpdatingTrips: `When deleting trip ${error}` })\n                    })\n                }\n            }\n        }).then(() => {\n            if (callback) {\n                callback()\n            }\n        })\n\n    }\n\n    deleteTrip() {\n        let database = firebase.database();\n        let userId = this.props.userId;\n        let tripId = this.props.tripId;\n        let originalPrivacy = this.props.originalTripPrivacy;\n        let tripRef = `${originalPrivacy}Trips/${tripId}`\n        let userTripRef = `userTrips/${userId}/${tripId}`\n\n        this.deleteBookmarks(\n            tripRef,\n            tripId,\n            () => {\n                database.ref(`${tripRef}`).remove().catch(error => {\n                    this.setState({ errorUpdatingTrips: `When deleting trip ${error}` })\n                }).then(\n                    () => {\n                        database.ref(`${userTripRef}`).remove().catch(error => {\n                            this.setState({ errorUpdatingUserTrips: `When deleting trip from user trips list: ${error}` })\n                        })\n                    }\n                ).then(\n                    () => {\n                        this.setState({ tripDeleted: true })\n                    }\n                )\n            }\n        )\n    }\n\n    toggleDeleteFrom() {\n        this.setState({ confirmDelete: !this.state.confirmDelete })\n    }\n\n\n    componentDidUpdate(prevProps) {\n        if (this.props.originalTripPrivacy !== prevProps.originalTripPrivacy) {\n            this.setState({ tripPrivacy: this.props.originalTripPrivacy })\n        }\n\n    }\n\n    renderUpdateForm() {\n        let pathQuery = this.props.searchQuery;\n        let searchParams = new URLSearchParams(pathQuery);\n        let searchPrivacy = searchParams.get(\"privacy\")\n        let privacy = this.state.tripPrivacy ? this.state.tripPrivacy : searchPrivacy;\n\n        let defaultPrivate = privacy === 'private'\n        let defaultPublic = privacy === 'public'\n        let defaultShareable = privacy === 'shareable'\n\n        return (\n            <>\n                {this.renderDatabaseErrors()}\n\n                <form className=\"modal-content-padding\">\n                    <div className=\"form-component-wrapper\">\n                        <label htmlFor=\"trip-name\">Title (Max 50 Characters)</label>\n                        <TexInput id=\"trip-name\"\n                            value={this.state.nameUpdated ? this.state.tripName : this.props.originalTripName}\n                            onChange={(e) => this.handleTripNamelInput(e)}\n                            required />\n                        {this.state.tripNameLength !== 0 && <p className=\"character-count\" aria-live=\"polite\">Characters left: {50 - this.state.tripNameLength}</p>}\n                        {this.state.tripNameError && <p className=\"error-font\" aria-live=\"polite\">{this.state.tripNameError}</p>}\n                    </div>\n\n                    <div className=\"form-component-wrapper\">\n                        <label htmlFor=\"trip-tags\">Tags (Comma separated)</label>\n                        <TexInput id=\"trip-tags\"\n                            value={this.state.tagsUpdated ? this.state.tripTags : this.props.originalTripTags}\n                            onChange={(e) => this.handleTripTagsInput(e)} />\n                        {this.state.tripTagsError && <p className=\"error-font\" aria-live=\"polite\">{this.state.tripTagsError}</p>}\n                    </div>\n\n                    <fieldset className=\"form-component-wrapper\">\n                        <legend>Visibility Settings</legend>\n\n                        <RadioButton\n                            defaultChecked={defaultPublic}\n                            onChange={(e) => this.handleTripPrivacy(e)}\n                            labelText=\"Public\"\n                            name=\"trip-privacy\"\n                            value=\"public\" />\n\n                        <label className=\"caption-font\" htmlFor=\"public\">Anyone can see</label>\n\n                        <RadioButton\n                            defaultChecked={defaultPrivate}\n                            onChange={(e) => this.handleTripPrivacy(e)}\n                            labelText=\"Private\"\n                            name=\"trip-privacy\"\n                            value=\"private\" />\n                        <label className=\"caption-font\" htmlFor=\"private\">Only you can see</label>\n\n                        <RadioButton\n                            defaultChecked={defaultShareable}\n                            onChange={(e) => this.handleTripPrivacy(e)}\n                            labelText=\"Shareable\"\n                            name=\"trip-privacy\"\n                            value=\"shareable\" />\n                        <label className=\"caption-font\" htmlFor=\"shareable\">Anyone with a link can see</label>\n\n                    </fieldset>\n\n                    <div className=\"form-component-wrapper\">\n                        <SubmitButton onClick={(e) => this.updateTrip(e)} value={`${this.state.updatingTrip ? 'Updating Trip...' : 'Update Trip'}`} />\n                    </div>\n\n                </form>\n\n                {\n                    <div className=\"modal-content-padding\">\n                        <button onClick={() => this.toggleDeleteFrom()} className=\"secondary-button delete-button\">Delete Trip</button>\n                        {this.state.confirmDelete && <div>\n                            <ul className=\"button-group\">\n                                <li><button onClick={() => this.deleteTrip()} className=\"default-button\">Delete</button></li>\n                                <li><button onClick={() => this.toggleDeleteFrom()} className=\"button-link\">Cancel</button></li>\n                            </ul>\n                        </div>}\n                    </div>\n                }\n            </>\n        )\n\n    }\n\n    handleTripNamelInput(e) {\n        e.preventDefault();\n        let value = e.target.value;\n        let valueLength = value.length;\n\n        this.setState({\n            nameUpdated: true,\n            tripName: e.target.value,\n            tripNameLength: valueLength,\n            tripNameError: \"\"\n        })\n        if (valueLength === 0) {\n            this.setState({\n                tripNameError: \"Your trip must have a name.\"\n            })\n        }\n        if (valueLength > 50) {\n            this.setState({\n                tripNameError: \"Your trip name is too long.\"\n            })\n        }\n    }\n\n    handleTripTagsInput(e) {\n        e.preventDefault();\n\n        this.setState({\n            tagsUpdated: true,\n            tripTags: e.target.value,\n            tripTagsError: \"\"\n        }, () => {\n            //check if tags have special characters other than comma\n            let testString = /^[a-zA-Z ,0-9]+$/;\n\n            if (this.state.tripTags && !testString.test(this.state.tripTags)) {\n                this.setState({\n                    tripTagsError: \"Tags may only contain letters, numbers, and commas\"\n                })\n            }\n        });\n\n    }\n\n    handleTripPrivacy(e) {\n        this.setState({ tripPrivacy: e.target.value })\n    }\n\n\n    renderModalContent() {\n        if (this.state.tripDeleted) {\n            return this.tripDeleted()\n        } else {\n            if (!this.state.tripUpdate ||\n                this.state.errorUpdatingTrip ||\n                this.state.errorUpdatingUserTrips ||\n                this.state.tripNameError ||\n                this.state.tripTagsError) {\n                return this.renderUpdateForm()\n            } else {\n                return this.tripUpdated()\n            }\n        }\n\n    }\n\n    closeModal() {\n\n        //if the trip was updated\n        //reset the state of the modal\n        //and tell the parent of the update\n        //else close the modal and indate that the update did not happen\n\n        let update = {}\n\n        if (!this.state.tripDeleted) {\n\n            if (this.state.tripUpdate) {\n\n                let originalPrivacy = this.props.originalTripPrivacy\n                let newPrivacy = this.state.tripPrivacy\n\n\n                if (newPrivacy && (newPrivacy !== originalPrivacy)) {\n                    update = {\n                        updated: true,\n                        newPrivacy: newPrivacy\n                    }\n                } else {\n                    update = {\n                        updated: true\n                    }\n                }\n\n            } else {\n                update = { updated: false }\n            }\n\n            this.setState({ tripUpdate: false, nameUpdated: false, tagsUpdated: false },\n                () => this.props.handleClose(update))\n\n        } else {\n            update = { updated: true, deleted: true }\n            this.props.handleClose(update)\n        }\n\n    }\n\n\n    render() {\n        return (\n\n            <Modal\n                modalId='edit-trip-modal'\n                modalTitle={'Update Trip'}\n                isOpen={this.props.isOpen}\n                handleClose={() => this.closeModal()}\n            >\n                {this.renderModalContent()}\n            </Modal>\n\n\n        )\n    }\n\n}\n\nexport default EditTripModal;\n","import firebase from './firebase/firebaseConfig';\n\nlet addToBookmarks = (userId, tripId, tripAuthor, tripPrivacy, callback) => {\n    let database = firebase.database();\n    let bookmarkingError = false\n    let update = {};\n    update[userId] = true;\n    //add reference on \n    database.ref(`${tripPrivacy}Trips/${tripId}/bookmarks`).update(\n        update\n    ).catch(\n        (error) => {\n            bookmarkingError = error.message\n        }\n    ).then(() => {\n        //add to user bookmarks\n        database.ref(`userBookmarks/${userId}/${tripId}`).set({\n            tripPrivacy: tripPrivacy,\n            tripAuthor: tripAuthor\n        }).catch((error) => {\n            bookmarkingError = error.message\n        }).then(() => {\n            callback(bookmarkingError)\n        })\n\n    }\n\n    )\n\n\n\n}\n\nexport default addToBookmarks;","import React from 'react'\nimport Authenticate from '../../screens/authentication/Authenticate'\nimport Modal from './Modal'\nimport addToBookmarks from '../../utils/addToBookmarks'\n\nclass BookmarkModal extends React.Component {\n    state = {\n        isAuthenticated: false,\n        modalTitle: 'Sign In',\n        modalDescription: 'Sign in to add bookmark.',\n        newUser: false,\n        error: ''\n    }\n\n    changeUserType(newUserValue) {\n        this.setState({ newUser: newUserValue }, () => {\n\n            if (this.state.newUser) {\n                this.setState(\n                    {\n                        modalTitle: 'Sign Up',\n                        modalDescription: 'Create an account to add bookmark.'\n                    }\n                )\n            }\n        })\n    }\n\n    bookmarkTrip(user) {\n        //do the bookmarking, then\n\n        if (user) {\n            this.setState({ isAuthenticated: true })\n            let userId = user.uid;\n\n            if (userId !== this.props.tripAuthor) {\n                addToBookmarks(\n                    userId,\n                    this.props.tripId,\n                    this.props.tripAuthor,\n                    this.props.tripPrivacy,\n                    (errorMessage) => {\n                        if (!errorMessage) {\n                            this.setState({\n                                modalTitle: 'Bookmark',\n                                modalDescription: ''\n                            })\n\n                        } else {\n                            this.setState({\n                                modalTitle: 'Issue Bookmarking',\n                                modalDescription: '',\n                                error: errorMessage\n                            })\n                        }\n                    }\n                )\n            } else {\n                this.setState({\n                    error: 'Cannot bookmark this trip because you are its author.'\n                })\n            }\n        }\n\n    }\n\n    verifyBookmark() {\n        if (this.state.error) {\n            return (\n                <div aria-live=\"polite\" className=\"modal-content-padding center-text\">\n                    <p className=\"error-font\">\n                        {this.state.error}\n                    </p>\n                </div>\n\n            )\n\n        } else {\n            return (\n                <div aria-live=\"polite\" className=\"modal-content-padding center-text\">\n                    <h3 className=\"h5-font center-text\">\n                        Trip bookmarked!\n                    </h3>\n                </div>\n            )\n        }\n    }\n\n    renderContent() {\n        if (!this.state.isAuthenticated) {\n            return (\n                <div className=\"modal-content-padding\">\n                    <Authenticate\n                        hideTitle\n                        changeUserOnParent={(newUserValue) => this.changeUserType(newUserValue)}\n                        afterSignIn={(user) => this.bookmarkTrip(user)}\n                        afterCreateAccount={(user) => this.bookmarkTrip(user)}\n                    />\n                </div>\n            )\n        } else {\n            return this.verifyBookmark()\n        }\n    }\n\n    closeModal() {\n        this.setState({\n            isAuthenticated: false,\n            modalTitle: 'Sign In',\n            modalDescription: 'Sign in to add bookmark.',\n            newUser: false,\n            error: ''\n        }, () => {\n            this.props.handleClose()\n        })\n    }\n\n    render() {\n        let {\n            modalTitle,\n            modalDescription\n        } = this.state;\n\n        return (\n            <Modal\n                modalId='manage-trips-modal'\n                modalTitle={modalTitle}\n                modalDescription={modalDescription}\n                isOpen={this.props.isOpen}\n                handleClose={() => this.closeModal()}\n            >\n\n                {this.renderContent()}\n\n            </Modal>\n        )\n    }\n\n}\n\nexport default BookmarkModal;","import firebase from './firebase/firebaseConfig'\n\nlet removeFromBookmarks = (userId, tripId, tripPrivacy, callback) => {\n    let database = firebase.database()\n    let userBookmarksRef = `userBookmarks/${userId}/${tripId}`\n    let tripRef = `${tripPrivacy}Trips/${tripId}/bookmarks/${userId}`\n\n    database.ref(userBookmarksRef).remove().catch(\n        error => {\n            console.log(error)\n        } \n    ).then(\n        () => {\n            database.ref(tripRef).remove().catch(\n                error => {\n                    console.log(error)\n                } \n            )\n        }\n    ).then(\n        () => callback()\n    )\n}\n\nexport default removeFromBookmarks;","import React from 'react'\nimport MapWithCards from '../../components/layout/MapWithCards'\nimport ResultsList from '../../components/content/ResultsList'\nimport firebase from '../../utils/firebase/firebaseConfig'\nimport { EditTripLarge, EditTripSmall } from '../../components/buttons/EditTripButtons'\nimport { BookmarkTripLarge, BookmarkTripSmall } from '../../components/buttons/BookmarkTripButtons'\nimport EditTripModal from '../../components/modals/EditTripModal'\nimport BookmarkModal from '../../components/modals/BookmarkModal'\nimport addToBookmarks from '../../utils/addToBookmarks'\nimport removeFromBookmarks from '../../utils/removeFromBookmarks'\n\nclass TripContent extends React.Component {\n    state = {\n        loaded: false,\n        tripList: [],\n        tripName: '',\n        tripTags: '',\n        locationsCount: 0,\n        mapLat: null,\n        mapLon: null,\n        mapZoom: 10,\n        showEditModal: false,\n        tripPrivacy: null,\n        authorId: '',\n        authorName:'',\n        bookmarked: false,\n        updatingBookmark: false,\n        showBookmarkModal: false\n    }\n    _isMounted = false;\n\n    tripId = this.getTripId()\n\n    getPrivacy() {\n        let pathQuery = this.props.location.search;\n        let searchParams = new URLSearchParams(pathQuery);\n        let privacy = searchParams.get(\"privacy\");\n        return privacy;\n    }\n\n    getTripId() {\n        let pathname = this.props.location.pathname;\n        let tripId = pathname.replace(\"/trip/\", \"\");\n        return tripId;\n    }\n\n\n    componentDidMount() {\n        this._isMounted = true;\n\n        let privacy = this.getPrivacy()\n\n        this.setState({ tripPrivacy: privacy }, () => {\n            this._isMounted && this.getTripDetails(this.state.tripPrivacy, this.tripId);\n            //check if bookmarked\n            this._isMounted && this.checkIfInBookmarks(this.props.userId);\n        }\n        )\n\n    }\n\n    componentDidUpdate(nextProps) {\n        if(this.props.userId !== nextProps.userId) {\n            this._isMounted && this.checkIfInBookmarks(this.props.userId);\n        }\n    }\n\n\n\n    getTripDetails(privacy, tripId) {\n        let database = firebase.database();\n\n        let tripName, locationsCount, tripTags, authorId;\n        let list = []\n        let tripRef = `${privacy}Trips/${tripId}`\n\n        database.ref(`${tripRef}`).get().then(\n            snapshot => {\n                let tripData = snapshot.val()\n                tripName = tripData['tripName']\n                tripTags = tripData['tags']\n                authorId = tripData['author']\n                locationsCount = tripData['locationsCount']\n                this._isMounted && this.setState({\n                    tripName: tripName,\n                    locationsCount: locationsCount,\n                    tripTags: tripTags,\n                    authorId: authorId\n                })\n\n                database.ref(`users/${authorId}/displayName`).get().catch(error=>console.log(error)).then(\n                    snapshot => {\n                        if(snapshot){\n                            let authorName = snapshot.val()\n                            this._isMounted &&  this.setState({authorName: authorName})\n                        }\n                    }\n                )\n\n                let locations = tripData['locations']\n\n\n\n                for (const locationId in locations) {\n\n\n                    let location, src, woeId, url, title, lat, lon, locationRef, photoId;\n                    if (locationId.startsWith(\"flickr-\")) {\n                        src = \"flickr\"\n                        locationRef = `appLocations/flickrSourced/${locationId}`\n                        photoId = locationId.replace(\"flickr-\", \"\");\n                    }\n\n\n                    database.ref(`${locationRef}`).get().then(\n                        (snapshot) => {\n                            let locationData = snapshot.val()\n                            if (locationData) {\n                                let photos = locationData[\"photos\"]\n                                let firstPhoto = photos[Object.keys(photos)[0]]\n                                let coordinates = locationData[\"coordinates\"]\n                                woeId = locationData['woeId']\n                                url = firstPhoto[\"src\"]\n                                title = locationData[\"locationName\"]\n                                lat = coordinates[\"latitude\"]\n                                lon = coordinates[\"longitude\"]\n                            }\n\n                            location = {\n                                \"src\": src,\n                                \"locationId\": photoId,\n                                \"woeId\": woeId,\n                                \"thumbnail\": url,\n                                \"title\": title,\n                                \"destination\": {\n                                    \"latitude\": parseFloat(lat),\n                                    \"longitude\": parseFloat(lon)\n                                }\n                            }\n\n                        }\n                    ).then(() => list.push(location)).catch(error => console.log(\"issue getting location info\", error)).then(\n                        () => {\n\n                            let firstLocation = list[0]\n                            let coordinates = firstLocation[\"destination\"]\n                            let lon = coordinates[\"longitude\"]\n                            let lat = coordinates[\"latitude\"]\n\n                            let update = {\n                                tripList: list,\n                                loaded: true,\n                                mapLat: lat,\n                                mapLon: lon\n                            }\n\n\n                            this.setState(update)\n                        }\n                    )\n                }\n            }\n        ).catch(error => console.log(error))\n\n    }\n\n    openEditModal() {\n        let privacy = this.getPrivacy()\n        this.setState({ tripPrivacy: privacy },\n            () => this.setState({ showEditModal: true }))\n    }\n\n\n\n    closeEditModal(update) {\n        let updated = update['updated']\n        let deleted = update['deleted']\n\n        if (updated) {\n            if (deleted) {\n                this.setState({ showEditModal: !this.state.showEditModal },\n                    () => {\n                        this.props.history.push('/trips')\n                    })\n\n            } else {\n                let newPrivacy = update['newPrivacy']\n\n                if (newPrivacy && (this.state.tripPrivacy !== newPrivacy)) {\n                    this.props.history.push({\n                        search: `?privacy=${newPrivacy}`\n                    })\n\n                    this.setState({ tripPrivacy: newPrivacy })\n                    this._isMounted && this.getTripDetails(newPrivacy, this.tripId);\n                } else {\n                    this._isMounted && this.getTripDetails(this.state.tripPrivacy, this.tripId);\n                }\n            }\n\n        }\n        this.setState({ showEditModal: !this.state.showEditModal })\n\n    }\n\n\n    checkIfInBookmarks(userId) {\n        if (userId !== 'notSignedIn') {\n           \n\n            this.setState({updatingBookmark: true})\n            let database = firebase.database()\n        \n\n            //get the user's bookmakrs\n            this._isMounted && database.ref(`userBookmarks/${userId}`).get().catch(error=> console.log(error)).then((snapshot) => {\n                let inBookmarks = false\n                if (snapshot.exists()) {\n                    let trips = snapshot.val();\n                    //go through each trip and check if they match the current triId\n                    for (const tripId in trips) {\n\n                        if (tripId === this.tripId) {\n                            inBookmarks = true\n                        } \n                    }\n\n                }\n\n                return this.setState({bookmarked: inBookmarks, updatingBookmark: false})\n            })\n        }\n\n    }\n\n\n\n\n    handleBookmark() {\n        if (this.props.userId !== 'notSignedIn') {\n            this.setState({updatingBookmark: true })\n            if(!this.state.bookmarked) {\n                //add to book marks\n                addToBookmarks(\n                    this.props.userId,\n                    this.tripId,\n                    this.state.authorId,\n                    this.state.tripPrivacy,\n                    (errorMessage) => {\n                        if(!errorMessage){\n                            this.checkIfInBookmarks(this.props.userId)\n                        } else {\n                            this.setState({updatingBookmark:false})\n                            console.log(errorMessage)\n                        }\n                    }\n                )\n               \n           } else {\n            //delete bookmark\n            removeFromBookmarks(\n                this.props.userId,\n                this.tripId, \n                this.state.tripPrivacy,\n                () => {\n                    this.checkIfInBookmarks(this.props.userId)\n                }\n            )\n           }\n            \n        } else {\n            //bookmark\n            this.setState({showBookmarkModal: true})\n        }\n    }\n\n\n\n    closeBoomarkModal() {\n        this.setState({showBookmarkModal: false})\n        //check if in bookmarks\n    }\n\n\n    render() {\n        let {\n            loaded,\n            tripList,\n            mapLat,\n            mapLon,\n            mapZoom,\n            locationsCount,\n            tripName,\n            tripTags,\n            tripPrivacy,\n            authorId,\n            bookmarked,\n            updatingBookmark,\n            authorName } = this.state;\n\n\n        return (\n            <>\n                <div className={`trip`}>\n\n                    <MapWithCards\n                        mapLoctaions={tripList}\n                        mapLat={mapLat}\n                        mapLon={mapLon}\n                        mapZoom={mapZoom}\n                    >\n                        <div className='mobile-header'>\n                            <div className={`container mobile-padding`}>\n                                <button onClick={() => { window.history.back() }} className={`secondary-button back-button`}>Back</button>\n                                {loaded && this.props.userId === authorId && <EditTripSmall onClick={() => this.openEditModal()} />}\n                                {loaded && this.props.userId !== authorId && <BookmarkTripSmall updating={updatingBookmark} bookmarked={bookmarked} onClick={() => this.handleBookmark()} />}\n                            </div>\n                        </div>\n\n                        <div className={`gird-70-30`}>\n                            <div className={`col-70`}>\n                                <div className={`container mobile-padding`}>\n                                    <h2 className=\"h6-font\">{tripName}</h2>\n                                    <p className={`meta-data`}>by {authorName}</p>\n                                    <p className={`meta-data ${tripPrivacy === 'public' ? 'public' : 'private'}`}>{tripPrivacy}</p>\n                                    <p className={`meta-data marker`}>{locationsCount} {locationsCount === 1 ? 'Location' : 'Locations'}</p>\n                                    <p className={`meta-data tags`}>Tags: {tripTags}</p>\n                                </div>\n                            </div>\n                            <div className={`col-30`}>\n                                <ul className=\"actions\">\n                                    {loaded && this.props.userId === authorId && <li>\n                                        <EditTripLarge onClick={() => this.openEditModal()} />\n                                    </li>}\n                                    {loaded && this.props.userId !== authorId && <li>\n                                        <BookmarkTripLarge bookmarked={bookmarked} updating={updatingBookmark} onClick={() => this.handleBookmark()} />\n                                    </li>}\n                                </ul>\n                            </div>\n                        </div>\n                        <div className={`container`}>\n                            <ResultsList loaded={loaded} list={tripList} />\n                        </div>\n\n                    </MapWithCards>\n                    <EditTripModal\n                        isOpen={this.state.showEditModal}\n                        handleClose={(update) => this.closeEditModal(update)}\n                        originalTripName={tripName}\n                        originalTripTags={tripTags}\n                        originalTripPrivacy={tripPrivacy}\n                        userId={this.props.userId}\n                        tripId={this.tripId}\n                        searchQuery={this.props.location.search}\n                    />\n\n                    <BookmarkModal\n                        isOpen={this.state.showBookmarkModal}\n                        handleClose={() => this.closeBoomarkModal()}\n                        tripId={this.tripId}\n                        tripPrivacy={tripPrivacy}\n                        tripauthorId={authorId}\n                    />\n                </div>\n            </>\n        )\n    }\n}\n\nexport default TripContent;","import { Switch, Route } from 'react-router-dom';\nimport React from 'react';\nimport firebase from './utils/firebase/firebaseConfig'\n\nimport Navbar from './components/navigation/Navbar';\nimport Home from './screens/explore/Home';\nimport SearchResults from './screens/explore/SearchResults';\nimport Account from './screens/Account';\nimport Trips from './screens/trips/Trips';\nimport PrivateRoute from './components/navigation/PrivateRoute';\nimport Footer from './components/content/Footer';\nimport Location from './screens/location/Location';\nimport TripContent from './screens/trips/TripContent';\nimport './styles/main.scss';\n\n\nclass App extends React.Component {\n\n  state = {\n    signedIn: false,\n    userVerified: false,\n    userId: null\n\n  }\n\n\n\n  componentDidMount() {\n    firebase.auth().onAuthStateChanged(user => {\n      if (user) {\n        this.setState({\n          signedIn: true,\n          userVerified: user.emailVerified,\n          userId: user.uid\n        });\n      } else {\n        this.setState({ signedIn: false });\n      }\n    });\n  };\n\n\n  render() {\n\n    let { signedIn, userVerified } = this.state;\n\n    return (\n      <>\n\n        <Navbar />\n        <main>\n\n          <Switch>\n            <Route exact path=\"/\" component={Home} />\n\n            <Route path=\"/explore\" component={SearchResults} />\n\n            <Route path=\"/location\"\n\n              render={\n                (props) => <Location {...props} isAuthenticated={signedIn} userId={this.state.userId} />\n\n              } />\n\n            <Route path=\"/trips\"\n\n              render={\n                (props) => <Trips {...props} userId={this.state.userId} isAuthenticated={signedIn} isVerified={userVerified} />\n\n              } />\n\n            <Route path=\"/trip\"\n\n              render={\n                (props) => <TripContent {...props} userId={signedIn ? this.state.userId : 'notSignedIn'} />\n\n              } />\n\n            <PrivateRoute path=\"/account\" component={Account} isAuthenticated={signedIn} isVerified={userVerified} logInLocation={\"account\"} />\n\n\n          </Switch>\n\n\n        </main>\n\n        <Footer />\n\n      </>\n    );\n  }\n}\n\n\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport App from './App';\n\n\n\n\n\n\n\nReactDOM.render(\n  <React.StrictMode>\n     <BrowserRouter>\n         <App />  \n    </BrowserRouter>    \n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}